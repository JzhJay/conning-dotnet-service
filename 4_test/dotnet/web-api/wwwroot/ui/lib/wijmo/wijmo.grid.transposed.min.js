/*! For license information please see wijmo.grid.transposed.min.js.LICENSE.txt */
var wijmo,__extends=this&&this.__extends||function(){var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])})(o,t)};return function(o,t){function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var o;!function(o){"use strict";var t=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.getMergedRange=function(o,t,n,r){void 0===r&&(r=!0);var i=o.grid;if(o==i.rowHeaders&&i._hasColumnGroups()){if(t<0||t>=o.rows.length||n<0||n>=o.columns.length)return null;var s=i._getColumnGroup(t,n);if(s){var a=s._rng,l=o.rows;return l.isFrozen(a.row)!=l.isFrozen(a.row2)&&(a=a.clone(),l.isFrozen(t)?a.row2=l.frozen-1:a.row=l.frozen),a}return null}return e.prototype.getMergedRange.call(this,o,t,n,r)},o}(e.grid.MergeManager);o._MergeManager=t}((o=e.grid||(e.grid={})).transposed||(o.transposed={}))}(wijmo||(wijmo={})),function(e){var o;!function(o){var t=function(t){function r(n,r){var i=t.call(this,n,null)||this;return i._keyPrefix="item",i._autoGenRows=!0,e.addClass(i.hostElement,"wj-transposed-grid"),i.allowSorting=e.grid.AllowSorting.None,i.headersVisibility=e.grid.HeadersVisibility.Row,i._rowInfo=new e.grid.ColumnCollection(i,i.columns.defaultSize),i._grpHdl=new o._RowGroupHandler(i),i.mergeManager=new o._MergeManager,i.initialize(r),i._rowInfo.collectionChanged.addHandler(i._rowInfoChanged,i),i.deferUpdate((function(){var e=i.rowHeaders.columns;e.length&&(e[e.length-1].width=i.columns.defaultSize)})),i}return __extends(r,t),Object.defineProperty(r.prototype,"autoGenerateRows",{get:function(){return this._autoGenRows},set:function(o){this._autoGenRows=e.asBoolean(o)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(o){var t=this;this._rowInfo.deferUpdate((function(){t.autoGenerateRows=!1,t._rowInfo.clear(),t._grpHdl.createColumnGroups(e.asArray(o))}))},enumerable:!0,configurable:!0}),r.prototype.refresh=function(e){var o=this._rowInfo;o._dirty?(o._dirty=!1,this._rowInfoChanged()):t.prototype.refresh.call(this,e)},Object.defineProperty(r.prototype,"allowAddNew",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowDelete",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowSorting",{get:function(){return e.grid.AllowSorting.None},set:function(o){e.assert(o===e.grid.AllowSorting.None,"TransposedGrid does not support sorting."),this._alSorting=o},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnGroups",{get:function(){return null},set:function(e){throw"TransposedGrid does not support columnGroups, use rowGroups instead."},enumerable:!0,configurable:!0}),r.prototype.onRowEditEnded=function(o){var n=e.tryCast(this._sourceItems,"ICollectionView");if(n){var r=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change);n.collectionChanged.raise(n,r)}t.prototype.onRowEditEnded.call(this,o)},r.prototype._getCollectionView=function(o){var n=this,r=e.tryCast(this._sourceItems,"ICollectionView");r&&r.collectionChanged.removeHandler(this._sourceViewChanged),r=e.tryCast(o,"ICollectionView");var i=o;e.isArray(o)?i=this._transposeItemsSource(o):r&&(r.collectionChanged.addHandler(this._sourceViewChanged,this),i=this._transposeItemsSource(r.items)),this.autoGenerateColumns=!0;var s=t.prototype._getCollectionView.call(this,i),a=null;return r instanceof e.collections.CollectionView&&(a=r.getError),a&&s instanceof e.collections.CollectionView&&(this._supportsProxies()?s.getError=function(e,o){if(null==o)return null;var t=e._keys.indexOf(o);return a(e._arr[t],e._bnd.path)}:s.getError=function(e,o){if(null==o)return null;var t=parseInt(o.substr(n._keyPrefix.length));return a(e._arr[t],e._rowInfo.binding)}),this._sourceItems=o,s},r.prototype._getColumnTypes=function(o){var t,n=this;if(this._sourceItems)if(e.isArray(this._sourceItems))t=this._sourceItems;else{var r=e.tryCast(this._sourceItems,"ICollectionView");r&&(t=r.items)}return t?t.map((function(o,t){return{binding:n._keyPrefix+t,dataType:e.DataType.Object}})):e.getTypes(o)},r.prototype._copy=function(o,r){var i=this;if(/rows|columns/.test(o)){e.assert(e.isArray(r),"Array Expected.");var s=e.asArray(r);return s.some((function(e){return null!=e.columns}))?this.rowGroups=s:this._rowInfo.deferUpdate((function(){i.autoGenerateRows=!1,i._rowInfo.clear(),r.forEach((function(e){var o=new n(e);i._rowInfo.push(o)}))})),!0}return t.prototype._copy.call(this,o,r)},r.prototype.onLoadedRows=function(o){for(var n=this,r=this.columns,i=0;i<r.length;i++){var s=r[i];s.align=null,s.dataType=0}var a=this.rowHeaders.columns;for(i=0;i<a.length;i++)a[i].align="left",a[i].width=0;var l=e.grid.FlexGrid._getSerializableProperties(e.grid.Row);for(this.rows.forEach((function(e){var o=e.dataItem._rowInfo;if(o)if(n._copyProps(o,e,l,["showDropDown","width","size"]),n._hasColumnGroups())for(var t=0;t<a.length;t++){var r=n._grpHdl.getColumnGroup(e.index,t);r&&n._updateRowHeaders(e.index,t,r)}else a.length&&n._updateRowHeaders(e.index,a.length-1,o)})),i=0;i<a.length;i++)0===a[i].width&&(a[i].width=this.columns.defaultSize);t.prototype.onLoadedRows.call(this,o)},r.prototype._getBindingColumn=function(o,t,n){var r=n;if(o!=this.cells)return r;var i=o.rows[t].dataItem._rowInfo;if(e.isUndefined(i))return r;r=new e.grid.Column;var s=e.grid.FlexGrid._getSerializableProperties(e.grid.Column);return this._copyProps(i,r,s),r.binding=n.binding,r.header=i.header||e.toHeaderCase(i.binding),r},r.prototype._isTransposed=function(){return!0},r.prototype._copyProps=function(o,t,n,r){for(var i in void 0===r&&(r=[]),o)if(n.indexOf(i)>-1&&-1===r.indexOf(i)){var s=o[i];if(!e.isUndefined(s))try{t[i]=s}catch(e){}}},r.prototype._updateRowHeaders=function(o,t,n){var r=n.header||e.toHeaderCase(n.binding);this.rowHeaders.setCellData(o,t,r);var i=this.rowHeaders.columns,s=n.width;if(e.isNumber(s)&&s>0){var a=n._rng;if(a&&a instanceof e.grid.CellRange&&a.isValid){var l=a.columnSpan;e.assert(l>0,"Column span is negative or equal to 0"),s/=l}i[t].width=Math.max(i[t].width,s)}},r.prototype._rowInfoChanged=function(){var o=this;this._toRowInfo&&clearTimeout(this._toRowInfo),this._toRowInfo=setTimeout((function(){var e=o.selection,t=o.itemsSource;o.itemsSource=null,o.itemsSource=t,o.selection=e}),e.Control._REFRESH_INTERVAL)},r.prototype._sourceViewChanged=function(e,o){this.activeEditor||this.invalidate()},r.prototype._transposeItemsSource=function(o){var t=this,n=new e.collections.ObservableArray,r=e.getTypes(o),i=o.map((function(e,o){return t._keyPrefix+o}));return(this.autoGenerateRows?this._getRowInfo(o):this._rowInfo).forEach((function(s,a){var l=new e.Binding(s.binding);if(null==s.dataType&&o.length){var u=l.getValue(o[0]);s.dataType=null!=u?e.getType(u):r[a].dataType}if(t._supportsProxies()){var c=t._createProxy(o,s,i);n.push(c)}else{var p=t._createTransposedObject(o,s,t._keyPrefix);n.push(p)}})),o instanceof e.collections.ObservableArray&&o.collectionChanged.addHandler((function(o,r){if(r.action===e.collections.NotifyCollectionChangedAction.Change)t.activeEditor||t.invalidate();else{var i=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Reset);n.onCollectionChanged(i),t._rowInfoChanged()}})),n},r.prototype._supportsProxies=function(){return null!=window.Proxy},r.prototype._createProxy=function(o,t,n){var r={_arr:o,_rowInfo:t,_bnd:new e.Binding(t.binding),_keys:n};return new Proxy(r,{ownKeys:function(e){return e._keys},getOwnPropertyDescriptor:function(){return{enumerable:!0,configurable:!0,writable:!0}},get:function(e,o){var t=e._keys.indexOf(o);return t>-1?e._bnd.getValue(e._arr[t]):e[o]},set:function(o,t,n){var r=o._keys.indexOf(t);if(r>-1){var i=o._arr,s=i[r];if(o._bnd.setValue(s,n),i instanceof e.collections.ObservableArray){var a=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,s,r);i.onCollectionChanged(a)}return!0}return!1}})},r.prototype._createTransposedObject=function(o,t,n){for(var r={_arr:o,_rowInfo:t},i=new e.Binding(t.binding),s=function(t){var s=o[t];Object.defineProperty(r,n+t,{enumerable:!0,get:function(){return i.getValue(s)},set:function(n){if(i.setValue(s,n),o instanceof e.collections.ObservableArray){var r=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,s,t);o.onCollectionChanged(r)}return!0}})},a=0;a<o.length;a++)s(a);return r},r.prototype._getRowInfo=function(o){var t=this,n=[];return e.getTypes(o).forEach((function(o){var r=o.binding,i=o.dataType;if(i!=e.DataType.Object&&i!=e.DataType.Array){var s={binding:r,header:e.toHeaderCase(r),dataType:i},a=e.grid.FlexGrid._defTypeWidth[i];if(null!=a){if(e.isString(a)){var l=Math.round(parseFloat(a));a=a.indexOf("*")<0?l:l*t.columns.defaultSize}e.isNumber(a)&&a>0&&(s.width=a)}n.push(s)}})),n},r}(e.grid.FlexGrid);o.TransposedGrid=t;var n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),o}(e.grid.Column);o.TransposedGridRow=n}((o=e.grid||(e.grid={})).transposed||(o.transposed={}))}(wijmo||(wijmo={})),function(e){var o;!function(o){var t=function(){function o(e){this._grid=e}return Object.defineProperty(o.prototype,"columnGroups",{get:function(){return null},enumerable:!0,configurable:!0}),o.prototype.createColumnGroups=function(e){this._createRowGroups(e)},o.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0},o.prototype.getGroupDefinitions=function(){return this._groupDefs},o.prototype.getColumnGroup=function(e,o){var t=this._grid;if(o<t.rowHeaders.columns.length&&e<t._rowInfo.length)for(var n=this._colGroups;n;){for(var r=n,i=0;i<n.length;i++){var s=n[i],a=s._rng;if(a.containsRow(e)){if(a.containsColumn(o)||0==s.columns.length)return s;n=s.columns;break}}if(n==r)break}return null},o.prototype.canMoveColumnGroup=function(e,o,t,n){return this._grid.columns.canMoveElement(o,n)},o.prototype.moveColumnGroup=function(e,o,t,n,r){return this._grid.columns.moveElement(o,n)},o.prototype._createRowGroups=function(o){var t=this,r=this._grid;this._groupDefs=e.asArray(o),r.autoGenerateRows=!1,r._rowInfo.clear(),this._colGroups=[],o.forEach((function(e){t._colGroups.push(new n(e,null))}));var i=1;this._colGroups.forEach((function(e){t._addRowGroup(e),i=Math.max(i,e._getMaxLevel())})),this._colGroups.forEach((function(e){e._expandRange(i)}));var s=r.rowHeaders.columns;s.clear();for(var a=0;a<=i;a++){var l=new e.grid.Column;s.splice(a,0,l),a<i&&(l.cssClassAll="wj-colgroup")}},o.prototype._addRowGroup=function(e){var o=this,t=this._grid;e._grid=t,e._rng.row=t._rowInfo.length,0==e.columns.length?t._rowInfo.push(e):e.columns.forEach((function(e){o._addRowGroup(e)})),e._rng.row2=t._rowInfo.length-1},o}();o._RowGroupHandler=t;var n=function(o){function t(t,n){var r=o.call(this)||this;r._rng=new e.grid.CellRange(-1,0),r._cols=[],r._lvl=0,r._collapsed=!1,r._pGrp=n,r._lvl=0;for(var i=n;i;i=i._pGrp)r._lvl++;return n&&n.columns.indexOf(r)<0&&n.columns.push(r),r._rng.col=r._rng.col2=r._lvl,r.allowDragging=!1,e.copy(r,t),r}return __extends(t,o),Object.defineProperty(t.prototype,"columns",{get:function(){return this._cols},set:function(e){var o=this,n=this._cols=[];e.forEach((function(e){var r=new t(e,o);n.indexOf(r)<0&&n.push(r)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this._cols.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){for(var e=this,o=0;e._pGrp;)e=e._pGrp,o++;return o},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapseTo",{get:function(){return this._collTo},set:function(o){this._collTo=e.asString(o)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(o){var t=this;if(o!=this._collapsed){var n=this._grid;if(n){var r=new e.grid.CellRangeEventArgs(n.rowHeaders,this._rng,this);n.onColumnGroupCollapsedChanging(r)&&(this._collapsed=e.asBoolean(o),n.onColumnGroupCollapsedChanged(r))}else this._collapsed=e.asBoolean(o)}setTimeout((function(){t._updateCollapsedState()}))},enumerable:!0,configurable:!0}),t.prototype._copy=function(o,t){if(/rows|columns/.test(o)){var n=e.asArray(t);return this.columns=n,!0}return!1},t.prototype._updateCollapsedState=function(){var e=this._grid._rowInfo,o=this._rng,n=this._collapsed;this._cols.forEach((function(e){e instanceof t&&(e._collapsed=n,e._updateCollapsedState())}));var r=o.bottomRow;if(this.collapseTo)switch(this.collapseTo){case"$first":r=o.topRow;break;case"$last":r=o.bottomRow;break;default:var i=e.indexOf(this.collapseTo);i>-1&&(r=i)}for(var s=o.topRow;s<=o.bottomRow;s++)e[s].visible=!n||s==r},t.prototype._getMaxLevel=function(){var e=this._lvl;return this.columns.forEach((function(o){e=Math.max(e,o._getMaxLevel())})),e},t.prototype._expandRange=function(e){var o=e-this._getMaxLevel();o>0&&(this._rng.col2+=o,this._cols.forEach((function(e){e._shiftRange(o)})));for(var t=this._grid._rowInfo,n=this._rng,r=n.row;r<=n.row2;r++)t[r]._rng.col2=e},t.prototype._shiftRange=function(e){this._rng.col+=e,this._rng.col2+=e,this._cols.forEach((function(o){o._shiftRange(e)}))},t}(e.grid.Column);o._RowGroup=n}((o=e.grid||(e.grid={})).transposed||(o.transposed={}))}(wijmo||(wijmo={})),function(e){var o;(o=e.grid||(e.grid={})).transposed||(o.transposed={}),e._registerModule("wijmo.grid.transposed",e.grid.transposed)}(wijmo||(wijmo={}));