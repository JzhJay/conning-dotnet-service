/*! For license information please see wijmo.xlsx.js.LICENSE.txt */
var wijmo,__extends=this&&this.__extends||function(){var e=function(t,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},e(t,s)};return function(t,s){function l(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(l.prototype=s.prototype,new l)}}();!function(e){!function(t){"use strict";var s=function(){function s(){this._externalCancellation=null}return Object.defineProperty(s.prototype,"sheets",{get:function(){return null==this._sheets&&(this._sheets=[]),this._sheets},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"styles",{get:function(){return null==this._styles&&(this._styles=[]),this._styles},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"definedNames",{get:function(){return null==this._definedNames&&(this._definedNames=[]),this._definedNames},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"colorThemes",{get:function(){return null==this._colorThemes&&(this._colorThemes=[]),this._colorThemes},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"reservedContent",{get:function(){return null==this._reservedContent&&(this._reservedContent={}),this._reservedContent},set:function(e){this._reservedContent=e},enumerable:!0,configurable:!0}),s.prototype.save=function(e){var l=t._xlsx.save(this),i=!(!this._reservedContent||!this._reservedContent.macros);return e&&s._saveToFile(l.base64,e,i),l.base64},s.prototype.saveAsync=function(l,i,r,n){var o=this;this.cancelAsync((function(){o._cs=e.isFunction(o._externalCancellation)?o._externalCancellation():new t._SyncPromise,t._xlsx.saveAsync(o,o._cs,r,n).then((function(t){if(l){var r=!(!o._reservedContent||!o._reservedContent.macros);s._saveToFile(t,l,r)}o._cs=null,e.isFunction(n)&&n(100),i&&i(t)}),(function(){return o._cs=null}))}))},s.prototype.cancelAsync=function(t){var s=this;this._cs?(this._cs.cancel(),setTimeout((function(){s._cs=null,e.isFunction(t)&&t()}),100)):e.isFunction(t)&&t()},s.prototype.load=function(s){e.isString(s)&&(s=this._getBase64String(s));var l=t._xlsx.load(s);this._deserialize(l),s=null,l=null},s.prototype.loadAsync=function(s,l,i){var r=this;e.isString(s)&&(s=this._getBase64String(s)),t._xlsx.loadAsync(s).then((function(e){r._deserialize(e),s=null,e=null,l(r)})).catch(i)},s.prototype._serialize=function(){var e={sheets:[]};return e.sheets=this._serializeWorkSheets(),this._styles&&this._styles.length>0&&(e.styles=this._serializeWorkbookStyles()),this._reservedContent&&(e.reservedContent=this._reservedContent),null!=this.activeWorksheet&&!isNaN(this.activeWorksheet)&&this.activeWorksheet>=0&&(e.activeWorksheet=this.activeWorksheet),this.application&&(e.application=this.application),this.company&&(e.company=this.company),null!=this.created&&(e.created=this.created),this.creator&&(e.creator=this.creator),this.lastModifiedBy&&(e.lastModifiedBy=this.lastModifiedBy),null!=this.modified&&(e.modified=this.modified),this._definedNames&&this._definedNames.length>0&&(e.definedNames=this._serializeDefinedNames()),this._colorThemes&&this._colorThemes.length>0&&(e.colorThemes=this._colorThemes.slice()),e},s.prototype._deserialize=function(e){this._deserializeWorkSheets(e.sheets),e.styles&&e.styles.length>0&&this._deserializeWorkbookStyles(e.styles),this.activeWorksheet=e.activeWorksheet,this.application=e.application,this.company=e.company,this.created=e.created,this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.modified=e.modified,this.reservedContent=e.reservedContent,e.definedNames&&e.definedNames.length>0&&this._deserializeDefinedNames(e.definedNames),e.colorThemes&&e.colorThemes.length>0&&(this._colorThemes=e.colorThemes.slice())},s.prototype._addWorkSheet=function(e,t){null==this._sheets&&(this._sheets=[]),null==t||isNaN(t)?this._sheets.push(e):this._sheets[t]=e},s._saveToFile=function(e,t,s){var l,i,r,n,o,a,h=window.document,u=s?"xlsm":"xlsx",c="xlsm"===u?"application/vnd.ms-excel.sheet.macroEnabled.12":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if((i=t.lastIndexOf("."))<0)t+="."+u;else{if(0===i)throw"Invalid file name.";(""===(l=t.substring(i+1))||l!==u)&&(t+="."+u)}r=new Blob([z.toArray(e)],{type:c}),navigator.msSaveBlob?navigator.msSaveBlob(r,t):URL.createObjectURL?(o=h.createElement("a"),a=function(e){var t=h.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)},o.download=t,o.href=URL.createObjectURL(r),a(o),o=null):(n=new FileReader,o=h.createElement("a"),a=function(e){var t=h.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)},n.onload=function(){o.download=t,o.href=n.result,a(o),o=null},n.readAsDataURL(r))},s.prototype._getBase64String=function(e){if(null==e||0===e.length)throw"Invalid xlsx file content.";var t=e.search(/base64,/i);return-1!==t?e.substring(t+7):e},s.toXlsxDateFormat=function(t){var s;if(1===t.length)switch(t){case"r":case"R":return"ddd, dd MMM yyyy HH:mm:ss &quot;GMT&quot;";case"u":return"yyyy-MM-dd&quot;T&quot;HH:mm:ss&quot;Z&quot;";case"o":case"O":s=(s=e.culture.Globalize.calendar.patterns[t]).replace(/f+k/gi,"000");break;default:s=e.culture.Globalize.calendar.patterns[t]}return s||(s=t),s=s.replace(/"/g,"").replace(/tt/,"AM/PM").replace(/t/,"A/P").replace(/M+/gi,(function(e){return e.toLowerCase()})).replace(/g+y+/gi,(function(e){return e.substring(0,e.indexOf("y"))+"e"})),/FY|Q/i.test(s)?"General":s},s.toXlsxNumberFormat=function(t){var s,l,i,r=t?t.toLowerCase():"";if(/^[ncpfdg]\d*.*,*$/.test(r)&&(s=r[0],l=this._formatMap[s]),l){var n=r.split(",");if("c"===s){var o=e.culture.Globalize.numberFormat.currency,a=t?t.match(/([a-z])(\d*)(,*)(.*)/i):null,h=a&&a[4]?a[4]:o.symbol;"â€‹"===h&&(h="");var u=this._formatMap.n,c=o.pattern,f=c[0].replace("n",u).replace("$","{1}"),d=c[1].replace("n",u).replace("$","{1}");")"===f[f.length-1]&&(d+="_)"),l=(l=d+";"+f).replace(/\{1\}/g,h)}var m=-1;r.length>1?m=parseInt(n[0].substr(1)):"d"!==s&&(m=2);var p="";if(!isNaN(m))for(var g=0;g<m;g++)p+="0";for(g=0;g<n.length-1;g++)p+=",";i=p.length>0?"d"===s?l.replace(/\{0\}/g,p):l.replace(/\{0\}/g,(!isNaN(m)&&m>0?".":"")+p):"d"===s?l.replace(/\{0\}/g,"0"):l.replace(/\{0\}/g,"")}else i=r;return i},s.fromXlsxFormat=function(t){var s,l,i,r,n,o,a,h,u,c=[],f=e.culture.Globalize.numberFormat.currency.symbol;if(!t||"General"===t)return[""];for(l=(t=t.replace(/;@/g,"").replace(/&quot;?/g,"")).split(";"),r=0;r<l.length;r++){if(i=l[r],/[hsmy\:]/i.test(i))s=this._fromXlsxDateFormat(i);else if(o=i.lastIndexOf("."),a=i.lastIndexOf("0"),h=i.lastIndexOf(","),s=i.search(/\[\$([^\-\]]+)[^\]]*\]/)>-1||i.indexOf(f)>-1&&-1===i.search(/\[\$([\-\]]+)[^\]]*\]/)?"c":"%"===i[t.length-1]?"p":"n",s+=o>-1&&o<a?i.substring(o,a).length:"0",/^0+,*$/.test(i)&&(s="d"+((a=i.lastIndexOf("0"))+1)),h>-1&&a>-1&&a<h)for(u=i.substring(a+1,h+1).split(""),n=0;n<u.length;n++)s+=",";c.push(s)}return c},s._fromXlsxDateFormat=function(e){return e.replace(/\[\$\-.+\]/g,"").replace(/(\\)(.)/g,"$2").replace(/H+/g,(function(e){return e.toLowerCase()})).replace(/m+/g,(function(e){return e.toUpperCase()})).replace(/S+/g,(function(e){return e.toLowerCase()})).replace(/AM\/PM/gi,"tt").replace(/A\/P/gi,"t").replace(/\.000/g,".fff").replace(/\.00/g,".ff").replace(/\.0/g,".f").replace(/\\[\-\s,]/g,(function(e){return e.substring(1)})).replace(/Y+/g,(function(e){return e.toLowerCase()})).replace(/D+/g,(function(e){return e.toLowerCase()})).replace(/M+:?|:?M+/gi,(function(e){return e.indexOf(":")>-1?e.toLowerCase():e})).replace(/g+e/gi,(function(e){return e.substring(0,e.length-1)+"yy"}))},s._parseCellFormat=function(e,t){return t?this.toXlsxDateFormat(e):this.toXlsxNumberFormat(e)},s._parseExcelFormat=function(t){if(null!=t){var s=t&&t.style&&t.style.format;if((null!=t.value||s)&&!isNaN(t.value)){var l=e.isNumber(t.value);return!l||s&&"General"!==s?t.isDate||e.isDate(t.value)||l||""===t.value||t.isNumber?this.fromXlsxFormat(s)[0]:s:e.isInt(t.value)?"d":"f2"}}},s.xlsxAddress=function(e,t,s,l,i){var r=s?"$":"",n=null==l?r:l?"$":"";return!0===i?"":(isNaN(t)?"":n+this._numAlpha(t))+(!1===i||isNaN(e)?"":r+(e+1).toString())},s.tableAddress=function(e){var t=e&&/^((\$?)([A-Za-z]+))?((\$?)(\d+))?$/.exec(e),s={};return t?(t[3]&&(s.col=this._alphaNum(t[3]),s.absCol=!!t[2]),t[6]&&(s.row=+t[6]-1,s.absRow=!!t[5]),s):null},s._parseHAlignToString=function(e){switch(e){case S.Left:return"left";case S.Center:return"center";case S.Right:return"right";case S.Justify:return"justify";default:return"general"}},s._parseStringToHAlign=function(e){var t=e?e.toLowerCase():"";return"left"===t?S.Left:"center"===t?S.Center:"right"===t?S.Right:"justify"===t?S.Justify:S.General},s._parseVAlignToString=function(e){switch(e){case C.Bottom:return"bottom";case C.Center:return"center";case C.Top:return"top";default:return null}},s._parseStringToVAlign=function(e){var t=e?e.toLowerCase():"";return"top"===t?C.Top:"center"===t?C.Center:"bottom"===t?C.Bottom:null},s._parseBorderTypeToString=function(e){switch(e){case k.Dashed:return"dashed";case k.Dotted:return"dotted";case k.Double:return"double";case k.Hair:return"hair";case k.Medium:return"medium";case k.MediumDashDotDotted:return"mediumDashDotDot";case k.MediumDashDotted:return"mediumDashDot";case k.MediumDashed:return"mediumDashed";case k.SlantedMediumDashDotted:return"slantDashDot";case k.Thick:return"thick";case k.Thin:return"thin";case k.ThinDashDotDotted:return"dashDotDot";case k.ThinDashDotted:return"dashDot";case k.None:default:return"none"}},s._parseStringToBorderType=function(e){return"dashed"===e?k.Dashed:"dotted"===e?k.Dotted:"double"===e?k.Double:"hair"===e?k.Hair:"medium"===e?k.Medium:"mediumDashDotDot"===e?k.MediumDashDotDotted:"mediumDashDot"===e?k.MediumDashDotted:"mediumDashed"===e?k.MediumDashed:"slantDashDot"===e?k.SlantedMediumDashDotted:"thick"===e?k.Thick:"thin"===e?k.Thin:"dashDotDot"===e?k.ThinDashDotDotted:"dashDot"===e?k.ThinDashDotted:null},s._escapeXML=function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""},s._unescapeXML=function(e){return"string"==typeof e?e.indexOf("&")>=0?e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/").replace(/&amp;/g,"&"):e:""},s._numAlpha=function(e){var t=Math.floor(e/26)-1;return(t>-1?this._numAlpha(t):"")+this._alphabet.charAt(e%26)},s._alphaNum=function(e){var t=0;return e&&(e=e.toUpperCase()),2===e.length&&(t=this._alphaNum(e.charAt(0))+1),26*t+this._alphabet.indexOf(e.substr(-1))},s.prototype._serializeWorkSheets=function(){var e,t,s=[];for(t=0;t<this._sheets.length;t++)(e=this._sheets[t])&&(s[t]=e._serialize());return s},s.prototype._serializeWorkbookStyles=function(){var e,t,s=[];for(t=0;t<this._styles.length;t++)(e=this._styles[t])&&(s[t]=e._serialize());return s},s.prototype._serializeDefinedNames=function(){var e,t,s=[];for(t=0;t<this._definedNames.length;t++)(e=this._definedNames[t])&&(s[t]=e._serialize());return s},s.prototype._serializeTableStyles=function(){var e,t,s=[];for(t=0;t<this._tableStyles.length;t++)(e=this._tableStyles[t])&&(s[t]=e._serialize());return s},s.prototype._deserializeWorkSheets=function(t){var s,i,r;for(this._sheets=[],e.assert(null!=t,"workSheets should not be null."),r=0;r<t.length;r++)(i=t[r])&&((s=new l)._deserialize(i),this._sheets[r]=s)},s.prototype._deserializeWorkbookStyles=function(e){var t,s,l;for(this._styles=[],l=0;l<e.length;l++)(s=e[l])&&((t=new u)._deserialize(s),this._styles[l]=t)},s.prototype._deserializeDefinedNames=function(e){var t,s,l;for(this._definedNames=[],l=0;l<e.length;l++)(s=e[l])&&((t=new p)._deserialize(s),this._definedNames[l]=t)},s.prototype._deserializeTableStyles=function(e){var t,s,l;for(this._tableStyles=[],l=0;l<e.length;l++)(s=e[l])&&((t=new y)._deserialize(s),this._tableStyles[l]=t)},s._alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s._formatMap={n:"#,##0{0}",c:"{1}#,##0{0}_);({1}#,##0{0})",p:"#,##0{0}%",f:"0{0}",d:"{0}",g:"0{0}"},s}();t.Workbook=s;var l=function(){function e(){}return Object.defineProperty(e.prototype,"columns",{get:function(){return null==this._columns&&(this._columns=[]),this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return null==this._rows&&(this._rows=[]),this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tables",{get:function(){return null==this._tables&&(this._tables=[]),this._tables},enumerable:!0,configurable:!0}),e.prototype._serialize=function(){var e;return this._checkEmptyWorkSheet()?null:(e={},this.style&&(e.style=this.style._serialize()),this._columns&&this._columns.length>0&&(e.columns=this._serializeWorkbookColumns()),this._rows&&this._rows.length>0&&(e.rows=this._serializeWorkbookRows()),this.frozenPane&&(e.frozenPane=this.frozenPane._serialize()),this.name&&(e.name=this.name),null!=this.summaryBelow&&(e.summaryBelow=this.summaryBelow),null!=this.visible&&(e.visible=this.visible),this._tables&&this._tables.length>0&&(e.tables=this._serializeTables()),this._extraColumn&&(e._extraColumn=this._extraColumn._serialize()),e)},e.prototype._deserialize=function(e){var t,s;e.style&&((s=new u)._deserialize(e.style),this.style=s),e.columns&&e.columns.length>0&&this._deserializeWorkbookColumns(e.columns),e.rows&&e.rows.length>0&&this._deserializeWorkbookRows(e.rows),e.frozenPane&&((t=new h)._deserialize(e.frozenPane),this.frozenPane=t),this.name=e.name,this.summaryBelow=e.summaryBelow,this.visible=e.visible,e.tables&&e.tables.length>0&&this._deserializeTables(e.tables),e._extraColumn&&(this._extraColumn=new r,this._extraColumn._deserialize(e._extraColumn))},e.prototype._addWorkbookColumn=function(e,t){null==this._columns&&(this._columns=[]),null==t||isNaN(t)?this._columns.push(e):this._columns[t]=e},e.prototype._addWorkbookRow=function(e,t){null==this._rows&&(this._rows=[]),null==t||isNaN(t)?this._rows.push(e):this._rows[t]=e},e.prototype._serializeWorkbookColumns=function(){var e,t,s=[];for(t=0;t<this._columns.length;t++)(e=this._columns[t])&&(s[t]=e._serialize());return s},e.prototype._serializeWorkbookRows=function(){var e,t,s=[];for(t=0;t<this._rows.length;t++)(e=this._rows[t])&&(s[t]=e._serialize());return s},e.prototype._serializeTables=function(){var e,t,s=[];for(t=0;t<this._tables.length;t++)(e=this._tables[t])&&(s[t]=e._serialize());return s},e.prototype._deserializeWorkbookColumns=function(e){var t,s,l;for(this._columns=[],l=0;l<e.length;l++)(t=e[l])&&((s=new i)._deserialize(t),this._columns[l]=s)},e.prototype._deserializeWorkbookRows=function(e){var t,s,l;for(this._rows=[],l=0;l<e.length;l++)(t=e[l])&&((s=new n)._deserialize(t),this._rows[l]=s)},e.prototype._deserializeTables=function(e){var t,s,l;for(this._tables=[],l=0;l<e.length;l++)(s=e[l])&&((t=new g)._deserialize(s),this._tables[l]=t)},e.prototype._checkEmptyWorkSheet=function(){return!(null!=this._rows||null!=this._columns||null!=this.visible||null!=this.summaryBelow||null!=this.frozenPane||null!=this.style||null!=this.name&&""!==this.name||null!=this._tables&&0!=this._tables.length)},e}();t.WorkSheet=l;var i=function(){function e(){}return e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookColumn()?null:(e={},this.style&&(e.style=this.style._serialize()),null!=this.autoWidth&&(e.autoWidth=this.autoWidth),null!=this.width&&(e.width=this.width),null!=this.visible&&(e.visible=this.visible),e)},e.prototype._deserialize=function(e){var t;e.style&&((t=new u)._deserialize(e.style),this.style=t),this.autoWidth=e.autoWidth,this.visible=e.visible,this.width=e.width},e.prototype._checkEmptyWorkbookColumn=function(){return null==this.style&&null==this.width&&null==this.autoWidth&&null==this.visible},e}();t.WorkbookColumn=i;var r=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype._serialize=function(){var t=e.prototype._serialize.call(this);return t.min=this.min,t.max=this.max,t},t.prototype._deserialize=function(t){e.prototype._deserialize.call(this,t),this.min=t.min,this.max=t.max},t}(i);t._WorkbookExtraColumn=r;var n=function(){function e(){}return Object.defineProperty(e.prototype,"cells",{get:function(){return null==this._cells&&(this._cells=[]),this._cells},enumerable:!0,configurable:!0}),e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookRow()?null:(e={},this._cells&&this._cells.length>0&&(e.cells=this._serializeWorkbookCells()),this.style&&(e.style=this.style._serialize()),null!=this.collapsed&&(e.collapsed=this.collapsed),null==this.groupLevel||isNaN(this.groupLevel)||(e.groupLevel=this.groupLevel),null==this.height||isNaN(this.height)||(e.height=this.height),null!=this.visible&&(e.visible=this.visible),e)},e.prototype._deserialize=function(e){var t;e.cells&&e.cells.length>0&&this._deserializeWorkbookCells(e.cells),e.style&&((t=new u)._deserialize(e.style),this.style=t),this.collapsed=e.collapsed,this.groupLevel=e.groupLevel,this.height=e.height,this.visible=e.visible},e.prototype._addWorkbookCell=function(e,t){null==this._cells&&(this._cells=[]),null==t||isNaN(t)?this._cells.push(e):this._cells[t]=e},e.prototype._serializeWorkbookCells=function(){var e,t,s=[];for(t=0;t<this._cells.length;t++)(e=this._cells[t])&&(s[t]=e._serialize());return s},e.prototype._deserializeWorkbookCells=function(e){var t,s,l;for(this._cells=[],l=0;l<e.length;l++)(t=e[l])&&((s=new o)._deserialize(t),this._cells[l]=s)},e.prototype._checkEmptyWorkbookRow=function(){return null==this._cells&&null==this.style&&null==this.collapsed&&null==this.visible&&(null==this.height||isNaN(this.height))&&(null==this.groupLevel||isNaN(this.groupLevel))},e}();t.WorkbookRow=n;var o=function(){function e(){}return e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookCell()?null:(e={},this.style&&(e.style=this.style._serialize()),null!=this.value&&(e.value=this.value),this.formula&&(e.formula=this.formula),null!=this.isDate&&(e.isDate=this.isDate),null!=this.isNumber&&(e.isNumber=this.isNumber),null!=this.colSpan&&!isNaN(this.colSpan)&&this.colSpan>1&&(e.colSpan=this.colSpan),null!=this.rowSpan&&!isNaN(this.rowSpan)&&this.rowSpan>1&&(e.rowSpan=this.rowSpan),this.link&&(e.link=this.link),e.textRuns=A.serialize(this.textRuns),this.note&&(e.note=this.note._serialize()),e)},e.prototype._deserialize=function(e){var t;e.style&&((t=new u)._deserialize(e.style),this.style=t),this.value=e.value,this.formula=e.formula,this.isDate=e.isDate,this.isNumber=e.isNumber,this.colSpan=e.colSpan,this.rowSpan=e.rowSpan,this.link=e.link,this.textRuns=A.deserialize(e.textRuns),e.note&&(this.note=new a,this.note._deserialize(e.note))},e.prototype._checkEmptyWorkbookCell=function(){return null==this.style&&null==this.value&&null==this.isDate&&null==this.isNumber&&(null==this.formula||""===this.formula)&&(null==this.colSpan||isNaN(this.colSpan)||this.colSpan<=1)&&(null==this.rowSpan||isNaN(this.rowSpan)||this.rowSpan<=1)&&(null==this.link||""===this.link)},e}();t.WorkbookCell=o;var a=function(){function e(){}return e.prototype._serialize=function(){if(!(null!=this.text||this.textRuns&&this.textRuns.length))return null;var e={};return null!=this.author&&(e.author=this.author),null!=this.text&&(e.text=this.text),e.textRuns=A.serialize(this.textRuns),null!=this.visible&&(e.visible=this.visible),null!=this.offsetX&&(e.offsetX=this.offsetX),null!=this.offsetY&&(e.offsetY=this.offsetY),null!=this.width&&(e.width=this.width),null!=this.height&&(e.height=this.height),e},e.prototype._deserialize=function(e){this.author=e.author,this.text=e.text,this.textRuns=A.deserialize(e.textRuns),this.visible=e.visible,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.width=e.width,this.height=e.height},e}();t.WorkbookNote=a;var h=function(){function e(){}return e.prototype._serialize=function(){return null!=this.columns&&!isNaN(this.columns)&&0!==this.columns||null!=this.rows&&!isNaN(this.rows)&&0!==this.rows?{columns:this.columns,rows:this.rows}:null},e.prototype._deserialize=function(e){this.columns=e.columns,this.rows=e.rows},e}();t.WorkbookFrozenPane=h;var u=function(){function t(){}return t.prototype._serialize=function(){var t;return this._checkEmptyWorkbookStyle()?null:(t={},this.basedOn&&(t.basedOn=this.basedOn._serialize()),this.fill&&(t.fill=this.fill._serialize()),this.font&&(t.font=this.font._serialize()),this.borders&&(t.borders=this.borders._serialize()),this.format&&(t.format=this.format),null!=this.hAlign&&(t.hAlign=e.asEnum(this.hAlign,S,!1)),null!=this.vAlign&&(t.vAlign=e.asEnum(this.vAlign,C,!1)),null==this.indent||isNaN(this.indent)||(t.indent=this.indent),this.wordWrap&&(t.wordWrap=this.wordWrap),t)},t.prototype._deserialize=function(s){var l,i,r,n;s.basedOn&&((l=new t)._deserialize(s.basedOn),this.basedOn=l),s.fill&&((i=new f)._deserialize(s.fill),this.fill=i),s.font&&((r=new c)._deserialize(s.font),this.font=r),s.borders&&((n=new d)._deserialize(s.borders),this.borders=n),this.format=s.format,null!=s.hAlign&&(this.hAlign=e.asEnum(s.hAlign,S,!1)),null!=s.vAlign&&(this.vAlign=e.asEnum(s.vAlign,C,!1)),null==s.indent||isNaN(s.indent)||(this.indent=s.indent),s.wordWrap&&(this.wordWrap=s.wordWrap)},t.prototype._checkEmptyWorkbookStyle=function(){return null==this.basedOn&&null==this.fill&&null==this.font&&null==this.borders&&(null==this.format||""===this.format)&&null==this.hAlign&&null==this.vAlign&&null==this.wordWrap},t}();t.WorkbookStyle=u;var c=function(){function e(){}return e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookFont()?null:(e={},null!=this.bold&&(e.bold=this.bold),null!=this.italic&&(e.italic=this.italic),null!=this.underline&&(e.underline=this.underline),this.color&&(e.color=this.color),this.family&&(e.family=this.family),null==this.size||isNaN(this.size)||(e.size=this.size),e)},e.prototype._deserialize=function(e){this.bold=e.bold,null!=e.color&&(this.color=e.color),this.family=e.family,this.italic=e.italic,this.size=e.size,this.underline=e.underline},e.prototype._checkEmptyWorkbookFont=function(){return null==this.bold&&null==this.italic&&null==this.underline&&(null==this.color||""===this.color)&&(null==this.family||""===this.family)&&(null==this.size||isNaN(this.size))},e}();t.WorkbookFont=c;var f=function(){function e(){}return e.prototype._serialize=function(){return this.color?{color:this.color}:null},e.prototype._deserialize=function(e){null!=e.color&&(this.color=e.color)},e}();t.WorkbookFill=f;var d=function(){function e(){}return e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookBorder()?null:(e={},this.top&&(e.top=this.top._serialize()),this.bottom&&(e.bottom=this.bottom._serialize()),this.left&&(e.left=this.left._serialize()),this.right&&(e.right=this.right._serialize()),this.diagonal&&(e.diagonal=this.diagonal._serialize()),e)},e.prototype._deserialize=function(e){var t,s,l,i,r;e.top&&((t=new m)._deserialize(e.top),this.top=t),e.bottom&&((s=new m)._deserialize(e.bottom),this.bottom=s),e.left&&((l=new m)._deserialize(e.left),this.left=l),e.right&&((i=new m)._deserialize(e.right),this.right=i),e.diagonal&&((r=new m)._deserialize(e.diagonal),this.diagonal=r)},e.prototype._checkEmptyWorkbookBorder=function(){return null==this.top&&null==this.bottom&&null==this.left&&null==this.right&&null==this.diagonal},e}();t.WorkbookBorder=d;var m=function(){function t(){}return t.prototype._serialize=function(){var t;return null!=this.color&&""!==this.color||null!=this.style?(t={},this.color&&(t.color=this.color),null!=this.style&&(t.style=e.asEnum(this.style,k,!1)),t):null},t.prototype._deserialize=function(t){null==t.color&&null==t.style||(this.color=t.color,null!=t.style&&(this.style=e.asEnum(t.style,k,!1)))},t}();t.WorkbookBorderSetting=m;var p=function(){function e(){}return e.prototype._serialize=function(){var e;return null==this.name?null:(e={name:this.name,value:this.value},null!=this.sheetName&&(e.sheetName=this.sheetName),e)},e.prototype._deserialize=function(e){this.name=e.name,this.value=e.value,this.sheetName=e.sheetName},e}();t.DefinedName=p;var g=function(){function t(){}return Object.defineProperty(t.prototype,"columns",{get:function(){return null==this._columns&&(this._columns=[]),this._columns},enumerable:!0,configurable:!0}),t.prototype._serialize=function(){var e,t;return null==this.name||null==this.range||null==this._columns?null:(null!=this.style&&(t=this.style._serialize()),(e={name:this.name,range:this.range,showHeaderRow:this.showHeaderRow,showTotalRow:this.showTotalRow,style:t,showBandedColumns:this.showBandedColumns,showBandedRows:this.showBandedRows,alterFirstColumn:this.alterFirstColumn,alterLastColumn:this.alterLastColumn,columns:[]}).columns=this._serializeTableColumns(),e)},t.prototype._deserialize=function(e){var t;this.name=e.name,this.range=e.range,this.showHeaderRow=e.showHeaderRow,this.showTotalRow=e.showTotalRow,null!=e.style&&((t=new y)._deserialize(e.style),this.style=t),this.showBandedColumns=e.showBandedColumns,this.showBandedRows=e.showBandedRows,this.alterFirstColumn=e.alterFirstColumn,this.alterLastColumn=e.alterLastColumn,this._deserializeTableColumns(e.columns)},t.prototype._serializeTableColumns=function(){var e,t,s=[];for(t=0;t<this._columns.length;t++)(e=this._columns[t])&&(s[t]=e._serialize());return s},t.prototype._deserializeTableColumns=function(t){var s,l,i;for(e.assert(null!=t,"table Columns should not be null."),this._columns=[],i=0;i<t.length;i++)(l=t[i])&&((s=new _)._deserialize(l),this._columns[i]=s)},t}();t.WorkbookTable=g;var _=function(){function e(){}return e.prototype._serialize=function(){return null==this.name?null:{name:this.name,totalRowLabel:this.totalRowLabel,totalRowFunction:this.totalRowFunction,showFilterButton:this.showFilterButton}},e.prototype._deserialize=function(e){this.name=e.name,this.totalRowLabel=e.totalRowLabel,this.totalRowFunction=e.totalRowFunction,this.showFilterButton=e.showFilterButton},e}();t.WorkbookTableColumn=_;var y=function(){function e(){}return e.prototype._serialize=function(){var e;return this._checkEmptyWorkbookTableStyle()?null:(e={name:this.name},this.wholeTableStyle&&(e.wholeTableStyle=this.wholeTableStyle._serialize()),this.firstBandedColumnStyle&&(e.firstBandedColumnStyle=this.firstBandedColumnStyle._serialize()),this.firstBandedRowStyle&&(e.firstBandedRowStyle=this.firstBandedRowStyle._serialize()),this.secondBandedColumnStyle&&(e.secondBandedColumnStyle=this.secondBandedColumnStyle._serialize()),this.secondBandedRowStyle&&(e.secondBandedRowStyle=this.secondBandedRowStyle._serialize()),this.headerRowStyle&&(e.headerRowStyle=this.headerRowStyle._serialize()),this.totalRowStyle&&(e.totalRowStyle=this.totalRowStyle._serialize()),this.firstColumnStyle&&(e.firstColumnStyle=this.firstColumnStyle._serialize()),this.lastColumnStyle&&(e.lastColumnStyle=this.lastColumnStyle._serialize()),this.firstHeaderCellStyle&&(e.firstHeaderCellStyle=this.firstHeaderCellStyle._serialize()),this.lastHeaderCellStyle&&(e.lastHeaderCellStyle=this.lastHeaderCellStyle._serialize()),this.firstTotalCellStyle&&(e.firstTotalCellStyle=this.firstTotalCellStyle._serialize()),this.lastTotalCellStyle&&(e.lastTotalCellStyle=this.lastTotalCellStyle._serialize()),e)},e.prototype._deserialize=function(e){this.name=e.name,e.wholeTableStyle&&(this.wholeTableStyle=new v,this.wholeTableStyle._deserialize(e.wholeTableStyle)),e.firstBandedColumnStyle&&(this.firstBandedColumnStyle=new b,this.firstBandedColumnStyle._deserialize(e.firstBandedColumnStyle)),e.firstBandedRowStyle&&(this.firstBandedRowStyle=new b,this.firstBandedRowStyle._deserialize(e.firstBandedRowStyle)),e.secondBandedColumnStyle&&(this.secondBandedColumnStyle=new b,this.secondBandedColumnStyle._deserialize(e.secondBandedColumnStyle)),e.secondBandedRowStyle&&(this.secondBandedRowStyle=new b,this.secondBandedRowStyle._deserialize(e.secondBandedRowStyle)),e.headerRowStyle&&(this.headerRowStyle=new v,this.headerRowStyle._deserialize(e.headerRowStyle)),e.totalRowStyle&&(this.totalRowStyle=new v,this.totalRowStyle._deserialize(e.totalRowStyle)),e.firstColumnStyle&&(this.firstColumnStyle=new v,this.firstColumnStyle._deserialize(e.firstColumnStyle)),e.lastColumnStyle&&(this.lastColumnStyle=new v,this.lastColumnStyle._deserialize(e.lastColumnStyle)),e.firstHeaderCellStyle&&(this.firstHeaderCellStyle=new v,this.firstHeaderCellStyle._deserialize(e.firstHeaderCellStyle)),e.lastHeaderCellStyle&&(this.lastHeaderCellStyle=new v,this.lastHeaderCellStyle._deserialize(e.lastHeaderCellStyle)),e.firstTotalCellStyle&&(this.firstTotalCellStyle=new v,this.firstTotalCellStyle._deserialize(e.firstTotalCellStyle)),e.lastTotalCellStyle&&(this.lastTotalCellStyle=new v,this.lastTotalCellStyle._deserialize(e.lastTotalCellStyle))},e.prototype._checkEmptyWorkbookTableStyle=function(){return null==this.name||null==this.wholeTableStyle&&null==this.firstBandedColumnStyle&&null==this.firstBandedRowStyle&&null==this.secondBandedColumnStyle&&null==this.secondBandedRowStyle&&null==this.headerRowStyle&&null==this.totalRowStyle&&null==this.firstColumnStyle&&null==this.lastColumnStyle&&null==this.firstHeaderCellStyle&&null==this.lastHeaderCellStyle&&null==this.firstTotalCellStyle&&null==this.lastTotalCellStyle},e}();t.WorkbookTableStyle=y;var v=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype._deserialize=function(t){var s;e.prototype._deserialize.call(this,t),t.borders&&((s=new x)._deserialize(t.borders),this.borders=s)},t}(u);t.WorkbookTableCommonStyle=v;var b=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype._serialize=function(){var t;return(t=e.prototype._serialize.call(this)).size=this.size,t},t.prototype._deserialize=function(t){e.prototype._deserialize.call(this,t),null!=t.size&&(this.size=t.size)},t}(v);t.WorkbookTableBandedStyle=b;var x=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype._serialize=function(){var t;return null!=(t=e.prototype._serialize.call(this))||this.vertical&&this.horizontal||(t={}),this.vertical&&(t.vertical=this.vertical._serialize()),this.horizontal&&(t.horizontal=this.horizontal._serialize()),t},t.prototype._deserialize=function(t){var s,l;e.prototype._deserialize.call(this,t),t.vertical&&((s=new m)._deserialize(t.vertical),this.vertical=s),t.horizontal&&((l=new m)._deserialize(t.horizontal),this.horizontal=l)},t}(d);t.WorkbookTableBorder=x;var w=function(){function e(){}return e.prototype._serialize=function(){var e={text:this.text};return this.font&&(e.font=this.font._serialize()),e},e.prototype._deserialize=function(e){e.font&&(this.font=new c,this.font._deserialize(e.font)),this.text=e.text},e}();t.WorkbookTextRun=w;var S,C,k,F,T,z=function(){function e(){}return e._b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e.toArray=function(e,t){for(var s,l,i=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=i.length,n=t?Math.ceil((3*r+1>>2)/t)*t:3*r+1>>2,o=new Uint8Array(n),a=0,h=0,u=0;u<r;u++)if(l=3&u,a|=this._b64ToUint6(i.charCodeAt(u))<<18-6*l,3===l||r-u==1){for(s=0;s<3&&h<n;s++,h++)o[h]=a>>>(16>>>s&24)&255;a=0}return o},e}(),A=function(){function e(){}return e.deserialize=function(e){return e&&e.length?e.map((function(e){var t=new w;return t._deserialize(e),t})):null},e.serialize=function(e){return e&&e.length?e.map((function(e){return e._serialize()})):null},e}();!function(e){e[e.General=0]="General",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify"}(S=t.HAlign||(t.HAlign={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify"}(C=t.VAlign||(t.VAlign={})),(T=t.TextDirection||(t.TextDirection={}))[T.Context=0]="Context",T[T.LeftToRight=1]="LeftToRight",T[T.RightToLeft=2]="RightToLeft",(F=t.TextOrientation||(t.TextOrientation={}))[F.Horizontal=0]="Horizontal",F[F.Vertical=1]="Vertical",F[F.RotateUp=2]="RotateUp",F[F.RotateDown=3]="RotateDown",function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.ThinDashDotted=9]="ThinDashDotted",e[e.MediumDashDotted=10]="MediumDashDotted",e[e.ThinDashDotDotted=11]="ThinDashDotDotted",e[e.MediumDashDotDotted=12]="MediumDashDotDotted",e[e.SlantedMediumDashDotted=13]="SlantedMediumDashDotted"}(k=t.BorderStyle||(t.BorderStyle={}))}(e.xlsx||(e.xlsx={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";t.useJSZip=function(e){JSZip=e};var s=function(){function s(){}return s.load=function(t){var s=new JSZip;e.assert(null==s.loadAsync,"Please use JSZip 2.5 to load excel files synchronously.");var l,r=new i(s);return this._loadImpl(r,t).then((function(e){return l=e})),l},s.loadAsync=function(t){var s=new JSZip;return e.assert(null!=s.loadAsync,"Please use JSZip 3.0 to load excel files asynchrounously."),this._loadImpl(s,t)},s.save=function(e){var t,s=Date.now();this._saveWorkbookToZip(e,null,!1).then((function(e){return t=e})),s=Date.now()-s;var l;l=this._macroEnabled?"application/vnd.ms-excel.sheet.macroEnabled.12;":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;";var i=Date.now(),r=t.generate({compression:"DEFLATE"});return{base64:r,zipTime:Date.now()-i,processTime:s,href:function(){return"data:"+l+"base64,"+r}}},s.saveAsync=function(t,s,l,i){var n=new r(s);return e.isFunction(i)&&i(0),this._saveWorkbookToZip(t,s,!0,(function(t){e.isFunction(i)&&i(Math.round(o(t,0,100,0,90)))})).then((function(t){e.isFunction(i)&&i(91);var r=t.generateAsync({type:"base64",compression:"DEFLATE"});r.catch((function(e){l&&l(e),n.reject(e)})),r.then((function(t){s&&s.cancelled?n.cancel():(e.isFunction(i)&&i(100),n.resolve(t))}))}),(function(e){n.reject(e)})),n},s._loadImpl=function(t,s){var l,i=this,r=this,n=Date.now(),o={sheets:[]},a=t.loadAsync(s,{base64:e.isString(s)}).then((function(e){return l=e}));s=null;var h=a.constructor;return(a=(a=(a=(a=(a=(a=(a=(a=a.then((function(){var e=l.file("xl/theme/theme1.xml");if(e)return e.async("string").then((function(e){r._getTheme(e),o.colorThemes=r._colorThemes}))}))).then((function(){var e=l.file("xl/styles.xml");if(e)return e.async("string").then((function(e){r._getStyle(e),o.styles=r._styles,null!=r._tableStyles&&(o.tableStyles=r._tableStyles)}))}))).then((function(){var e=l.file("xl/sharedStrings.xml");if(e)return e.async("string").then((function(e){r._getSharedString(e)}))}))).then((function(){var e=l.file("xl/workbook.xml");if(e)return e.async("string").then((function(e){r._getWorkbook(e,o)}))}))).then((function(){r._tables=null;var e=h.resolve();return l.folder("xl/tables").forEach((function(t,s){null==r._tables&&(r._tables=[]),e=e.then((function(){return s.async("string").then((function(e){var t=r._getTable(e);t.fileName=s.name.substring(s.name.lastIndexOf("/")+1),r._tables.push(t)}))}))})),e}))).then((function(){var e=l.file("docProps/core.xml");if(e)return e.async("string").then((function(e){r._getCoreSetting(e,o)}))}))).then((function(){var e=l.file("xl/vbaProject.bin");if(e)return e.async("uint8array").then((function(e){null==o.reservedContent&&(o.reservedContent={}),o.reservedContent.macros=e}))}))).then((function(){var e=h.resolve();return l.folder("xl/worksheets").forEach((function(t,s){if(t&&-1===t.indexOf("/")){var i=r._getSheetIndex(s.name);isNaN(i)||(e=e.then((function(){return s.async("string").then((function(e){r._getSheet(e,i-1,o);var t=l.file("xl/worksheets/_rels/sheet"+i+".xml.rels");if(t)return t.async("string").then((function(e){for(var t,s,n=e.split("<Relationship "),a=n.length;--a;){var u=n[a],c=r._getAttr(u,"Id");if(o.sheets[i-1].tableRIds&&-1!==o.sheets[i-1].tableRIds.indexOf(c))null==o.sheets[i-1].tables&&(o.sheets[i-1].tables=[]),o.sheets[i-1].tables.push(r._getSheetRelatedTable(u));else if(o.sheets[i-1].hyperlinkRIds)r._getSheetRelatedHyperlink(u,c,o.sheets[i-1]);else{var f=r._getAttr(u,"Type");/\/comments$/.test(f)?t={id:r._getAttr(u,"Id"),target:r._getAttr(u,"Target")}:/\/vmlDrawing$/.test(f)&&(s={id:r._getAttr(u,"Id"),target:r._getAttr(u,"Target")})}}if(t&&s)return function(e){var i=h.resolve();return r._readNotes(e,t,s,l,i).then((function(){}))}(o.sheets[i-1])}))}))})))}})),e}))).then((function(){return o.processTime=Date.now()-n,l=null,i._sharedStrings=null,i._colorThemes=null,i._styles=null,i._sharedFormulas=null,i._borders=null,i._fonts=null,i._fills=null,i._contentTypes=null,i._props=null,i._xlRels=null,i._worksheets=null,i._tableStyles=null,i._dxfs=null,i._tables=null,i._notes=null,o}))},s._readNotes=function(t,l,i,r,o){var a=this,h=function(e){return e&&e.replace(/^..\//,"xl/")},u=r.file(h(l.target));return u&&(o=o.then((function(){return u.async("string").then((function(l){for(var o=l.substring(l.indexOf("<authors>"),l.indexOf("</authors>")).split("<author>"),u=[],c=1;c<o.length;c++)u.push(o[c].substring(0,o[c].indexOf("</author>")));for(o=l.substring(l.indexOf("<commentList>"),l.indexOf("</commentList>")).split("<comment "),c=1;c<o.length;c++){var f=s._getAttr(o[c],"ref"),d=a._alphaNum(f.match(/[a-zA-Z]*/g)[0]),m=+f.match(/\d*/g).join("")-1,p=o[c],g=p.substring(p.indexOf("<text>")+"<text>".length,p.lastIndexOf("</text>")),_=a._extractTextRuns(g),y=t.rows[m].cells[d];null==y&&(t.rows[m].cells[d]=y={}),y.note={author:u[s._getAttr(p,"authorId")],textRuns:_,text:a._getTextOfTextRuns(_)}}var v=r.file(h(i.target));if(v)return v.async("string").then((function(s){var l={};s.substring(0,s.indexOf(">")).split("xmlns:").forEach((function(e){e.indexOf("vml")>=0?l.vml=e.substring(0,e.indexOf("=")):e.indexOf("office:office")>=0?l.office=e.substring(0,e.indexOf("=")):e.indexOf("office:excel")>=0&&(l.excel=e.substring(0,e.indexOf("=")))}));for(var i=s.split("<"+l.vml+":shape "),r=new n(t),o=1;o<i.length;o++){var h=i[o],u=l.excel+":ClientData",c=h.indexOf(u);if(c>0){c+=u.length+1;var f=h.substring(c,h.indexOf("</"+u,c));if("Note"===a._getAttr(f,"ObjectType")){var d=+a._getElementValue(f,l.excel+":Row",null,null),m=+a._getElementValue(f,l.excel+":Column",null,null),p=t.rows[d].cells[m].note;e.assert(null!=p,"No related note was found, row=${row}, col=${col}."),p.visible=a._getElementValue(f,l.excel+":Visible",!1,!0);var g=a._getElementValue(f,l.excel+":Anchor",null,null).split(",").map((function(e){return parseFloat(e)}));r.fromAnchor(g,p,d,m)}}}l=null}))}))}))),o},s._saveWorkbookToZip=function(t,s,l,i){var n=this,o=new JSZip;l?e.assert(null!=o.generateAsync,"Please use JSZip 3.0 to save excel files asynchrounously."):e.assert(null==o.generateAsync,"Please use JSZip 2.5 to save excel files synchronously."),e.isFunction(i)&&i(0),o.folder("_rels").file(".rels",this._xmlDescription+this._generateRelsDoc());var a=o.folder("docProps"),h=o.folder("xl");this._colorThemes=t.colorThemes,h.folder("theme").file("theme1.xml",this._xmlDescription+this._generateThemeDoc()),this._macroEnabled=!(!t.reservedContent||!t.reservedContent.macros),this._macroEnabled&&h.file("vbaProject.bin",t.reservedContent.macros),a.file("core.xml",this._xmlDescription+this._generateCoreDoc(t)),this._sharedStrings=[[],0],this._styles=new Array(1),this._borders=new Array(1),this._fonts=new Array(1),this._fills=new Array(2),this._tableStyles=new Array,this._dxfs=new Array,this._contentTypes=[],this._props=[],this._xlRels=[],this._worksheets=[],this._tables=[],this._tableStyles=[],this._notes={};var u=new r(s);return this._generateWorksheets(t,h,s,l,i).then((function(){n._writeNotes(t.sheets,h),h.file("styles.xml",n._xmlDescription+n._generateStyleDoc()),o.file("[Content_Types].xml",n._xmlDescription+n._generateContentTypesDoc(t)),a.file("app.xml",n._xmlDescription+n._generateAppDoc(t)),h.folder("_rels").file("workbook.xml.rels",n._xmlDescription+n._generateWorkbookRels());var s=n._xmlDescription+n._generateSharedStringsDoc();n._sharedStrings=[[],0],h.file("sharedStrings.xml",s),s=null,h.file("workbook.xml",n._xmlDescription+n._generateWorkbook(t)),e.isFunction(i)&&i(100),u.resolve(o)})),u},s._writeNotes=function(t,s){var l=this;t.forEach((function(t,i){var r=l._notes[i];r&&(s.folder("drawings").file("vmlDrawing"+(i+1)+".vml",function(t){var s='<xml xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n';s+='<o:shapelayout v:ext="edit">\r\n',s+='<o:idmap v:ext="edit" data="1"/>\r\n',s+="</o:shapelayout>\r\n",s+='<v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe">\r\n',s+='<v:stroke joinstyle="miter"/>\r\n',s+='<v:path gradientshapeok="t" o:connecttype="rect"/>\r\n',s+="</v:shapetype>\r\n";var l=1e3*(i+1)+50,o=new n(t);return r.forEach((function(t,i){e.assert(t._row>=0&&t._col>=0,"Invalid cell's indicies.");var r=null==t.visible||!0===t.visible;s+='<v:shape id="_x0000_s'+l+++'" type="#_x0000_t202" style=\'position:absolute; visibility:'+(r?"visible":"hidden")+"; z-index:"+(i+1)+';\' fillcolor="infoBackground [80]" o:insetmode="auto">\r\n',s+='<v:fill color2="infoBackground [80]"/>\r\n',s+='<v:shadow color="none [81]" obscured="t"/>\r\n',s+='<v:path o:connecttype="none"/>\r\n',s+='<v:textbox style="mso-direction-alt:auto;" ',s+=">\r\n",s+='<div style="text-align:left;"></div>\r\n',s+="</v:textbox>\r\n",s+='<x:ClientData ObjectType="Note">\r\n',s+="<x:MoveWithCells/>\r\n",s+="<x:SizeWithCells/>\r\n",null==t.width&&(t.width=144),null==t.height&&(t.height=79),null==t.offsetX&&(t.offsetX=15),null==t.offsetY&&(t.offsetY=0==t._row?2:15);var n=o.toAnchor(t,t._row,t._col);s+="<x:Anchor>"+n.toString()+"</x:Anchor>\r\n",s+="<x:AutoFill>False</x:AutoFill>\r\n",s+="<x:Row>"+t._row+"</x:Row>\r\n",s+="<x:Column>"+t._col+"</x:Column>\r\n",r&&(s+="<x:Visible/>\r\n"),s+="</x:ClientData>\r\n",s+="</v:shape>\r\n"})),s+"</xml>"}(t)),s.file("comments"+(i+1)+".xml",function(e){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';t+='<comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="xr" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision">\r\n';var s={},i=[],n={family:"Tahoma",size:12};return r.forEach((function(e){var t=e.author||"";null==s[t]&&(s[t]=i.length,i.push(t))})),t+="<authors>\r\n",i.forEach((function(e){return t+="<author>"+e+"</author>\r\n"})),t+="</authors>\r\n",t+="<commentList>\r\n",r.forEach((function(e){var i=l._numAlpha(e._col)+(e._row+1);t+='<comment ref="'+i+'" authorId="'+s[e.author||""]+'" shapeId="0" xr:uid="'+function(){h>4294967295&&(h=0);var e=(65535&h|65536).toString(16).substr(1),t=(h>>16&65535|65536).toString(16).substr(1);return h++,"{00000000-0000-0000-0000"+t+e+"}"}()+'">\r\n',t+="<text>\r\n";var r=e.textRuns&&e.textRuns.length?e.textRuns:[{text:e.text}];r=r.map((function(e){return e.font=e.font||n,e})),t+=l._generateTextRuns(r,l._defaultFontName.toLowerCase()),t+="</text>",t+="</comment>\r\n"})),(t+="</commentList>\r\n")+"</comments>"}()))}))},s._generateWorksheets=function(t,s,l,i,n){for(var o,a=this,h=s.folder("worksheets"),u=t.sheets.length,c=[],f=t.sheets.map((function(e){return e.rows.length})).reduce((function(e,t){return e+t})),d=t.sheets.map((function(e){return e.rows.length/f})),m=u-1,p=0,g=0,_=function(){var f=u;c.push((function(){var u=new r(l);return a._generateWorkSheet(f,t,h,l,i,(function(t){e.isFunction(n)&&(t=Math.round(t*d[f]),m!==f&&(m=f,g+=p),p=t,n(g+t))})).then((function(){var e=t.sheets[f],l=e&&e.externalLinks,i=a._sheetHasNotes(f);if(e&&(e.tables&&e.tables.length>0||l&&l.length>0||i)){var r=1,n='<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';if(i&&(n+='<Relationship Id="rId'+r+++'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing" Target="../drawings/vmlDrawing'+(f+1)+'.vml" />',n+='<Relationship Id="rId'+r+++'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="../comments'+(f+1)+'.xml" />'),l&&l.length>0&&(n+=a._generateHyperlinkRel(l,r),r+=l.length),e.tables&&e.tables.length>0){null==o&&(o=s.folder("tables"));for(var c=0;c<e.tables.length;c++){var d=e.tables[c];a._generateTable(d,o),n+='<Relationship Target="../tables/'+d.fileName+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Id="rId'+(c+r)+'"/>'}}n+="</Relationships>",h.folder("_rels").file("sheet"+(f+1)+".xml.rels",a._xmlDescription+n)}u.resolve()})),u}))};u--;)_();return r.serial(l,c).then((function(){e.isFunction(n)&&n(100)}))},s._getSharedString=function(e){var s=e.split(/<si.*?>/g),l=s.length;for(this._sharedStrings=[];--l;)if(s[l].search(/<r>/gi)>-1)this._sharedStrings[l-1]=this._extractTextRuns(s[l]);else{var i=this._getElementValue(s[l],"t","","");this._sharedStrings[l-1]=t.Workbook._unescapeXML(i)}},s._extractTextRuns=function(e){for(var s=[],l=e.split(/<r>/g),i=1;i<l.length;i++){var r=void 0;-1!==l[i].indexOf("<rPr>")&&(r=this._getTextRunFont(l[i]));var n=this._getElementValue(l[i],"t","","");s.push({font:r,text:t.Workbook._unescapeXML(n)})}return s},s._getInlineString=function(e){for(var t=e.split("<t"),s=t.length,l="";--s;){var i=t[s];if(" "===i[0]||">"===i[0]){var r=i.indexOf("</t>");r>0&&(l=i.substring(i.indexOf(">")+1,r)+l)}}return l},s._convertDecimalEntities=function(t){if(e.isIE()&&-1!==t.indexOf("&#"))return t.replace(/&#(\d{1,7});/g,(function(e,t){return a(t)}));for(var s,l=0,i="";(s=t.indexOf("&#",l))>=0;){var r=t.indexOf(";",s+2);if(-1===r)break;var n=r-s-2;if(n>0&&n<8){var o=t.substr(s+2,n),h=+o;if(h!=o){i+=t.substr(l,2),l+=2;continue}i+=t.substring(l,s),i+=a(h)}else i+=t.substring(l,r+1);l=r+1}return l!==t.length&&(i+=t.substr(l)),i||t},s._getCoreSetting=function(e,t){var s,l;(l=e.indexOf("<dc:creator>"))>=0&&(s=e.substr(l+12),t.creator=s.substring(0,s.indexOf("</dc:creator>"))),(l=e.indexOf("<cp:lastModifiedBy>"))>=0&&(s=e.substr(l+19),t.lastModifiedBy=s.substring(0,s.indexOf("</cp:lastModifiedBy>"))),(l=e.indexOf('<dcterms:created xsi:type="dcterms:W3CDTF">'))>=0&&(s=e.substr(l+43),t.created=new Date(s.substring(0,s.indexOf("</dcterms:created>")))),(l=e.indexOf('<dcterms:modified xsi:type="dcterms:W3CDTF">'))>=0&&(s=e.substr(l+44),t.modified=new Date(s.substring(0,s.indexOf("</dcterms:modified>"))))},s._getWorkbook=function(e,t){var s,l,i,r,n,o,a,h,u=e.substring(e.indexOf("<bookViews>"),e.indexOf("</bookViews>")),c="",f=e.indexOf("<definedNames>");for(u&&(c=this._getAttr(u,"activeTab")),t.activeWorksheet=+c,o=(n=e.split("<sheet ")).length;--o;)a=this._getAttr(n[o],"name"),h="hidden"!==this._getAttr(n[o],"state"),t.sheets.unshift({name:a,visible:h,columns:[],rows:[]});if(f>-1)for(t.definedNames=[],o=(n=e.substring(f,e.indexOf("</definedNames>")).split("<definedName ")).length;--o;)a=this._getAttr(n[o],"name"),(l=n[o].match(/.*>.+(?=<\/definedName>)/))&&(l=l[0].replace(/(.*>)(.+)/,"$2"),l=isNaN(+l)?l:+l),s={name:a,value:l},""!==(i=this._getAttr(n[o],"localSheetId"))&&(r=t.sheets[+i])&&(s.sheetName=r.name),t.definedNames.unshift(s)},s._getTheme=function(e){e=e.substring(e.indexOf("<a:clrScheme"),e.indexOf("</a:clrScheme>")),this._colorThemes=this._defaultColorThemes.slice(),this._colorThemes[0]=this._getAttr(e.substring(e.indexOf("a:lt1"),e.indexOf("</a:lt1>")),"lastClr")||this._getAttr(e.substring(e.indexOf("a:lt1"),e.indexOf("</a:lt1>")),"val"),this._colorThemes[1]=this._getAttr(e.substring(e.indexOf("a:dk1"),e.indexOf("</a:dk1>")),"lastClr")||this._getAttr(e.substring(e.indexOf("a:dk1"),e.indexOf("</a:dk1>")),"val"),this._colorThemes[2]=this._getAttr(e.substring(e.indexOf("a:lt2"),e.indexOf("</a:lt2>")),"val"),this._colorThemes[3]=this._getAttr(e.substring(e.indexOf("a:dk2"),e.indexOf("</a:dk2>")),"val");for(var t=e.substring(e.indexOf("<a:accent1"),e.indexOf("</a:accent6>")).split("<a:accent"),s=t.length;--s;)this._colorThemes[s+3]=this._getAttr(t[s],"val")},s._getStyle=function(e){var s=[],l=[],i=[],r=this._numFmts.slice();this._styles=[];var n=e.indexOf("<numFmts");if(n>=0)for(var o=e.substring(n+8,e.indexOf("</numFmts>")).split("<numFmt"),a=o.length;--a;){var h=o[a];r[+this._getAttr(h,"numFmtId")]=this._getAttr(h,"formatCode")}if((n=e.indexOf("<fonts"))>=0){var u=e.substring(n,e.indexOf("</fonts>")).split("<font>");for(a=u.length;--a;){h=u[a];var c=this._getChildNodeValue(h,"sz"),f=void 0;s[a-1]={bold:/<b\s*\/>/.test(h)||"true"===this._getChildNodeValue(h,"b"),italic:/<i\s*\/>/.test(h)||"true"===this._getChildNodeValue(h,"i"),underline:/<u\s*\/>/.test(h)||!!(f=this._getChildNodeValue(h,"u"))&&"none"!==f,size:Math.round(c?96*+c/72:14),family:this._getChildNodeValue(h,"name"),color:this._getColor(h,!1)},c=null}}if((n=e.indexOf("<fills"))>=0){var d=e.substring(n,e.indexOf("</fills>")).split("<fill>");for(a=d.length;--a;)l[a-1]=this._getColor(d[a],!0)}if((n=e.indexOf("<borders"))>=0){var m=e.substring(n+8,e.indexOf("</borders>")).split("<border");for(a=m.length;--a;)h=m[a],i[a-1]={left:this._getEdgeBorder(h,"left"),right:this._getEdgeBorder(h,"right"),top:this._getEdgeBorder(h,"top"),bottom:this._getEdgeBorder(h,"bottom")}}if((n=e.indexOf("<cellXfs"))>=0){var p=e.substring(n,e.indexOf("</cellXfs>")).split("<xf");for(a=p.length;--a;){h=p[a];var g=+this._getAttr(h,"numFmtId"),_=r[g],y="unknown";_&&(/[hsmy\:]/i.test(_)?y="date":_.indexOf("0")>-1?y="number":"@"===_&&(y="string"));var v=(g=+this._getAttr(h,"fontId"))>0?s[g]:null,b=(g=+this._getAttr(h,"fillId"))>1?l[g]:null,x=(g=+this._getAttr(h,"borderId"))>0?i[g]:null;n=h.indexOf("<alignment"),this._styles.unshift({formatCode:_,type:y,font:v,fillColor:b,borders:x,hAlign:n>=0?t.Workbook._parseStringToHAlign(this._getAttr(h,"horizontal")):null,vAlign:n>=0?t.Workbook._parseStringToVAlign(this._getAttr(h,"vertical")):null,wordWrap:n>=0?"1"===this._getAttr(h,"wrapText"):null,quotePrefix:1==+this._getAttr(h,"quotePrefix")})}}if(e.indexOf("<tableStyle ")>-1){this._tableStyles=[];var w=e.substring(e.indexOf("<tableStyles "),e.indexOf("</tableStyles>")),S=e.substring(e.indexOf("<dxfs "),e.indexOf("</dxfs>"));this._getTableStyles(w,S.split("<dxf>"))}},s._getEdgeBorder=function(e,s){var l,i,r,n,o=e.indexOf("<"+s),a=e.indexOf("</"+s+">");if(o>=0){i=e.substring(o),i=a>=0?i.substring(0,a):i.substring(0,i.indexOf("/>"));var h=this._getAttr(i,"style");h&&(r=t.Workbook._parseStringToBorderType(h),n=this._getColor(i,!1),r===t.BorderStyle.Thin&&n&&"#c6c6c6"===n.toLowerCase()||((l={}).style=r,l.color=n))}return l},s._getSheet=function(s,l,i){var r,n=[];if(s.indexOf("<mergeCells")>-1)for(var o=s.substring(s.indexOf("<mergeCells"),s.indexOf("</mergeCells>")).split("<mergeCell "),a=o.length;--a;)2===(r=this._getAttr(o[a],"ref").split(":")).length&&n.unshift({topRow:+r[0].match(/\d*/g).join("")-1,leftCol:this._alphaNum(r[0].match(/[a-zA-Z]*/g)[0]),bottomRow:+r[1].match(/\d*/g).join("")-1,rightCol:this._alphaNum(r[1].match(/[a-zA-Z]*/g)[0])});this._getsBaseSharedFormulas(s);var h=s.split("<row "),u=i.sheets[l];if(h[0].indexOf("<dimension")>=0){var c=this._getAttr(h[0].substr(h[0].indexOf("<dimension")),"ref");c&&(c=c.substr(c.indexOf(":")+1),u.maxCol=this._alphaNum(c.match(/[a-zA-Z]*/g)[0])+1,u.maxRow=+c.match(/\d*/g).join(""))}var f=s.indexOf("<tableParts");if(f>-1){var d=s.substring(f,s.indexOf("</tableParts>")).split("<tablePart "),m=d.length;for(u.tableRIds=[];--m;)u.tableRIds.unshift(this._getAttr(d[m],"r:id"))}if(h.length>0&&h[0].indexOf("<pane")>-1&&"frozen"===this._getAttr(h[0].substr(h[0].indexOf("<pane")),"state")){var p=this._getAttr(h[0].substr(h[0].indexOf("<pane")),"ySplit"),g=this._getAttr(h[0].substr(h[0].indexOf("<pane")),"xSplit");u.frozenPane={rows:p?+p:NaN,columns:g?+g:NaN}}u.summaryBelow="0"!==this._getAttr(h[0],"summaryBelow"),a=h.length,h.length<=1?(u.maxCol=20,u.maxRow=200):(null==u.maxRow||u.maxRow<a-1)&&(u.maxRow=a-1);for(var _,y=null,v=null;--a;){var b=u.rows[+this._getAttr(h[a],"r")-1]={visible:!0,groupLevel:NaN,cells:[]};if(h[a].substring(0,h[a].indexOf(">")).indexOf("hidden")>-1&&"1"===this._getAttr(h[a],"hidden")&&(b.visible=!1),"1"===this._getAttr(h[a],"customHeight")){var x=+this._getAttr(h[a].substring(0,h[a].indexOf(">")).replace("customHeight",""),"ht");b.height=96*x/72}y=null,v=null,"1"===this._getAttr(h[a],"customFormat")&&(y=(v=this._styles[+this._getAttr(h[a].substring(h[a].indexOf(" s=")),"s")]||{type:"General",formatCode:null}).font||v.fillColor||v.hAlign||v.vAlign||v.wordWrap||v.borders||v.formatCode&&"General"!==v.formatCode?{format:v.formatCode&&"General"!==v.formatCode?v.formatCode:null,font:v.font,fill:{color:v.fillColor},borders:v.borders,hAlign:v.hAlign,vAlign:v.vAlign,wordWrap:v.wordWrap}:null),b.style=y;var w=this._getAttr(h[a],"outlineLevel");b.groupLevel=w&&""!==w?+w:NaN,b.collapsed="1"===this._getAttr(h[a],"collapsed");var S=h[a].split("<c "),C=S.length;for((null==u.maxCol||u.maxCol<C-1)&&(u.maxCol=C-1);--C;){var k=S[C];y=(v=this._styles[+this._getAttr(k,"s")]||{type:"General",formatCode:null}).font||v.fillColor||v.hAlign||v.vAlign||v.wordWrap||v.borders||v.formatCode&&"General"!==v.formatCode?{format:v.formatCode&&"General"!==v.formatCode?v.formatCode:null,font:v.font,fill:{color:v.fillColor},borders:v.borders,hAlign:v.hAlign,vAlign:v.vAlign,wordWrap:v.wordWrap}:null;var F=this._getAttr(k.substring(0,k.indexOf(">")),"t")||v.type,T=null,z="inlineStr"===F||k.indexOf("<is>")>=0;z?(T=this._getInlineString(k),T=this._convertDecimalEntities(T)):(T=this._getElementValue(k,"v","",""),T=t.Workbook._unescapeXML(T));var A=null,R=null,O=null;k.indexOf("<f")>-1&&(k.indexOf("</f>")>-1?(A=k.match(/<f.*>.+(?=<\/f>)/))&&(A=A[0].replace(/(\<f.*>)(.+)/,"$2")):(R=this._getAttr(k,"si"))&&(O=this._getAttr(k,"r"),A=this._getSharedFormula(R,O))),null!=A&&(A=A.replace(/\[\#This Row\]\s*,\s*/gi,"@")),"str"===F||"e"===F||z||(T=T?+T:T),_=this._alphaNum(this._getAttr(k,"r").match(/[a-zA-Z]*/g)[0]);var D=null;switch(F){case"s":null!=(T=this._sharedStrings[T])&&(e.isString(T)?v&&v.quotePrefix&&(T="'"+T):(D=T.slice(),T=this._getTextOfTextRuns(D)));break;case"b":T=1===T;break;case"date":T=T?this._convertDate(T):""}e.isNumber(T)&&(null==y&&(y={format:""}),e.isInt(T)?y.format=y.format||"#,##0":y.format=y.format||"#,##0.00"),b.cells[_]={value:T,textRuns:D,isDate:"date"===F,isNumber:"number"===F,formula:t.Workbook._unescapeXML(A),style:y}}}var N=[],W=[];if(y=null,v=null,h.length>0&&h[0].indexOf("<cols>")>-1)for(var B=(N=h[0].substring(h[0].indexOf("<cols>")+6,h[0].indexOf("</cols>")).split("<col ")).length-1;B>0;B--){var E=this._parseCharWidthToPixel(+this._getAttr(N[B],"width"));v=null,N[B].indexOf("style")>-1&&(v=this._styles[+this._getAttr(N[B],"style")]||{type:"General",formatCode:null}),y=null,v&&(v.font||v.fillColor||v.hAlign||v.vAlign||v.wordWrap||v.borders||v.formatCode&&"General"!==v.formatCode)&&(y={format:v.formatCode&&"General"!==v.formatCode?v.formatCode:null,font:v.font,fill:{color:v.fillColor},borders:v.borders,hAlign:v.hAlign,vAlign:v.vAlign,wordWrap:v.wordWrap});var M=+this._getAttr(N[B],"min"),L=+this._getAttr(N[B],"max");if(L>u.maxCol)u._extraColumn={min:M,max:L,width:E,style:y};else for(_=M-1;_<L&&_<u.maxCol;_++)W[_]={visible:"1"!==this._getAttr(N[B],"hidden"),autoWidth:"1"===this._getAttr(N[B],"bestFit"),width:E,style:y}}u.columns=W;var I,P=s.indexOf("<hyperlinks");if(P>-1)for(var H=s.substring(P,s.indexOf("</hyperlinks>")).split("<hyperlink "),j=H.length;--j;)this._getHyperlink(u,H[j]);if(u.frozenPane){if(!isNaN(u.frozenPane.rows))for(a=0;a<u.rows.length&&a<u.frozenPane.rows;a++)u.rows[a]&&!u.rows[a].visible&&u.frozenPane.rows++;if(!isNaN(u.frozenPane.columns))for(a=0;a<W.length&&a<u.frozenPane.columns;a++)W[a]&&!W[a].visible&&u.frozenPane.columns++}for(C=0;C<n.length;C++)I=n[C],u.rows[I.topRow]||(u.rows[I.topRow]={cells:[]}),u.rows[I.topRow].cells||(u.rows[I.topRow].cells=[]),u.rows[I.topRow].cells[I.leftCol]||(u.rows[I.topRow].cells[I.leftCol]={}),u.rows[I.topRow].cells[I.leftCol].rowSpan=I.bottomRow<u.maxRow?I.bottomRow-I.topRow+1:200,u.rows[I.topRow].cells[I.leftCol].colSpan=I.rightCol<u.maxCol?I.rightCol-I.leftCol+1:20},s._getTable=function(e){var t={};t.name=this._getAttr(e,"name"),t.range=this._getAttr(e,"ref");var s=this._getAttr(e,"headerRowCount");t.showHeaderRow=""==s||"1"===s;var l=this._getAttr(e,"totalsRowCount");t.showTotalRow="1"===l;var i=e.substring(e.indexOf("<tableStyleInfo")),r=this._getAttr(i,"name");this._isBuiltInStyleName(r)?t.style={name:r}:t.style=this._getTableStyleByName(r),t.showBandedColumns="1"===this._getAttr(i,"showColumnStripes"),t.showBandedRows="1"===this._getAttr(i,"showRowStripes"),t.alterFirstColumn="1"===this._getAttr(i,"showFirstColumn"),t.alterLastColumn="1"===this._getAttr(i,"showLastColumn");var n=e.split("<tableColumn ");t.columns=[];for(var o=1;o<n.length;o++){var a=n[o];t.columns.push(this._getTableColumn(a))}if(e.indexOf("filterColumn")>-1)for(var h=e.substring(e.indexOf("<autoFilter"),e.indexOf("</autoFilter>")).split("<filterColumn"),u=1;u<h.length;u++){var c=h[u],f=+this._getAttr(c,"colId");t.columns[f].showFilterButton="1"!==this._getAttr(c,"hiddenButton")}return t},s._getTableColumn=function(e){var t={};t.name=this._getAttr(e,"name");var s=this._getAttr(e,"totalsRowLabel");if(s)t.totalRowLabel=s;else{var l=this._getAttr(e,"totalsRowFunction");"custom"===l&&(l=e.substring(e.indexOf("<totalsRowFormula>")+2+"totalsRowFormula".length,e.indexOf("</totalsRowFormula>"))),t.totalRowFunction=l}return t},s._getSheetRelatedTable=function(e){var t=this._getAttr(e,"Target");t=t.substring(t.lastIndexOf("/")+1);for(var s=0;s<this._tables.length;s++){var l=this._tables[s];if(t===l.fileName)return l}return null},s._getSheetRelatedHyperlink=function(e,t,s){for(var l=0;l<s.hyperlinkRIds.length;l++){var i=s.hyperlinkRIds[l];if(i.rId===t){var r=this._getAttr(e,"Target");s.rows[i.ref.row]&&s.rows[i.ref.row].cells[i.ref.col]&&(s.rows[i.ref.row].cells[i.ref.col].link=r)}}},s._getTableStyles=function(e,t){for(var s=e.split("<tableStyle "),l=s.length;--l;){var i={},r=s[l];i.name=this._getAttr(r,"name");for(var n=r.split("<tableStyleElement "),o=n.length;--o;){var a=n[o],h=this._getAttr(a,"type");switch(h){case"firstRowStripe":h="firstBandedRowStyle";break;case"secondRowStripe":h="secondBandedRowStyle";break;case"firstColumnStripe":h="firstBandedColumnStyle";break;case"secondColumnStripe":h="secondBandedColumnStyle";break;default:h+="Style"}var u=this._getAttr(a,"dxfId");""!==u&&(i[h]=this._getTableStyleElement(t[+u+1]));var c=this._getAttr(a,"size");c&&(null==i[h]&&(i[h]={}),i[h].size=+c)}this._tableStyles.push(i)}},s._getTableStyleElement=function(e){var t=null,s=null,l=null,i=null,r=e.indexOf("<font>");if(r>=0){t=e.substring(r,e.indexOf("</font>"));var n=this._getChildNodeValue(t,"sz");s={bold:"1"===this._getChildNodeValue(t,"b"),italic:"1"===this._getChildNodeValue(t,"i"),underline:"1"===this._getChildNodeValue(t,"u"),size:Math.round(n?96*+n/72:14),family:this._getChildNodeValue(t,"name"),color:this._getColor(t,!1)}}return t=null,(r=e.indexOf("<fill>"))>=0&&(t=e.substring(r,e.indexOf("</fill>")),l={color:this._getColor(t,!0)}),t=null,(r=e.indexOf("<border>"))>=0&&(t=e.substring(r,e.indexOf("</border>")),i={left:this._getEdgeBorder(t,"left"),right:this._getEdgeBorder(t,"right"),top:this._getEdgeBorder(t,"top"),bottom:this._getEdgeBorder(t,"bottom"),vertical:this._getEdgeBorder(t,"vertical"),horizontal:this._getEdgeBorder(t,"horizontal")}),{font:s,fill:l,borders:i}},s._getTableStyleByName=function(e){var t,s;if(null==this._tableStyles||0===this._tableStyles.length)return null;for(t=0;t<this._tableStyles.length;t++)if((s=this._tableStyles[t])&&s.name.toLowerCase()===e.toLowerCase())return s;return null},s._getHyperlink=function(e,s){var l,i,r,n,o,a;if(null!=(l=this._getAttr(s,"ref"))){r=l.split(":"),null==(o=this._getAttr(s,"r:id"))&&(a=this._getAttr(s,"location"));for(var h=0;h<r.length;h++)i=r[h],n=t.Workbook.tableAddress(i),o?(null==e.hyperlinkRIds&&(e.hyperlinkRIds=[]),e.hyperlinkRIds.push({ref:n,rId:o})):a&&e.rows[n.row]&&e.rows[n.row].cells[n.col]&&(e.rows[n.row].cells[n.col].link=a)}},s._getTextRunFont=function(e){var t,s=this._getChildNodeValue(e,"sz");return{bold:e.indexOf("<b/>")>=0||"true"===this._getChildNodeValue(e,"b"),italic:e.indexOf("<i/>")>=0||"true"===this._getChildNodeValue(e,"i"),underline:e.indexOf("<u/>")>=0||(t=this._getChildNodeValue(e,"u"))&&"none"!==t,size:Math.round(s?96*+s/72:14),family:this._getChildNodeValue(e,"rFont"),color:this._getColor(e,!1)}},s._getTextOfTextRuns=function(e){var t,s,l="";for(t=0;t<e.length;t++)(s=e[t])&&(l+=s.text);return l},s._isBuiltInStyleName=function(e){var t;if(0===e.search(/TableStyleLight/i)){if(t=+e.substring(15),!isNaN(t)&&t>=1&&t<=21)return!0}else if(0===e.search(/TableStyleMedium/i)){if(t=+e.substring(16),!isNaN(t)&&t>=1&&t<=28)return!0}else if(0===e.search(/TableStyleDark/i)&&(t=+e.substring(14),!isNaN(t)&&t>=1&&t<=11))return!0;return!1},s._generateRelsDoc=function(){return'<Relationships xmlns="'+this._relationshipsNS+'"><Relationship Target="docProps/app.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Id="rId3"/><Relationship Target="docProps/core.xml" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Id="rId2"/><Relationship Target="xl/workbook.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Id="rId1"/></Relationships>'},s._generateThemeDoc=function(){return'<a:theme name="Office Theme" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"><a:themeElements>'+this._generateClrScheme()+this._generateFontScheme()+this._generateFmtScheme()+"</a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>"},s._generateClrScheme=function(){return null===this._colorThemes&&(this._colorThemes=[]),'<a:clrScheme name="Office"><a:dk1><a:sysClr lastClr="'+(this._colorThemes[1]||"000000")+'" val="windowText"/></a:dk1><a:lt1><a:sysClr lastClr="'+(this._colorThemes[0]||"FFFFFF")+'" val="window"/></a:lt1><a:dk2><a:srgbClr val="'+(this._colorThemes[3]||"1F497D")+'"/></a:dk2><a:lt2><a:srgbClr val="'+(this._colorThemes[2]||"EEECE1")+'"/></a:lt2><a:accent1><a:srgbClr val="'+(this._colorThemes[4]||"4F81BD")+'"/></a:accent1><a:accent2><a:srgbClr val="'+(this._colorThemes[5]||"C0504D")+'"/></a:accent2><a:accent3><a:srgbClr val="'+(this._colorThemes[6]||"9BBB59")+'"/></a:accent3><a:accent4><a:srgbClr val="'+(this._colorThemes[7]||"8064A2")+'"/></a:accent4><a:accent5><a:srgbClr val="'+(this._colorThemes[8]||"4BACC6")+'"/></a:accent5><a:accent6><a:srgbClr val="'+(this._colorThemes[9]||"F79646")+'"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme>'},s._generateFontScheme=function(){return'<a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯" script="Jpan"/><a:font typeface="ë§‘ì€ ê³ ë”•" script="Hang"/><a:font typeface="å®‹ä½“" script="Hans"/><a:font typeface="æ–°ç´°æ˜Žé«”" script="Hant"/><a:font typeface="Times New Roman" script="Arab"/><a:font typeface="Times New Roman" script="Hebr"/><a:font typeface="Tahoma" script="Thai"/><a:font typeface="Nyala" script="Ethi"/><a:font typeface="Vrinda" script="Beng"/><a:font typeface="Shruti" script="Gujr"/><a:font typeface="MoolBoran" script="Khmr"/><a:font typeface="Tunga" script="Knda"/><a:font typeface="Raavi" script="Guru"/><a:font typeface="Euphemia" script="Cans"/><a:font typeface="Plantagenet Cherokee" script="Cher"/><a:font typeface="Microsoft Yi Baiti" script="Yiii"/><a:font typeface="Microsoft Himalaya" script="Tibt"/><a:font typeface="MV Boli" script="Thaa"/><a:font typeface="Mangal" script="Deva"/><a:font typeface="Gautami" script="Telu"/><a:font typeface="Latha" script="Taml"/><a:font typeface="Estrangelo Edessa" script="Syrc"/><a:font typeface="Kalinga" script="Orya"/><a:font typeface="Kartika" script="Mlym"/><a:font typeface="DokChampa" script="Laoo"/><a:font typeface="Iskoola Pota" script="Sinh"/><a:font typeface="Mongolian Baiti" script="Mong"/><a:font typeface="Times New Roman" script="Viet"/><a:font typeface="Microsoft Uighur" script="Uigh"/><a:font typeface="Sylfaen" script="Geor"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯" script="Jpan"/><a:font typeface="ë§‘ì€ ê³ ë”•" script="Hang"/><a:font typeface="å®‹ä½“" script="Hans"/><a:font typeface="æ–°ç´°æ˜Žé«”" script="Hant"/><a:font typeface="Arial" script="Arab"/><a:font typeface="Arial" script="Hebr"/><a:font typeface="Tahoma" script="Thai"/><a:font typeface="Nyala" script="Ethi"/><a:font typeface="Vrinda" script="Beng"/><a:font typeface="Shruti" script="Gujr"/><a:font typeface="DaunPenh" script="Khmr"/><a:font typeface="Tunga" script="Knda"/><a:font typeface="Raavi" script="Guru"/><a:font typeface="Euphemia" script="Cans"/><a:font typeface="Plantagenet Cherokee" script="Cher"/><a:font typeface="Microsoft Yi Baiti" script="Yiii"/><a:font typeface="Microsoft Himalaya" script="Tibt"/><a:font typeface="MV Boli" script="Thaa"/><a:font typeface="Mangal" script="Deva"/><a:font typeface="Gautami" script="Telu"/><a:font typeface="Latha" script="Taml"/><a:font typeface="Estrangelo Edessa" script="Syrc"/><a:font typeface="Kalinga" script="Orya"/><a:font typeface="Kartika" script="Mlym"/><a:font typeface="DokChampa" script="Laoo"/><a:font typeface="Iskoola Pota" script="Sinh"/><a:font typeface="Mongolian Baiti" script="Mong"/><a:font typeface="Arial" script="Viet"/><a:font typeface="Microsoft Uighur" script="Uigh"/><a:font typeface="Sylfaen" script="Geor"/></a:minorFont></a:fontScheme>'},s._generateFmtScheme=function(){return'<a:fmtScheme name="Office">'+this._generateFillScheme()+this._generateLineStyles()+this._generateEffectScheme()+this._generateBgFillScheme()+"</a:fmtScheme>"},s._generateFillScheme=function(){return'<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled="1" ang="16200000"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled="1" ang="16200000"/></a:gradFill></a:fillStyleLst>'},s._generateLineStyles=function(){return'<a:lnStyleLst><a:ln algn="ctr" cmpd="sng" cap="flat" w="9525"><a:solidFill><a:schemeClr val="phClr"><a:shade val="9500"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln algn="ctr" cmpd="sng" cap="flat" w="25400"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln algn="ctr" cmpd="sng" cap="flat" w="38100"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst>'},s._generateEffectScheme=function(){return'<a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir="5400000" rotWithShape="0" dist="23000" blurRad="40000"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot rev="0" lon="0" lat="0"/></a:camera><a:lightRig dir="t" rig="threePt"><a:rot rev="1200000" lon="0" lat="0"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst>'},s._generateBgFillScheme=function(){return'<a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst>'},s._generateCoreDoc=function(e){var t='<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">';return e.creator?t+="<dc:creator>"+e.creator+"</dc:creator>":t+="<dc:creator/>",e.lastModifiedBy?t+="<cp:lastModifiedBy>"+e.lastModifiedBy+"</cp:lastModifiedBy>":t+="<cp:lastModifiedBy/>",t+'<dcterms:created xsi:type="dcterms:W3CDTF">'+(e.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(e.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>"},s._generateSheetGlobalSetting=function(e,t,s){var l=t.rows&&t.rows[0]&&t.rows[0].cells?t.rows[0].cells.length:0,i=' xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"';this._sheetHasNotes(e)&&(i+=' xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"'),i+=' xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">',i+='<sheetPr><outlinePr summaryBelow="0"/></sheetPr>',i+='<dimension ref="A1'+(l>0?":"+this._numAlpha(l-1)+t.rows.length:"")+'"/>',i+='<sheetViews><sheetView workbookViewId="0"',e===s.activeWorksheet&&(i+=' tabSelected="1"');var r=0,n=0;return t.frozenPane&&((r=t.frozenPane.rows||0)||(n=t.frozenPane.columns||0))?(i+=">",i+='<pane state="frozen" activePane="'+(0!==r&&0!==n?"bottomRight":0!==r?"bottomLeft":"topRight")+'" topLeftCell="'+(this._numAlpha(n)+(r+1))+'" ySplit="'+r.toString()+'" xSplit="'+n.toString()+'"/>',i+="</sheetView>"):i+="/>",(i+="</sheetViews>")+'<sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'},s._generateCell=function(e,s,l,i,r,n){var o='<c r="'+this._numAlpha(s)+(e+1)+'" s="'+l.toString()+'"';i&&(o+=' t="'+i+'"');var a="";return n&&("="===n[0]&&(n=n.substring(1)),n=n.replace(/\@\s*/gi,"[#This Row], "),a+="<f>"+t.Workbook._escapeXML(n)+"</f>"),null!=r&&""!==r&&(a+="<v>"+r+"</v>"),o+(a?">"+a+"</c>":"/>")},s._generateMergeSetting=function(e){for(var t='<mergeCells count="'+e.length.toString()+'">',s=0;s<e.length;s++)t+='<mergeCell ref="'+e[s].join(":")+'"/>';return t+"</mergeCells>"},s._generateStyleDoc=function(){var e='<styleSheet xmlns="'+this._workbookNS+'" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac">',t="",s="",l=[],i=0,r=0,n="",o="";o=this._generateFontStyle({},!0);var a="",h="";h+=this._generateFillStyle("none",null),h+=this._generateFillStyle("gray125",null);var u="",c="";c+=this._generateBorderStyle({});var f="",d="";for(d+=this._generateCellXfs(0,0,0,0,{});i<this._styles.length;){var m=this._styles[i];if(m){var p=0;if((m=JSON.parse(m)).format&&"General"!==m.format&&(p=this._numFmts.indexOf(m.format))<0){var g=l.indexOf(m.format);-1===g?(l.push(m.format),s+='<numFmt numFmtId="'+(p=164+r).toString()+'" formatCode="'+m.format+'"/>',r++):p=164+g}var _=0;if(m.borders){var y=JSON.stringify(m.borders);(_=this._borders.indexOf(y))<0&&(_=this._borders.push(y)-1,c+=this._generateBorderStyle(m.borders))}var v=0;if(m.font){var b=JSON.stringify(m.font);(v=this._fonts.indexOf(b))<0&&(v=this._fonts.push(b)-1,o+=this._generateFontStyle(m.font))}var x=0;if(m.fill&&m.fill.color){var w=JSON.stringify(m.fill);(x=this._fills.indexOf(w))<0&&(x=this._fills.push(w)-1,h+=this._generateFillStyle("solid",m.fill.color))}d+=this._generateCellXfs(p,_,v,x,m)}i++}l=null,r>0?(t='<numFmts count="'+r+'">',t+=s,t+="</numFmts>"):t='<numFmts count="0"/>',e+=t,n='<fonts count="'+this._fonts.length+'" x14ac:knownFonts="1">',n+=o,e+=n+="</fonts>",a='<fills count="'+this._fills.length+'">',a+=h,e+=a+="</fills>",u='<borders count="'+this._borders.length+'">',u+=c,e+=u+="</borders>",e+='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',f='<cellXfs count="'+this._styles.length+'">',f+=d,f+="</cellXfs>";var S="",C="";return this._tableStyles.length>0&&(this._getDxfs(),this._dxfs.length>0&&(S=this._generateDxfs()),C=this._generateTableStyles()),e+(f+'<cellStyles count="1"><cellStyle xfId="0" builtinId="0" name="Normal"/></cellStyles>')+(""===S?'<dxfs count="0"/>':S)+(""===C?'<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16"/>':C)+'<extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}"><x14ac:slicerStyles defaultSlicerStyle="SlicerStyleLight1" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"/></ext></extLst></styleSheet>'},s._generateBorderStyle=function(e,t){void 0===t&&(t=!1);var s,l,i="<border>";for(var r in{left:0,right:0,top:0,bottom:0,diagonal:0,vertical:0,horizontal:0})(t||"vertical"!==r&&"horizontal"!==r)&&(e[r]?(s="<"+r+' style="'+e[r].style+'">',6===(l=(l=e[r].color)?"#"===l[0]?l.substring(1):l:"").length&&(l="FF"+l),l||(l="FF000000"),s+='<color rgb="'+l+'"/>',s+="</"+r+">"):s="<"+r+"/>",i+=s);return i+"</border>"},s._generateFontStyle=function(e,t,s){void 0===t&&(t=!1),void 0===s&&(s=!1);var l=s?"<rPr>":"<font>";return e.bold&&(l+="<b/>"),e.italic&&(l+="<i/>"),e.underline&&(l+="<u/>"),l+='<sz val="'+(e.size?Math.round(72*e.size/96):this._defaultFontSize)+'"/>',e.color?l+='<color rgb="FF'+this._parseColor(e.color).substring(1)+'"/>':l+='<color theme="1"/>',l+="<"+(s?"rFont":"name")+' val="'+(e.family||this._defaultFontName)+'" />',l+='<family val="2"/>',t&&(l+='<scheme val="minor"/>'),l+(s?"</rPr>":"</font>")},s._generateFillStyle=function(e,t,s){void 0===s&&(s=!1);var l,i='<fill><patternFill patternType="'+e+'">';return t&&(l=s?"<bgColor ":"<fgColor ",i+=l+='rgb="FF'+("#"===t[0]?t.substring(1):t)+'"/>'),i+"</patternFill></fill>"},s._generateCellXfs=function(e,t,s,l,i){var r='<xf xfId="0" ';if(r+='numFmtId="'+e.toString()+'" ',e>0&&(r+='applyNumberFormat="1" '),r+='borderId="'+t.toString()+'" ',t>0&&(r+='applyBorder="1" '),r+='fontId="'+s.toString()+'" ',s>0&&(r+='applyFont="1" '),r+='fillId="'+l.toString()+'" ',l>0&&(r+='applyFill="1" '),i.quotePrefix&&(r+='quotePrefix="1" '),i.hAlign||i.vAlign||i.indent||i.wordWrap){r+='applyAlignment="1">';var n="<alignment ";i.hAlign&&(n+='horizontal="'+i.hAlign+'" '),i.vAlign&&(n+='vertical="'+i.vAlign+'" '),i.indent&&(n+='indent="'+i.indent+'" '),i.wordWrap&&(n+='wrapText="1"'),r+=n+="/>",r+="</xf>"}else r+="/>";return r},s._generateContentTypesDoc=function(e){var t=this,s='<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">',l=e.sheets,i=l.reduce((function(e,s,l){return e||t._sheetHasNotes(l)}),this._sheetHasNotes(0));this._macroEnabled&&(s+='<Default ContentType="application/vnd.ms-office.vbaProject" Extension="bin"/>'),i&&(s+='<Default Extension="vml" ContentType = "application/vnd.openxmlformats-officedocument.vmlDrawing" />'),s+='<Default ContentType="application/vnd.openxmlformats-package.relationships+xml" Extension="rels"/><Default ContentType="application/xml" Extension="xml"/><Override ContentType="'+(this._macroEnabled?"application/vnd.ms-excel.sheet.macroEnabled.main+xml":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml")+'" PartName="/xl/workbook.xml"/>';for(var r=0;r<this._contentTypes.length;r++)s+=this._contentTypes[r];if(s+='<Override ContentType="application/vnd.openxmlformats-officedocument.theme+xml" PartName="/xl/theme/theme1.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" PartName="/xl/styles.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" PartName="/xl/sharedStrings.xml"/><Override ContentType="application/vnd.openxmlformats-package.core-properties+xml" PartName="/docProps/core.xml"/><Override ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" PartName="/docProps/app.xml"/>',i){r=0;for(var n=0;r<l.length;r++)this._sheetHasNotes(r)&&(s+='<Override PartName="/xl/comments'+ ++n+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"/>')}for(r=0;r<this._tables.length;r++)s+='<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml" PartName="/xl/tables/'+this._tables[r]+'"/>';return s+"</Types>"},s._generateAppDoc=function(e){for(var t='<Properties xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes" xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>'+(e.application||"wijmo.xlsx")+'</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector baseType="variant" size="2"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+this._props.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector baseType="lpstr" size="'+this._props.length+'">',s=0;s<this._props.length;s++)t+="<vt:lpstr>"+this._props[s]+"</vt:lpstr>";return t+"</vt:vector></TitlesOfParts><Manager/><Company>"+(e.company||"GrapeCity, Inc.")+"</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>"},s._generateWorkbookRels=function(){for(var e='<Relationships xmlns="'+this._relationshipsNS+'">',t=0;t<this._xlRels.length;t++)e+=this._xlRels[t];return e+='<Relationship Target="sharedStrings.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Id="rId'+(this._xlRels.length+1)+'"/><Relationship Target="styles.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Id="rId'+(this._xlRels.length+2)+'"/><Relationship Target="theme/theme1.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Id="rId'+(this._xlRels.length+3)+'"/>',this._macroEnabled&&(e+='<Relationship Target="vbaProject.bin" Type="http://schemas.microsoft.com/office/2006/relationships/vbaProject" Id="rId'+(this._xlRels.length+4)+'"/>'),e+"</Relationships>"},s._generateWorkbook=function(e){for(var t='<workbook xmlns="'+this._workbookNS+'" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion rupBuild="9303" lowestEdited="5" lastEdited="5" appName="xl"/><workbookPr/><bookViews><workbookView xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"'+(null!=e.activeWorksheet?' activeTab="'+e.activeWorksheet.toString()+'"':"")+"/></bookViews><sheets>",s=0;s<this._worksheets.length;s++)t+=this._worksheets[s];if(t+="</sheets>",e.definedNames&&e.definedNames.length>0){for(t+="<definedNames>",s=0;s<e.definedNames.length;s++){var l=-1;e.definedNames[s].sheetName&&(l=this._getSheetIndexBySheetName(e,e.definedNames[s].sheetName)),t+='<definedName name="'+e.definedNames[s].name+'" '+(l>-1?'localSheetId="'+l+'"':"")+">"+e.definedNames[s].value+"</definedName>"}t+="</definedNames>"}return t+'<calcPr fullCalcOnLoad="1"/></workbook>'},s._generateWorksheetRows=function(s,l,i,r,n,o,a,h,u,c){for(var f,d=this,m=i.rows,p=function(p,_){if(a&&a.cancelled)return{value:void 0};if(h&&p-l>100&&Date.now()-s>100)return setTimeout((function(){a&&a.cancelled||(u(Math.round((p+1)/m.length*100)),d._generateWorksheetRows(Date.now(),p,i,r,n,o,a,h,u,c))}),0),{value:void 0};var y=-1,v=m[p]&&m[p].cells?m[p].cells.length:0,b=null;if(o.sheetData+='<row x14ac:dyDescent="0.25" r="'+(p+1).toString()+'"',m[p]&&(m[p].height&&(o.sheetData+=' customHeight="1" ht="'+(72*+m[p].height/96).toString()+'"'),m[p].groupLevel&&(o.sheetData+=' outlineLevel="'+m[p].groupLevel.toString()+'"'),b=m[p].style?g._cloneStyle(m[p].style):null)){(b=g._resolveStyleInheritance(b)).font&&b.font.color&&(b.font.color=g._parseColor(b.font.color)),b.fill&&b.fill.color&&(b.fill.color=g._parseColor(b.fill.color)),null==b.hAlign||e.isString(b.hAlign)||(b.hAlign=t.Workbook._parseHAlignToString(e.asEnum(b.hAlign,t.HAlign))),null==b.vAlign||e.isString(b.vAlign)||(b.vAlign=t.Workbook._parseVAlignToString(e.asEnum(b.vAlign,t.VAlign)));var x=JSON.stringify(b);(z=g._styles.indexOf(x))<0&&(z=g._styles.push(x)-1),o.sheetData+=' customFormat="1" s="'+z.toString()+'"'}for(m[p]&&!1===m[p].visible&&(o.sheetData+=' hidden="1"'),m[p]&&!0===m[p].collapsed&&(o.sheetData+=' collapsed="1"'),o.sheetData+=">";++y<v;){var w=m[p].cells[y];if(null!=w){var S="",C=-1,k=w?w.textRuns:null,F=w&&w.hasOwnProperty("value")?w.value:w,T=w&&w.style?g._cloneStyle(w.style):{};T=g._resolveStyleInheritance(T);var z,A=n[y];A&&(A=g._resolveStyleInheritance(A),T=g._extend(T,A)),b&&(T=g._extend(T,b)),r&&(r=g._resolveStyleInheritance(r),T=g._extend(T,r)),null==T.hAlign||e.isString(T.hAlign)||(T.hAlign=t.Workbook._parseHAlignToString(e.asEnum(T.hAlign,t.HAlign))),null==T.vAlign||e.isString(T.vAlign)||(T.vAlign=t.Workbook._parseVAlignToString(e.asEnum(T.vAlign,t.VAlign))),T.font&&T.font.color&&(T.font.color=g._parseColor(T.font.color)),T.fill&&T.fill.color&&(T.fill.color=g._parseColor(T.fill.color)),g._applyDefaultBorder(T),T.borders&&(T.borders=g._extend({},T.borders),g._parseBorder(T.borders,!!T.fill&&!!T.fill.color)),w&&w.isDate&&!e.isDate(F)&&(f=new Date(F),e.isDate(f)&&(F=f)),!e.isNumber(F)||!isNaN(F)&&isFinite(F)||(F=F.toString()),k||F&&e.isString(F)&&("@"===T.format||"General"===T.format||(+F).toString()!==F||!isFinite(+F))?(g._sharedStrings[1]++,"'"===(F=k?"{RichTextMark}"+JSON.stringify(k):t.Workbook._unescapeXML(F))[0]&&(T.quotePrefix=!0,F=F.substring(1)),(C=g._sharedStrings[0].indexOf(F))<0&&(C=g._sharedStrings[0].push(F)-1),F=C,S="s"):e.isBoolean(F)?(F=F?1:0,S="b"):e.isDate(F)?(F=g._convertDate(F),T.format=T.format||"mm-dd-yy"):e.isObject(F)&&(F=null),x=JSON.stringify(T),(z=g._styles.indexOf(x))<0&&(z=g._styles.push(x)-1),w&&(null!=w.colSpan&&w.colSpan>1||null!=w.rowSpan&&w.rowSpan>1)&&(w.colSpan=w.colSpan||1,w.rowSpan=w.rowSpan||1,g._checkValidMergeCell(o.merges,p,w.rowSpan,y,w.colSpan)&&o.merges.push([g._numAlpha(y)+(p+1),g._numAlpha(y+w.colSpan-1)+(p+w.rowSpan)])),w&&w.link&&(null==o.hyperlinks&&(o.hyperlinks=[]),o.hyperlinks.push({ref:t.Workbook.xlsxAddress(p,y),value:F,href:w.link})),T=null,o.sheetData+=g._generateCell(p,y,z,S,F,w&&w.formula?w.formula:null)}}o.sheetData+="</row>"},g=this,_=l,y=m.length;_<y;_++){var v=p(_);if("object"==typeof v)return v.value}e.isFunction(c)&&c()},s._generateWorkSheet=function(e,s,l,i,n,o){var a=this,h=s.sheets[e];if(!h)throw"Worksheet should not be empty!";o(0),this._collectNotes(h,e);var u=new r(i),c=h.columns,f=this._cloneColumnsStyle(c),d=h.style?this._cloneStyle(h.style):null,m='<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"'+this._generateSheetGlobalSetting(e,h,s),p={hyperlinks:[],merges:[],sheetData:"<sheetData>"};return this._generateWorksheetRows(Date.now(),0,h,d,f,p,i,n,o,(function(){var s=e+1;if(p.sheetData+="</sheetData>",c&&c.length>0){m+="<cols>";for(var i=0;i<c.length;i++)m+=a._generateWorksheetColumn(f[i],c[i],i);var r=h._extraColumn;r&&(r.min=Math.max(c.length,r.min),r.min<=r.max&&(m+=a._generateWorksheetColumn(r.style,r,-1))),m+="</cols>"}p.sheetData=m+p.sheetData,m=p.sheetData,p.sheetData=null,p.merges.length>0&&(m+=a._generateMergeSetting(p.merges));var n=1,d=0;a._sheetHasNotes(e)&&(d=n++);var g=p.hyperlinks;if(g&&g.length>0){for(m+="<hyperlinks>",i=0;i<g.length;i++)/\'?(\w+)\'?\!\$?[A-Za-z]{1,2}\$?\d+(:\$?[A-Za-z]{1,2}\$?\d+)?/.test(g[i].href)||/^\$?[A-Za-z]{1,2}\$?\d+(:\$?[A-Za-z]{1,2}\$?\d+)?$/.test(g[i].href)?m+='<hyperlink ref="'+g[i].ref+'" display="'+g[i].value+'" location="'+g[i].href+'"/>':(null==h.externalLinks&&(h.externalLinks=[]),h.externalLinks.push(g[i].href),m+='<hyperlink ref="'+g[i].ref+'" r:id="rId'+n+'"/>',n++);m+="</hyperlinks>"}if(m+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>',h.tables&&h.tables.length>0){for(m+='<tableParts count="'+h.tables.length+'">',i=0;i<h.tables.length;i++)m+='<tablePart r:id="rId'+n+'"/>',n++;m+="</tableParts>"}d>0&&(m+='<legacyDrawing r:id="rId'+d+'"/>'),m+="</worksheet>",l.file("sheet"+s+".xml",a._xmlDescription+m),m=null;var _='<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" PartName="/xl/worksheets/sheet'+s+'.xml"/>';a._contentTypes.unshift(_),a._props.unshift(t.Workbook._escapeXML(h.name)||"Sheet"+s);var y='<Relationship Target="worksheets/sheet'+s+'.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Id="rId'+s+'"/>';a._xlRels.unshift(y);var v='<sheet r:id="rId'+s+'" sheetId="'+s+'" name="'+(t.Workbook._escapeXML(h.name)||"Sheet"+s)+'"'+(!1===h.visible?' state="hidden"':"")+"/>";a._worksheets.unshift(v),o(100),u.resolve()})),u},s._generateWorksheetColumn=function(s,l,i){var r=-1,n="";if(!this._isEmpty(s)){(s=this._resolveStyleInheritance(s)).font&&s.font.color&&(s.font.color=this._parseColor(s.font.color)),s.fill&&s.fill.color&&(s.fill.color=this._parseColor(s.fill.color)),null==s.hAlign||e.isString(s.hAlign)||(s.hAlign=t.Workbook._parseHAlignToString(e.asEnum(s.hAlign,t.HAlign))),null==s.vAlign||e.isString(s.vAlign)||(s.vAlign=t.Workbook._parseVAlignToString(e.asEnum(s.vAlign,t.VAlign)));var o=JSON.stringify(s);(r=this._styles.indexOf(o))<0&&(r=this._styles.push(o)-1)}if(!this._isEmpty(l)){var a=l.width;if(a=null!=a?"string"==typeof a&&a.indexOf("ch")>-1?this._parseCharCountToCharWidth(a.substring(0,a.indexOf("ch"))):this._parsePixelToCharWidth(a):8.43,-1==i)n+='<col min="'+l.min+'" max="'+l.max+'"';else{var h=(i+1).toString();n+='<col min="'+h+'" max="'+h+'"'}r>=0&&(n+=' style="'+r.toString()+'"'),a&&(n+=' width="'+a+'" customWidth="1"'),!1!==l.autoWidth&&(n+=' bestFit="1"'),!1===l.visible&&(n+=' hidden="1"'),n+="/>"}return n},s._generateSharedStringsDoc=function(){for(var e='<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+this._sharedStrings[1]+'" uniqueCount="'+this._sharedStrings[0].length+'">',t=0;t<this._sharedStrings[0].length;t++){e+="<si>";var s=this._sharedStrings[0][t];if(s&&0===s.indexOf("{RichTextMark}"))try{var l=JSON.parse(s.substring(14));e+=this._generateTextRuns(l,this._defaultFontName.toLowerCase())+"</si>"}catch(t){e+=this._generatePlainText(s)+"</si>"}else e+=this._generatePlainText(s)+"</si>"}return e+"</sst>"},s._generateTextRuns=function(e,t){var s="";if(e&&e.length>0)for(var l=0;l<e.length;l++){s+="<r>";var i=e[l];if(i.font){var r=!i.font.family||i.font.family.toLowerCase()===t;s+=this._generateFontStyle(i.font,r,!0)}s+=this._generatePlainText(i.text),s+="</r>"}return s},s._generatePlainText=function(s){if(""===s)return"<t/>";var l="<t";return(e.isNullOrWhiteSpace(s)||/^\s+\w*|\w*\s+$/.test(s))&&(l+=' xml:space="preserve"'),l+">"+t.Workbook._escapeXML(s)+"</t>"},s._generateTable=function(e,t){var s=this._tables.length+1,l="table"+s+".xml";e.fileName=l,this._tables.push(l);var i='<table ref="'+e.range+'" displayName="'+e.name+'" name="'+e.name+'" id="'+s+'" '+(!1===e.showHeaderRow?'headerRowCount="0" ':"")+(!0===e.showTotalRow?'totalsRowCount="1" ':'totalsRowShown="0" ')+' xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';!1!==e.showHeaderRow&&(i+=this._generateTableFilterSetting(e.range,e.showTotalRow,e.columns)),i+='<tableColumns count="'+e.columns.length+'">';for(var r="",n=0;n<e.columns.length;n++){var o=e.columns[n];r+='<tableColumn name="'+o.name+'" id="'+(n+1)+'" ',o.totalRowFunction?this._tableColumnFunctions.indexOf(o.totalRowFunction)>-1?r+='totalsRowFunction="'+o.totalRowFunction+'"/>':r+='totalsRowFunction="custom"><totalsRowFormula>'+o.totalRowFunction+"</totalsRowFormula></tableColumn>":r+=(o.totalRowLabel?'totalsRowLabel="'+o.totalRowLabel+'"':"")+"/>"}if(i+=r+"</tableColumns>",i+='<tableStyleInfo name="'+e.style.name+'" showColumnStripes="'+(e.showBandedColumns?"1":"0")+'" showRowStripes="'+(e.showBandedRows?"1":"0")+'" showLastColumn="'+(e.alterLastColumn?"1":"0")+'" showFirstColumn="'+(e.alterFirstColumn?"1":"0")+'"/></table>',!this._isBuiltInStyleName(e.style.name)){var a=JSON.stringify(e.style);-1===this._tableStyles.indexOf(a)&&this._tableStyles.push(a)}t.file(l,this._xmlDescription+i),i=null},s._generateTableFilterSetting=function(e,s,l){var i=e;if(s){var r=i.indexOf(":")+1,n=t.Workbook.tableAddress(i.substring(i.indexOf(":")+1));n.row-=1,i=i.substring(0,r)+t.Workbook.xlsxAddress(n.row,n.col)}for(var o='<autoFilter ref="'+i+'"',a="",h=0;h<l.length;h++)!1===l[h].showFilterButton&&(a+='<filterColumn hiddenButton="1" colId="'+h+'"/>');return o+(""===a?"/>":">"+a+"</autoFilter>")},s._generateHyperlinkRel=function(e,t){for(var s="",l=0;l<e.length;l++)s+='<Relationship TargetMode="External" Target="'+e[l]+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Id="rId'+(t+l)+'"/>';return s},s._getDxfs=function(){for(var t,s=this,l=0;l<this._tableStyles.length;l++)t=JSON.parse(this._tableStyles[l]),Object.keys(t).forEach((function(l){var i,r,n=t[l];n&&!e.isString(n)&&(s._isEmptyStyleEle(n)||(i=JSON.stringify(n),-1===(r=s._dxfs.indexOf(i))&&(r=s._dxfs.push(i)-1,n.styleIndex=r)))})),this._tableStyles[l]=t},s._generateDxfs=function(){for(var e,t='<dxfs count="'+this._dxfs.length+'">',s=0;s<this._dxfs.length;s++)t+="<dxf>",(e=JSON.parse(this._dxfs[s])).font&&(t+=this._generateFontStyle(e.font)),e.fill&&e.fill.color&&(t+=this._generateFillStyle("solid",e.fill.color,!0)),e.borders&&!this._isEmpty(e.borders)&&(e.borders=this._extend({},e.borders),this._parseBorder(e.borders,!1),t+=this._generateBorderStyle(e.borders,!0)),t+="</dxf>";return t+"</dxfs>"},s._generateTableStyles=function(){for(var t,s,l,i,r,n,o='<tableStyles count="'+this._tableStyles.length+'" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16">',a=0;a<this._tableStyles.length;a++){t=this._tableStyles[a],s=Object.keys(t),r="",n=0;for(var h=0;h<s.length;h++)if(i=t[l=s[h]],!e.isString(i)){switch(n++,r+="<tableStyleElement",null!=i.styleIndex&&(r+=' dxfId="'+i.styleIndex+'"'),l){case"firstBandedColumnStyle":r+=' type="firstColumnStripe"',null!=i.size&&(r+=' size="'+i.size+'"');break;case"secondBandedColumnStyle":r+=' type="secondColumnStripe"',null!=i.size&&(r+=' size="'+i.size+'"');break;case"firstBandedRowStyle":r+=' type="firstRowStripe"',null!=i.size&&(r+=' size="'+i.size+'"');break;case"secondBandedRowStyle":r+=' type="secondRowStripe"',null!=i.size&&(r+=' size="'+i.size+'"');break;default:r+=' type="'+l.substring(0,l.length-5)+'"'}r+="/>"}n>0&&(o+='<tableStyle count="'+n+'" name="'+t.name+'" pivot="0">',o+=r+"</tableStyle>")}return o+"</tableStyles>"},s._isEmptyStyleEle=function(t){return this._isEmpty(t.borders)&&(this._isEmpty(t.fill)||e.isNullOrWhiteSpace(t.fill.color))&&(this._isEmpty(t.font)||!0!==t.font.bold&&e.isNullOrWhiteSpace(t.font.color)&&e.isNullOrWhiteSpace(t.font.family)&&!0!==t.font.italic&&null==t.font.size&&!0!==t.font.underline)},s._getTableFileName=function(e,t){for(var s="",l=0;l<e.length;l++){var i=e[l];if(i.name===t){s=i.fileName;break}}return s},s._getColor=function(e,t){var s,l=-1,i=-1,r=-1;if(t&&-1===(l=e.search(/<fgcolor/i))&&-1===(i=e.search(/<bgcolor/i))||!t&&-1===(r=e.search(/<color/i)))return null;if(t){var n=l>=0?l:i,o=n>=0?e.search(/<\/fgc/i):e.indexOf(/<\/bgc/i);o=o>0?o:e.indexOf("/>"),e=e.substring(n,o)}else e=e.substring(r);if(-1!==e.indexOf("rgb="))(s=this._getAttr(e,"rgb"))&&8===s.length&&(s=s.substring(2));else if(-1!==e.indexOf("indexed")){var a=+this._getAttr(e,"indexed");s=this._indexedColors[a]||""}else if(-1!==e.indexOf("auto")&&"1"===this._getAttr(e,"auto"))s="#000000";else{var h,u=+this._getAttr(e,"theme");-1!==e.indexOf("tint")&&(h=+this._getAttr(e,"tint")),s=this._getThemeColor(u,h)}return s&&"#"===s[0]?s:"#"+s},s._getThemeColor=function(t,s){if(!this._colorThemes)return"#000000";var l=this._colorThemes[t];if(null!=s){var i=new e.Color("#"+l),r=i.getHsl();return r[2]=s<0?r[2]*(1+s):r[2]*(1-s)+(1-1*(1-s)),(i=e.Color.fromHsl(r[0],r[1],r[2])).toString().substring(1)}return l},s._parseColor=function(t){var s=this._parsedColors[t];if(!s){var l=new e.Color(t);l.a<1&&(l=e.Color.toOpaque(l)),this._parsedColors[t]=s=l.toString()}return s},s._getsBaseSharedFormulas=function(e){var t,s,l,i=e.match(/\<f[^<]*ref[^<]*>[^<]+(?=\<\/f>)/g);if(this._sharedFormulas=[],i&&i.length>0)for(var r=0;r<i.length;r++)t=i[r],s=this._getAttr(t,"si"),l=(l=this._getAttr(t,"ref"))?l.substring(0,l.indexOf(":")):"",t=t.replace(/(\<f.*>)(.+)/,"$2"),this._sharedFormulas[+s]=this._parseSharedFormulaInfo(l,t)},s._parseSharedFormulaInfo=function(e,s){var l,i,r,n,o,a=s.match(/(\'?\w+\'?\!)?(\$?[A-Za-z]+)(\$?\d+)/g);if(n=t.Workbook.tableAddress(e),a&&a.length>0){o=[];for(var h=0;h<a.length;h++)l=a[h],s=s.replace(l,"{"+h+"}"),(i=l.indexOf("!"))>0&&(r=l.substring(0,i),l=l.substring(i+1)),o[h]={cellAddress:t.Workbook.tableAddress(l),sheetRef:r}}return{cellRef:n,formula:s,formulaRefs:o}},s._getSharedFormula=function(e,s){var l,i,r,n,o,a,h,u,c,f,d,m;if(this._sharedFormulas&&this._sharedFormulas.length>0&&(l=this._sharedFormulas[+e])){if(c=l.formula,(f=l.formulaRefs)&&f.length>0){i=t.Workbook.tableAddress(s),h=l.cellRef?l.cellRef.row:0,u=l.cellRef?l.cellRef.col:0,r=i.row-h,n=i.col-u;for(var p=0;p<f.length;p++)o=(d=f[p]).cellAddress.row+(d.cellAddress.absRow?0:r),a=d.cellAddress.col+(d.cellAddress.absCol?0:n),m=t.Workbook.xlsxAddress(o,a,d.cellAddress.absRow,d.cellAddress.absCol),null!=d.sheetRef&&""!==d.sheetRef&&(m=d.sheetRef+"!"+m),c=c.replace("{"+p+"}",m)}return c}return""},s._convertDate=function(t){var s,l,i=new Date(1900,0,0),r=Date.UTC(1900,0,0),n="[object Date]"===Object.prototype.toString.call(t),o=6e4*((n?t.getTimezoneOffset():(new Date).getTimezoneOffset())-i.getTimezoneOffset()),a=i.getTime()-r-6e4*i.getTimezoneOffset();return n?(t.getTime()-i.getTime()-o+a)/864e5+1:e.isNumber(t)?(s=t>59?1:0,0!=(o=6e4*((l=new Date(1e3*Math.round((+i+864e5*(t-s))/1e3))).getTimezoneOffset()-i.getTimezoneOffset()))?new Date(1e3*Math.round((+i+o-a+864e5*(t-s))/1e3)):l):null},s._parseBorder=function(s,l){for(var i in{left:0,right:0,top:0,bottom:0,diagonal:0}){var r=s[i];r&&(e.isString(r.color)&&(r.color=this._parseColor(r.color)),null==r.style||e.isString(r.style)||(r.style=t.Workbook._parseBorderTypeToString(e.asEnum(r.style,t.BorderStyle,!1))),!l&&r.color&&"#c6c6c6"===r.color.toLowerCase()&&"thin"===r.style&&(s[i]=null))}},s._applyDefaultBorder=function(e){if(e.fill&&e.fill.color)for(var s in null==e.borders&&(e.borders={}),{left:0,right:0,top:0,bottom:0})null==e.borders[s]&&(e.borders[s]={style:t.BorderStyle.Thin,color:"#C6C6C6"})},s._resolveStyleInheritance=function(e){var t;if(!e.basedOn)return e;for(var s in e.basedOn)if("basedOn"===s)for(s in t=this._resolveStyleInheritance(e.basedOn)){var l=t[s];e[s]=null==e[s]?l:this._extend(e[s],l)}else l=e.basedOn[s],e[s]=null==e[s]?l:this._extend(e[s],l);return delete e.basedOn,e},s._parsePixelToCharWidth=function(e){return null==e||isNaN(+e)?null:((+e-5)/7*100+.5)/100},s._parseCharWidthToPixel=function(e){return null==e||isNaN(+e)?null:Math.floor((256*+e+128/7)/256*7)+5},s._parseCharCountToCharWidth=function(e){return null==e||isNaN(+e)?null:(7*+e+5)/7*256/256},s._numAlpha=function(e){var t=Math.floor(e/26)-1;return(t>-1?this._numAlpha(t):"")+this._alphabet.charAt(e%26)},s._alphaNum=function(e){return e.length>1?(this._alphabet.indexOf(e[0])+1)*Math.pow(26,e.length-1)+this._alphaNum(e.substring(1)):this._alphabet.indexOf(e)},s._typeOf=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},s._extend=function(t,s){if(e.isObject(t)&&e.isObject(s)){for(var l in s){var i=s[l];e.isObject(i)&&null!=t[l]?this._extend(t[l],i):null!=i&&null==t[l]&&(t[l]=i)}return t}return s},s._isEmpty=function(e){var t=Object.prototype.hasOwnProperty;if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var s in e)if(t.call(e,s))return!1;return!0},s._cloneStyle=function(e){var t;if(null==e||"object"!=typeof e)return e;for(var s in t={},e)e.hasOwnProperty(s)&&(t[s]=this._cloneStyle(e[s]));return t},s._cloneColumnsStyle=function(e){for(var t,s=[],l=0;l<e.length;l++)(t=e[l])&&t.style&&(s[l]=this._cloneStyle(t.style));return s},s._getSheetIndex=function(e){return+(e=e.substring(0,e.lastIndexOf(".xml"))).substring(e.lastIndexOf("sheet")+5)},s._checkValidMergeCell=function(e,t,s,l,i){for(var r=0;r<e.length;r++){var n=e[r],o=+n[0].match(/\d*/g).join("")-1,a=this._alphaNum(n[0].match(/[a-zA-Z]*/g)[0]),h=+n[1].match(/\d*/g).join("")-1,u=this._alphaNum(n[1].match(/[a-zA-Z]*/g)[0]);if(!(t>h||t+s-1<o||l>u||l+i-1<a))return!1}return!0},s._getAttr=function(e,t){var s=e.indexOf(t+'="');return s>=0?(s+=t.length+2,e.substring(s,e.indexOf('"',s))):""},s._getChildNodeValue=function(e,t){var s=e.indexOf(t+' val="');return s>=0?(s+=t.length+6,e.substring(s,e.indexOf('"',s))):""},s._getElementValue=function(e,t,s,l){var i=e.indexOf("<"+t);if(i>=0){var r=void 0;return(i=e.indexOf(">",i+1+t.length))>0&&"/"!==e[i-1]&&(r=e.substring(i+1,e.indexOf("</",i+1))),r||l}return s},s._getSubElement=function(e,t){if(e){var s=e.indexOf("<"+t);if(s>=0){var l=s+1+t.length,i=e.indexOf("</"+t,l);return i<0&&(i=e.indexOf("/>",l)),e.substring(l,i)}}},s._getSheetIndexBySheetName=function(e,t){for(var s=0;s<e.sheets.length;s++)if(e.sheets[s].name===t)return s;return-1},s._sheetHasNotes=function(e){return!!this._notes[e]},s._collectNotes=function(e,t){for(var s,l=e.rows,i=0,r=l.length;i<r;i++){var n=l[i];if(n)for(var o=0,a=n.cells.length;o<a;o++){var h=n.cells[o];if(h){var u=h.note;u&&(null!=u.text||u.textRuns&&u.textRuns.length>0)&&(s||(s=this._notes[t])||(this._notes[t]=s=[]),u._row=i,u._col=o,s.push(u))}}}},s._alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s._indexedColors=["000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","000000","FFFFFF","FF0000","00FF00","0000FF","FFFF00","FF00FF","00FFFF","800000","008000","000080","808000","800080","008080","C0C0C0","808080","9999FF","993366","FFFFCC","CCFFFF","660066","FF8080","0066CC","CCCCFF","000080","FF00FF","FFFF00","00FFFF","800080","800000","008080","0000FF","00CCFF","CCFFFF","CCFFCC","FFFF99","99CCFF","FF99CC","CC99FF","FFCC99","3366FF","33CCCC","99CC00","FFCC00","FF9900","FF6600","666699","969696","003366","339966","003300","333300","993300","993366","333399","333333","000000","FFFFFF"],s._numFmts=["General","0","0.00","#,##0","#,##0.00",,,"$#,##0.00_);($#,##0.00)",,"0%","0.00%","0.00E+00","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"],s._tableColumnFunctions="average, count, countNums, max, min, stdDev, sum, var",s._xmlDescription='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',s._workbookNS="http://schemas.openxmlformats.org/spreadsheetml/2006/main",s._relationshipsNS="http://schemas.openxmlformats.org/package/2006/relationships",s._defaultFontName="Calibri",s._defaultFontSize=11,s._macroEnabled=!1,s._defaultColorThemes=["FFFFFF","000000","EEECE1","1F497D","4F818D","C0504D","9BBB59","8064A2","4BACC6","F79646"],s._parsedColors={},s}();t._xlsx=s;var l=function(){function e(e){this.value=e}return e.prototype.then=function(t,s){return new e(t?t(this.value):null)},e.prototype.catch=function(e){return this.then(null,e)},e.resolve=function(){return new e},e}(),i=function(){function e(e){this._obj=e}return e.prototype.loadAsync=function(){for(var e,t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var i=(e=this._obj).load.apply(e,t);return new l(this._wrapOrNull(i))},e.prototype.file=function(){for(var e,t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var l=(e=this._obj).file.apply(e,t);return this._wrapOrNull(l)},Object.defineProperty(e.prototype,"name",{get:function(){return this._obj.name},enumerable:!0,configurable:!0}),e.prototype.async=function(){for(var e,t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return e=t&&t.length>0&&"uint8array"===t[0].toLowerCase()?this._obj.asUint8Array():this._obj.asText(),new l(e)},e.prototype.folder=function(e){var t=this._obj.folder(e);return this._wrapOrNull(t)},e.prototype.forEach=function(t){var s=this._obj.root,l=s.length,i=this._obj.files;for(var r in i)r.length>l&&r.substr(0,l).toLowerCase()===s&&t(r.substr(l),new e(i[r]))},e.prototype._wrapOrNull=function(t){return null!=t?new e(t):null},e}(),r=function(){function e(e,t){this._callbacks=[],this._cs=e,this._onCancel=t}return e.serial=function(t,s){s=s.slice();var l=new e(t),i=[],r=function(){l.cancelled?s=[]:s.length?s.shift()().then((function(e){i.push(e),r()}),(function(e){s=[],l.reject(e)})):l.resolve(i)};return r(),l},e.prototype.cancel=function(e){void 0===e&&(e=!0),this._cancelled=!0,e&&this._onCancel&&this._onCancel()},Object.defineProperty(e.prototype,"cancelled",{get:function(){return this._cancelled||this._cs&&this._cs.cancelled},enumerable:!0,configurable:!0}),e.prototype.then=function(e,t){return this._callbacks.push({onFulfilled:e,onRejected:t}),this._resolved&&this.resolve(this._resolved.value),this},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.resolve=function(e){if(this.cancelled)return this;this._resolved={value:e};try{this.onFulfilled(e)}catch(e){this.onRejected(e)}return this},e.prototype.reject=function(e){return this.cancelled||this.onRejected(e),this},e.prototype.onFulfilled=function(e){for(;this._callbacks.length;){var t=this._callbacks[0];t.onFulfilled&&t.onFulfilled(e),this._callbacks.shift()}},e.prototype.onRejected=function(e){for(var t;t=this._callbacks.shift();)t.onRejected&&t.onRejected(e)},e}();t._SyncPromise=r;var n=function(){function e(e){this._colsWidthCnt=0,this._colsWidth=[],this._rowsHeightCnt=0,this._rowsHeight=[],this._cols=e.columns,this._rows=e.rows}return e.prototype.toAnchor=function(e,t,s){var l,i,r,n,o,a,h,u,c=e.offsetX,f=e.offsetY;if(c<0){var d=void 0;for(l=s,i=-c;l>=0&&!(i<=(d=this._getColWidth(l)));l--)i-=d;i=d-i}else for(l=s+1,i=c;i>=0&&!(i<=(d=this._getColWidth(l)));l++)i-=d;if(f<0)for(r=t-1,n=-f;r>=0&&!(n<=(m=this._getRowHeight(r)));r--)n-=m;else for(r=t,n=f;n>=0;r++){var m;if(n<=(m=this._getRowHeight(r)))break;n-=m}for(o=l,a=i+e.width;a>=0&&!(a<=(d=this._getColWidth(o)));o++)a-=d;for(h=r,u=n+e.height;u>=0;h++){var p=this._getRowHeight(h);if(u<=p)break;u-=p}return[l,i,r,n,o,a,h,u]},e.prototype.fromAnchor=function(e,t,s,l){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],f=0;if(l===i)f=-(this._getColWidth(l)-r);else if(i>l){f+=r;for(var d=l+1,m=i-1;d<=m;d++)f+=this._getColWidth(d)}else{for(d=i+1,m=l;d<=m;d++)f-=this._getColWidth(d);f-=this._getColWidth(i)-r}var p=0;if(s===n)p=o;else if(n>s){for(var g=s,_=n-1;g<=_;g++)p+=this._getRowHeight(g);p+=o}else{var y=n+1;for(_=s;y<_;y++)p-=this._getRowHeight(y);p-=this._getRowHeight(n)-o}var v=0;if(i===a)v=h-r;else{for(d=i+1,m=a-1;d<=m;d++)v+=this._getColWidth(d);v+=this._getColWidth(i)-r,v+=h}var b=0;if(n===u)b=c-o;else{var x=n+1;for(_=u-1;x<=_;x++)b+=this._getRowHeight(x);b+=this._getRowHeight(n)-o,b+=c}t.offsetX=f,t.offsetY=p,t.width=v,t.height=b},e.prototype._getColWidth=function(e){var t=this._colsWidth[e];if(null==t){this._colsWidthCnt>1e3&&(this._colsWidth=[],this._colsWidthCnt=0);var s=this._cols[e];t=!s||null==s.visible||s.visible?s&&null!=s.width?Math.max(s.width-5,0):64:0,this._colsWidth[e]=t,this._colsWidthCnt++}return t},e.prototype._getRowHeight=function(e){var t=this._rowsHeight[e];if(null==t){this._rowsHeightCnt>1e3&&(this._rowsHeight=[],this._rowsHeightCnt=0);var s=this._rows[e];t=!s||null==s.visible||s.visible?s&&null!=s.height?s.height:20:0,this._rowsHeight[e]=t,this._rowsHeightCnt++}return t},e}();function o(e,t,s,l,i){var r=s-t;return 0==r&&(r=1),(i-l)/r*(e-t)+l}t._map=o;var a=String.fromCodePoint||function(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),e%1024+56320))},h=0}(e.xlsx||(e.xlsx={}))}(wijmo||(wijmo={})),function(e){e.xlsx||(e.xlsx={}),e._registerModule("wijmo.xlsx",e.xlsx)}(wijmo||(wijmo={}));