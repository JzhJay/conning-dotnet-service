/*! For license information please see wijmo.grid.filter.js.LICENSE.txt */
var wijmo,__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(e){var t;!function(t){"use strict";var i;!function(e){e[e.None=0]="None",e[e.Condition=1]="Condition",e[e.Value=2]="Value",e[e.Both=3]="Both"}(i=t.FilterType||(t.FilterType={}));var n=function(){function n(t,n){this._showIcons=!0,this._showSort=!0,this._defFilterType=i.Both,this._xValueSearch=!0,this.filterApplied=new e.Event,this.editingFilter=new e.Event,this.filterChanging=new e.Event,this.filterChanged=new e.Event,this._filters=[],this._g=e.asType(t,e.grid.FlexGrid,!1),this._g.formatItem.addHandler(this._formatItem.bind(this)),this._g.itemsSourceChanged.addHandler(this.clear.bind(this));var r=this._g.hostElement;t.addEventListener(r,"mousedown",this._mousedown.bind(this),!0),t.addEventListener(r,"click",this._click.bind(this),!0),t.addEventListener(r,"keydown",this._keydown.bind(this),!0),this._g.invalidate(),e.copy(this,n)}return Object.defineProperty(n.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filterColumns",{get:function(){return this._filterColumns},set:function(t){this._filterColumns=e.asArray(t),this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showFilterIcons",{get:function(){return this._showIcons},set:function(t){t!=this.showFilterIcons&&(this._showIcons=e.asBoolean(t),this._g&&this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showSortButtons",{get:function(){return this._showSort},set:function(t){this._showSort=e.asBoolean(t)},enumerable:!0,configurable:!0}),n.prototype.getColumnFilter=function(e,i){if(void 0===i&&(i=!0),e=this._asColumn(e)){for(var n=0;n<this._filters.length;n++)if(this._filters[n].column==e)return this._filters[n];if(i&&e.binding){var r=new t.ColumnFilter(this,e);return this._filters.push(r),r}}return null},Object.defineProperty(n.prototype,"defaultFilterType",{get:function(){return this._defFilterType},set:function(t){(t=e.asEnum(t,i,!1))!=this.defaultFilterType&&(this._defFilterType=t,this._g.invalidate(),this.clear())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"exclusiveValueSearch",{get:function(){return this._xValueSearch},set:function(t){this._xValueSearch=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filterDefinition",{get:function(){var e=this,t={defaultFilterType:this.defaultFilterType,filters:[]};return this._filters.forEach((function(i){var n=i.conditionFilter,r=i.valueFilter,l=r.uniqueValues&&r.uniqueValues.length;if(i&&i.column&&i.column.binding&&(i.isActive||l||i.filterType!=e.defaultFilterType)){var a={binding:i.column.binding};if(n.isActive){var o=n.condition1,s=n.condition2;a={binding:i.column.binding,type:"condition",condition1:{operator:o.operator,value:o.value},and:n.and,condition2:{operator:s.operator,value:s.value}}}else(r.isActive||l)&&(a={binding:i.column.binding,type:"value",uniqueValues:r.uniqueValues,sortValues:r.sortValues,maxValues:r.maxValues,exclusiveValueSearch:r.exclusiveValueSearch,showValues:r.showValues});i.filterType!=e.defaultFilterType&&(a.filterType=i.filterType),t.filters.push(a)}})),JSON.stringify(t)},set:function(t){if(t=e.asString(t),this.clear(),t){var n=JSON.parse(t);this.defaultFilterType=n.defaultFilterType;for(var r=function(t){var r=n.filters[t],a=l._asColumn(r.binding);a||(a=new e.grid.Column({binding:r.binding}));var o=l.getColumnFilter(a,!0);if(o)switch(null!=r.filterType&&(o.filterType=e.asEnum(r.filterType,i)),r.type){case"condition":var s=o.conditionFilter;s.condition1.value=a.dataType==e.DataType.Date?e.changeType(r.condition1.value,a.dataType,null):r.condition1.value,s.condition1.operator=r.condition1.operator,s.and=r.and,s.condition2.value=a.dataType==e.DataType.Date?e.changeType(r.condition2.value,a.dataType,null):r.condition2.value,s.condition2.operator=r.condition2.operator;break;case"value":var u=o.valueFilter;u.uniqueValues=r.uniqueValues,["sortValues","maxValues","exclusiveValueSearch"].forEach((function(e){null!=r[e]&&(u[e]=r[e])})),u.showValues=r.showValues}},l=this,a=0;a<n.filters.length;a++)r(a)}this.apply()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activeEditor",{get:function(){return e.Control.getControl(this._divEdt)},enumerable:!0,configurable:!0}),n.prototype.editColumnFilter=function(i,n,r){var l=this,a=this._g;this.closeEditor(),i=this._asColumn(i);var o=new e.grid.CellRangeEventArgs(a.cells,new e.grid.CellRange(-1,i.index));if(this.onEditingFilter(o)){var s=e.createElement('<div class="wj-dropdown-panel"></div>'),u=this.getColumnFilter(i),c=new t.ColumnFilterEditor(s,u,this.showSortButtons);if(this._divEdt=s,this._edtCol=i,a.rightToLeft&&(s.dir="rtl"),this.onFilterChanging(o)){o.cancel=!0,c.filterChanged.addHandler((function(){o.cancel=!1,setTimeout((function(){o.cancel||l.apply()}))})),c.buttonClicked.addHandler((function(){l.closeEditor(),a.focus(),l.onFilterChanged(o)})),c.lostFocus.addHandler((function(){setTimeout((function(){var t=e.Control.getControl(l._divEdt);t&&!t.containsFocus()&&l.closeEditor()}),10)}));var d=n?n.col:i.index,p=a.columns[d];n||p&&p.binding==i.binding||(d=a.selection.leftCol),a._edtHdl._commitRowEdits(),a.scrollIntoView(-1,d,!0);var h=a.columnHeaders,f=n&&n.panel==h?n.row:h.rows.length-1,_=d,v=r||h.getCellElement(f,_),b=v?null:h.getCellBoundingRect(f,_);v?e.showPopup(s,v,!1,!1,!1):e.showPopup(s,b),this._setAriaExpanded(v,!0),this._setAriaExpanded(a.cells.getCellElement(-1,_),!0);for(var g=c.hostElement.querySelectorAll("input"),y=0;y<g.length;y++){var m=g[y];if(m.offsetHeight>0&&m.tabIndex>-1&&!m.disabled){m.focus();break}}c.containsFocus()||c.focus()}else this._divEdt=this._edtCol=null}},n.prototype._setAriaExpanded=function(t,i){if(t){var r=t.querySelector("."+n._WJC_FILTER);e.setAttribute(r,"aria-expanded",i)}},n.prototype.closeEditor=function(){var t=this._g,i=e.Control.getControl(this._divEdt),n=this._edtCol;if(i&&e.hidePopup(i.hostElement,(function(){i.dispose()})),n){var r=t.columnHeaders,l=r.rows.length?r.getCellElement(r.rows.length-1,n.index):null;this._setAriaExpanded(l,!1),l=t.cells.getCellElement(-1,n.index),this._setAriaExpanded(l,!1)}this._divEdt=null,this._edtCol=null},n.prototype.apply=function(){var t=this._g.collectionView;if(t){var i=this._g.editableCollectionView;i&&(i.commitEdit(),i.commitNew()),t.filter=this._filter.bind(this)}var n=t?t.updateFilterDefinition:null;e.isFunction(n)&&n.call(t,this),this.onFilterApplied()},n.prototype.clear=function(){this._filters.length&&(this._filters=[],this.apply())},n.prototype.onFilterApplied=function(e){this.filterApplied.raise(this,e)},n.prototype.onEditingFilter=function(e){return this.editingFilter.raise(this,e),!e.cancel},n.prototype.onFilterChanging=function(e){return this.filterChanging.raise(this,e),!e.cancel},n.prototype.onFilterChanged=function(e){this.filterChanged.raise(this,e)},n.prototype._asColumn=function(t){return e.isString(t)?this._g.getColumn(t,!0):e.isNumber(t)?this._g.columns[t]:e.asType(t,e.grid.Column,!1)},n.prototype._filter=function(e){for(var t=this._filters,i=0;i<t.length;i++){var r=t[i];if(r.column!=n._skipColumn&&!r.apply(e))return!1}return!0},n.prototype._formatItem=function(t,n){if(n.panel==t.columnHeaders){var r=this._g,l=r.getMergedRange(n.panel,n.row,n.col)||new e.grid.CellRange(n.row,n.col),a=r.columns[l.col],o=r._getBindingColumn(n.panel,n.row,a),s=n.cell;if(l.row2==n.panel.rows.length-1||a!=o){var u=this.getColumnFilter(o,this.defaultFilterType!=i.None),c=this._filterColumns;c&&c.length&&c.indexOf(o.binding)<0&&c.indexOf(o.name)<0&&(u=null),u?(e.toggleClass(s,"wj-filter-on",u.isActive),e.toggleClass(s,"wj-filter-off",!u.isActive)):(e.removeClass(s,"wj-filter-on"),e.removeClass(s,"wj-filter-off")),u&&u.filterType!=i.None&&(this._showIcons&&this._addFilterButton(o,u,s),0==n.row&&(s=r.cells.getCellElement(-1,n.col))&&this._addFilterButton(a,u,s))}}},n.prototype._addFilterButton=function(t,i,r){var l=n._WJC_FILTER,a=e.createElement('<button class="wj-btn wj-btn-glyph wj-right '+l+'" type="button" tabindex="-1"><span class="wj-glyph-filter"></span></button>');e.setAriaLabel(a,e.culture.FlexGridFilter.ariaLabels.edit+" "+t.header),e.setAttribute(a,"aria-haspopup","dialog"),e.setAttribute(a,"aria-expanded",!1),e.setAttribute(a,"aria-describedby",t.describedById),e.setAttribute(a,"aria-pressed",i.isActive),r.querySelector("."+l)||(1==r.children.length&&(r=r.querySelector("div")||r),r.insertBefore(a,r.firstChild))},n.prototype._mousedown=function(e){this._edtColPrev=this._edtCol},n.prototype._click=function(e){this._toggleEditor(e)&&(e.stopPropagation(),e.preventDefault())},n.prototype._toggleEditor=function(t){var i=this;if(!t.defaultPrevented&&0==t.button)if(e.closestClass(t.target,n._WJC_FILTER)){var r=this._g,l=r.hitTest(t.target);if(l.panel||(l=r.hitTest(t)),l.panel==r.columnHeaders||l.panel==r.cells&&-1==l.row){var a=r.getMergedRange(l.panel,l.row,l.col)||new e.grid.CellRange(l.row,l.col),o=r.columns[a.col],s=r._getBindingColumn(l.panel,l.row,o);return this._divEdt&&this._edtCol==s?(this.closeEditor(),r.focus()):s!=this._edtColPrev&&setTimeout((function(){i.editColumnFilter(s,l)}),this._divEdt?100:0),!0}}else this.closeEditor();return!1},n.prototype._keydown=function(t){if(!t.defaultPrevented&&!t.ctrlKey&&t.altKey&&(t.keyCode==e.Key.Down||t.keyCode==e.Key.Up)){var n=this.grid,r=n.selection,l=r.col>-1?n.columns[r.col]:null,a=l?n._getBindingColumn(n.cells,r.row,l):null,o=a&&a.dataMap&&a.dataMapEditor==e.grid.DataMapEditor.DropDownList;if(a&&a.editor instanceof e.input.DropDown&&(o=!0),a&&!o){var s=this.getColumnFilter(a,!1);s&&s.filterType!=i.None&&(this.editColumnFilter(a),t.preventDefault(),t.stopPropagation())}}},n._WJC_FILTER="wj-elem-filter",n}();t.FlexGridFilter=n}((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(t=e.grid||(e.grid={})).filter||(t.filter={})}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i=function(){function i(e){this._c1=new t.FilterCondition(this),this._c2=new t.FilterCondition(this),this._and=!0,this._col=e}return Object.defineProperty(i.prototype,"condition1",{get:function(){return this._c1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"condition2",{get:function(){return this._c2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"and",{get:function(){return this._and},set:function(t){this._and=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataMap",{get:function(){return this._map},set:function(t){this._map=e.asType(t,e.grid.DataMap,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this._c1.isActive||this._c2.isActive},enumerable:!0,configurable:!0}),i.prototype.apply=function(i){var n=this._col,r=this._c1,l=this._c2,a=!1,o=!1;if(!n||!n._binding||!this.isActive)return!0;i=n._binding.getValue(i);var s=this.dataMap||n.dataMap;if(s)i=s.getDisplayValue(i);else if(e.isDate(i)){a=!this._hasTimePart(),o=!this._hasDatePart();var u=t.FilterCondition._refDateTime;a?i=e.DateTime.fromDateTime(i,u):o&&(i=e.DateTime.fromDateTime(u,i))}else if(e.isNumber(i)){var c=e.Globalize,d=n.format,p=c.formatNumber(i,d);i=c.parseFloat(p,d)}var h=r.apply(i,a,o),f=l.apply(i,a,o);return r.isActive&&l.isActive?this._and?h&&f:h||f:r.isActive?h:!l.isActive||f},i.prototype.clear=function(){this._c1.clear(),this._c2.clear(),this.and=!0},i.prototype._hasDatePart=function(){var t=this._col.format;return!t||(t=e.culture.Globalize.calendar.patterns[t]||t,/[yMd]+/.test(t))},i.prototype._hasTimePart=function(){var t=this._col.format;return!!t&&(t=e.culture.Globalize.calendar.patterns[t]||t,/[Hmst]+/.test(t))},i.prototype.implementsInterface=function(e){return"IColumnFilter"==e},i}();t.ConditionFilter=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i=function(i){function n(n,r){var l=i.call(this,n)||this;l._canApply=!1,l.canApplyChanged=new e.Event,l._filter=e.asType(r,t.ConditionFilter,!1);var a=l.getTemplate();l.applyTemplate("wj-control wj-conditionfilter-editor",a,{_divHdr:"div-hdr",_divCmb1:"div-cmb1",_divVal1:"div-val1",_btnAnd:"btn-and",_btnOr:"btn-or",_spAnd:"sp-and",_spOr:"sp-or",_divCmb2:"div-cmb2",_divVal2:"div-val2"});var o=e.culture.FlexGridFilter,s=o.ariaLabels;e.setAriaLabel(l._btnAnd,s.and),e.setAriaLabel(l._btnOr,s.or),e.setText(l._divHdr,o.header),e.setText(l._spAnd,o.and),e.setText(l._spOr,o.or),l._cmb1=l._createOperatorCombo(l._divCmb1,s.op1),l._cmb2=l._createOperatorCombo(l._divCmb2,s.op2),l._val1=l._createValueInput(l._divVal1,s.val1),l._val2=l._createValueInput(l._divVal2,s.val2),l._val1.isDisabled=!0,l._cmb1.selectedIndexChanged.addHandler((function(e,t){l._val1.isDisabled=null==e.selectedValue,l.canApply=!l._val1.isDisabled||!l._val2.isDisabled})),l._val2.isDisabled=!0,l._cmb2.selectedIndexChanged.addHandler((function(e,t){l._val2.isDisabled=null==e.selectedValue,l.canApply=!l._val1.isDisabled||!l._val2.isDisabled}));var u=l.hostElement;return l.addEventListener(u,"change",l._btnAndOrChanged.bind(l)),l.addEventListener(u,"keydown",l._keydown.bind(l)),setTimeout((function(){l.updateEditor()})),l}return __extends(n,i),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canApply",{get:function(){return this._canApply},set:function(e){e!=this._canApply&&(this._canApply=e,this.onCanApplyChanged())},enumerable:!0,configurable:!0}),n.prototype.updateEditor=function(){var t=this._filter.condition1,i=this._filter.condition2;this._cmb1.selectedValue=t.operator,this._cmb2.selectedValue=i.operator,this._val1 instanceof e.input.ComboBox&&!(this._val1 instanceof e.input.InputTime)?(this._val1.text=e.changeType(t.value,e.DataType.String),this._val2.text=e.changeType(i.value,e.DataType.String)):(this._val1.value=t.value,this._val2.value=i.value);var n=this._filter.and;this._checkRadio(this._btnAnd,n),this._checkRadio(this._btnOr,!n)},n.prototype.clearEditor=function(){this._cmb1.selectedValue=this._cmb2.selectedValue=null,this._val1.text=this._val2.text=null,this._checkRadio(this._btnAnd,!0),this._checkRadio(this._btnOr,!1)},Object.defineProperty(n.prototype,"isEditorClear",{get:function(){return null==this._cmb1.selectedValue&&!this._val1.text&&null==this._cmb2.selectedValue&&!this._val2.text},enumerable:!0,configurable:!0}),n.prototype.updateFilter=function(){var e=this._filter.condition1,t=this._filter.condition2;e.operator=this._cmb1.selectedValue,t.operator=this._cmb2.selectedValue,"value"in this._val1?(e.value=this._val1.value,t.value=this._val2.value):(e.value=this._getComboValue(this._val1),t.value=this._getComboValue(this._val2)),this._filter.and=this._btnAnd.checked},n.prototype.onCanApplyChanged=function(e){this.canApplyChanged.raise(this,e)},n.prototype._getComboValue=function(e){return e.selectedIndex>-1?e.selectedValue:e.text},n.prototype._createOperatorCombo=function(t,i){var n=this._filter.column,r=e.culture.FlexGridFilter,l=r.stringOperators,a=e.DataType;this._filter.dataMap||n.dataMap||(n.dataType==a.Date?l=r.dateOperators:n.dataType==a.Number?l=r.numberOperators:n.dataType==a.Boolean&&(l=r.booleanOperators));var o=new e.input.ComboBox(t,{itemsSource:l,displayMemberPath:"name",selectedValuePath:"op"});return e.setAriaLabel(o.inputElement,i),o},n.prototype._createValueInput=function(t,i){var n=this._filter,r=n.column,l=n.dataMap||r.dataMap,a=null,o=e.DataType;return r.dataType==o.Date?(a=n._hasDatePart()?n._hasTimePart()?new e.input.InputDateTime(t):new e.input.InputDate(t):new e.input.InputTime(t)).format=r.format:r.dataType!=o.Number||l?(a=new e.input.ComboBox(t),l?(a.itemsSource=l.getDisplayValues(),a.isEditable=!0,a.caseSensitiveSearch=!!r.grid&&r.grid.caseSensitiveSearch):r.dataType==o.Boolean&&(a.itemsSource=[!0,!1])):(a=new e.input.InputNumber(t)).format=r.format,a.isRequired=!1,e.setAriaLabel(a.inputElement,i),a},n.prototype._btnAndOrChanged=function(e){var t=e.target==this._btnAnd,i=e.target==this._btnOr;(t||i)&&(this._checkRadio(this._btnAnd,t),this._checkRadio(this._btnOr,i))},n.prototype._checkRadio=function(t,i){t.checked=i,e.setAttribute(t,"aria-checked",i.toString()),e.setAttribute(t,"tabindex",i?null:"-1")},n.prototype._keydown=function(t){var i=t.target==this._btnAnd,n=t.target==this._btnOr;if(i||n)switch(t.keyCode){case e.Key.Left:case e.Key.Right:case e.Key.Up:case e.Key.Down:var r=i?this._btnOr:this._btnAnd;r.click(),r.focus(),t.preventDefault()}},n.controlTemplate='<div><div wj-part="div-hdr"></div><div wj-part="div-cmb1"></div><br/><div wj-part="div-val1"></div><br/><div role="radiogroup" style="text-align:center"><label><input wj-part="btn-and" type="radio" role="radio"> <span wj-part="sp-and"></span> </label>&nbsp;&nbsp;&nbsp;<label><input wj-part="btn-or" type="radio" role="radio"> <span wj-part="sp-or"></span> </label></div><div wj-part="div-cmb2"></div><br/><div wj-part="div-val2"></div><br/></div>',n}(e.Control);t.ConditionFilterEditor=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i,n=function(){function t(e){this._op=null,this._filter=e}return Object.defineProperty(t.prototype,"operator",{get:function(){return this._op},set:function(t){this._op=e.asEnum(t,i,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._val},set:function(t){this._val=t,this._strVal=e.isString(t)?this._getCaseString(t):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){switch(this._op){case null:return!1;case i.EQ:case i.NE:return!0;default:return null!=this._val||null!=this._strVal}},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.operator=null,this.value=null},t.prototype.apply=function(n,r,l){var a=this._strVal||this._val;e.isString(n)&&(n=this._getCaseString(n)),e.isString(a)&&null==n&&(n=""),e.isDate(a)&&(r?a=e.DateTime.fromDateTime(a,t._refDateTime):l&&(a=e.DateTime.fromDateTime(t._refDateTime,a)));var o=i;switch(this._op){case null:return!0;case o.EQ:return null!=n&&null!=a?n.valueOf()==a.valueOf():n==a;case o.NE:return null!=n&&null!=a?n.valueOf()!=a.valueOf():n!=a;case o.GT:return n>a;case o.GE:return n>=a;case o.LT:return n<a;case o.LE:return n<=a;case o.BW:return!(null==this._strVal||!e.isString(n))&&0==n.indexOf(this._strVal);case o.EW:return!!(null!=this._strVal&&e.isString(n)&&n.length>=this._strVal.length)&&n.substr(n.length-this._strVal.length)==a;case o.CT:return!(null==this._strVal||!e.isString(n))&&n.indexOf(this._strVal)>-1;case o.NC:return!(null==this._strVal||!e.isString(n))&&n.indexOf(this._strVal)<0}throw"Unknown operator"},t.prototype._getCaseString=function(e){var t=this._filter.column,i=t?t.grid:null;return i&&i.caseSensitiveSearch?e:e.toLowerCase()},t._refDateTime=new Date(2e3,0,1,0,0,0),t}();t.FilterCondition=n,function(e){e[e.EQ=0]="EQ",e[e.NE=1]="NE",e[e.GT=2]="GT",e[e.GE=3]="GE",e[e.LT=4]="LT",e[e.LE=5]="LE",e[e.BW=6]="BW",e[e.EW=7]="EW",e[e.CT=8]="CT",e[e.NC=9]="NC"}(i=t.Operator||(t.Operator={}))})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i=function(){function i(e){this._values=null,this._filterText=null,this._xValueSearch=!0,this._maxValues=250,this._uniqueValues=null,this._sortValues=!0,this._col=e}return Object.defineProperty(i.prototype,"showValues",{get:function(){return this._values},set:function(e){this._values=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filterText",{get:function(){return this._filterText},set:function(t){this._filterText=e.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"exclusiveValueSearch",{get:function(){return this._xValueSearch},set:function(t){this._xValueSearch=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxValues",{get:function(){return this._maxValues},set:function(t){this._maxValues=e.asNumber(t,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniqueValues",{get:function(){return this._uniqueValues},set:function(t){this._uniqueValues=e.asArray(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortValues",{get:function(){return this._sortValues},set:function(t){this._sortValues=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataMap",{get:function(){return this._map},set:function(t){this._map=e.asType(t,e.grid.DataMap,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return null!=this._values&&Object.keys(this._values).length>0},enumerable:!0,configurable:!0}),i.prototype.apply=function(t){var i=this.column;return!(i&&i._binding&&this._values&&Object.keys(this._values).length)||(t=i._binding.getValue(t),t=this.dataMap?this.dataMap.getDisplayValue(t)||"":i.dataMap?i.dataMap.getDisplayValue(t)||"":e.Globalize.format(t,i.format),null!=this._values[t])},i.prototype.clear=function(){this.showValues=null,this.filterText=null},i.prototype.getUniqueValues=function(i){void 0===i&&(i=!0);var n=[],r=this.column,l=e.Globalize.format;if(this.uniqueValues)return this.uniqueValues.forEach((function(e){n.push({value:e,text:l(e,r.format)})})),n;var a={},o=r.collectionView,s=o?o.sourceCollection:[];if(i&&o&&o.sourceCollection&&o.filter)try{t.FlexGridFilter._skipColumn=this._col;for(var u=[],c=0;c<s.length;c++)o.filter(s[c])&&u.push(s[c]);s=u}finally{t.FlexGridFilter._skipColumn=null}for(c=0;c<s.length;c++){var d=r._binding.getValue(s[c]),p=this.dataMap?this.dataMap.getDisplayValue(d)||"":r.dataMap?r.dataMap.getDisplayValue(d)||"":l(d,r.format);a[p]||(a[p]=!0,n.push({value:d,text:p}))}return n},i.prototype.implementsInterface=function(e){return"IColumnFilter"==e},i}();t.ValueFilter=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i=function(i){function n(n,r){var l=i.call(this,n)||this;l._canApply=!1,l.canApplyChanged=new e.Event,l._filter=e.asType(r,t.ValueFilter,!1);var a=l.getTemplate();l.applyTemplate("wj-control wj-valuefilter-editor",a,{_divFilter:"div-filter",_cbSelectAll:"cb-select-all",_spSelectAll:"sp-select-all",_divValues:"div-values"}),l._cbSelectAll.tabIndex=0;var o=e.culture.FlexGridFilter;e.setText(l._spSelectAll,o.selectAll);var s=l._view=new e.collections.CollectionView(null,{sortNulls:e.collections.SortNulls.First,filter:l._filterValues.bind(l)});if(r.sortValues){var u=r.column.dataMap||r.dataMap?"text":"value",c=r.column.dataType!=e.DataType.Boolean;s.sortDescriptions.push(new e.collections.SortDescription(u,c))}return s.collectionChanged.addHandler(l._updateSelectAllCheck,l),l._filterText="",l._rxFilter=null,l._cmbFilter=new e.input.ComboBox(l._divFilter,{isRequired:!1,placeholder:o.search}),l._lbValues=new e.input.ListBox(l._divValues,{displayMemberPath:"text",checkedMemberPath:"show",itemsSource:l._view,itemFormatter:function(e,t){return t||o.null},checkedItemsChanged:function(e){return l._updateSelectAllCheck()}}),e.setAriaLabel(l._cmbFilter.inputElement,o.ariaLabels.search),l._cmbFilter.inputElement.addEventListener("input",l._filterTextChanged.bind(l)),l._cbSelectAll.addEventListener("click",l._cbSelectAllClicked.bind(l)),l.updateEditor(),l._initialItems=l._lbValues.checkedItems,l}return __extends(n,i),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canApply",{get:function(){return this._canApply},set:function(e){e!=this._canApply&&(this._canApply=e,this.onCanApplyChanged())},enumerable:!0,configurable:!0}),n.prototype.updateEditor=function(){var t=this._filter.column,i=this._filter.getUniqueValues(!0);this._lbValues.isContentHtml=t.isContentHtml;var n=this._filter.showValues;if(n&&0!=Object.keys(n).length){for(var r in n)for(var l=0;l<i.length;l++)if(i[l].text==r){i[l].show=!0;break}}else i.forEach((function(e){return e.show=!0}));var a=this._filter.filterText||"",o=this._getCaseSensitive();this._cmbFilter.text=a,this._filterText=o?a:a.toLowerCase(),this._rxFilter=a?new RegExp(e.escapeRegExp(a),o?"":"i"):null;var s=this._view;s.pageSize=this._filter.maxValues,s.sourceCollection=i},n.prototype.clearEditor=function(e){void 0===e&&(e=!0),this._cmbFilter.text="",this._filterText="",this._rxFilter=null;var t=this._view;t.pageSize=0,t.items.forEach((function(t){t.show=e})),t.moveCurrentTo(-1),t.refresh(),t.pageSize=this._filter.maxValues},Object.defineProperty(n.prototype,"isEditorClear",{get:function(){return!this._filterText&&!this._cbSelectAll.indeterminate},enumerable:!0,configurable:!0}),n.prototype.updateFilter=function(){var e=null,t=this._getItems();if(this._filterText||this._cbSelectAll.indeterminate){e={};for(var i=0;i<t.length;i++){var n=t[i];n.show&&(e[n.text]=!0)}}var r=this._filter;r.showValues=e,r.filterText=this._filterText},n.prototype.onCanApplyChanged=function(e){this.canApplyChanged.raise(this,e)},n.prototype._getCaseSensitive=function(){var e=this._filter.column,t=e?e.grid:null;return t&&t.caseSensitiveSearch},n.prototype._getItems=function(){return this._filter.exclusiveValueSearch?this._view.items:this._view.sourceCollection},n.prototype._filterTextChanged=function(){var t=this;this._toFilter&&clearTimeout(this._toFilter),this._toFilter=setTimeout((function(){var i=t._cmbFilter.text,n=t._getCaseSensitive();if(n||(i=i.toLowerCase()),i!=t._filterText){if(t._filterText=i,t._rxFilter=i?new RegExp(e.escapeRegExp(i),n?"":"i"):null,t._view.refresh(),!i){var r=t._initialItems;if(r.length&&t._view.sourceCollection.indexOf(r[0])>-1)return t._lbValues.checkedItems=t._initialItems,void t._updateSelectAllCheck()}t._filter.exclusiveValueSearch?(t._cbSelectAll.checked=!0,t._cbSelectAllClicked()):t._updateSelectAllCheck()}}),e.Control._SEARCH_DELAY)},n.prototype._filterValues=function(e){var t=this._rxFilter;return null==t||null==e||t.test(e.text)},n.prototype._cbSelectAllClicked=function(){for(var e=this._cbSelectAll.checked,t=this._divValues.scrollTop,i=this._getItems(),n=0;n<i.length;n++)i[n].show=e;this._view.refresh(),this._divValues.scrollTop=t},n.prototype._updateSelectAllCheck=function(){for(var t=this._getItems(),i=0,n=0,r=0;r<t.length&&(t[r].show?i++:n++,!i||!n);r++);e.setChecked(this._cbSelectAll,i&&n?null:i>0),this.canApply=i>0},n.controlTemplate='<div><div wj-part="div-filter"></div><div class="wj-listbox-item"><label><input wj-part="cb-select-all" type="checkbox"> <span wj-part="sp-select-all"></span></label></div><div wj-part="div-values"></div></div>',n}(e.Control);t.ValueFilterEditor=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";var i=function(){function i(e,i){this._owner=e,this._col=i,this._valueFilter=new t.ValueFilter(i),this._valueFilter.exclusiveValueSearch=e.exclusiveValueSearch,this._conditionFilter=new t.ConditionFilter(i)}return Object.defineProperty(i.prototype,"filterType",{get:function(){return null!=this._filterType?this._filterType:this._owner.defaultFilterType},set:function(i){if((i=e.asEnum(i,t.FilterType,!0))!=this._filterType){var n=this.isActive;this.clear(),this._filterType=i,n?this._owner.apply():this._col.grid&&this._col.grid.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataMap",{get:function(){return this.conditionFilter.dataMap||this.valueFilter.dataMap},set:function(e){this.conditionFilter.dataMap=e,this.valueFilter.dataMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"valueFilter",{get:function(){return this._valueFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"conditionFilter",{get:function(){return this._conditionFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this._conditionFilter.isActive||this._valueFilter.isActive},enumerable:!0,configurable:!0}),i.prototype.apply=function(e){return this._conditionFilter.apply(e)&&this._valueFilter.apply(e)},i.prototype.clear=function(){this._valueFilter.clear(),this._conditionFilter.clear()},i.prototype.implementsInterface=function(e){return"IColumnFilter"==e},i}();t.ColumnFilter=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(function(t){"use strict";e._addCultureInfo("FlexGridFilter",{ariaLabels:{edit:"Edit Filter for Column",dialog:"Filter Editor for Column",asc:"Sort Column in Ascending Order",dsc:"Sort Column in Descending Order",search:"Search Item List",op1:"First Condition Operator",val1:"First Condition Value",and:"Require both Conditions",or:"Require either Condition",op2:"Second Condition Operator",val2:"Second Condition Value"},ascending:"↑ Ascending",descending:"↓ Descending",apply:"Apply",cancel:"Cancel",clear:"Clear",conditions:"Filter by Condition",values:"Filter by Value",search:"Search",selectAll:"Select All",null:"(nothing)",header:"Show items where the value",and:"And",or:"Or",stringOperators:[{name:"(not set)",op:null},{name:"Equals",op:t.Operator.EQ},{name:"Does not equal",op:t.Operator.NE},{name:"Begins with",op:t.Operator.BW},{name:"Ends with",op:t.Operator.EW},{name:"Contains",op:t.Operator.CT},{name:"Does not contain",op:t.Operator.NC}],numberOperators:[{name:"(not set)",op:null},{name:"Equals",op:t.Operator.EQ},{name:"Does not equal",op:t.Operator.NE},{name:"Is Greater than",op:t.Operator.GT},{name:"Is Greater than or equal to",op:t.Operator.GE},{name:"Is Less than",op:t.Operator.LT},{name:"Is Less than or equal to",op:t.Operator.LE}],dateOperators:[{name:"(not set)",op:null},{name:"Equals",op:t.Operator.EQ},{name:"Is Before",op:t.Operator.LT},{name:"Is After",op:t.Operator.GT}],booleanOperators:[{name:"(not set)",op:null},{name:"Equals",op:t.Operator.EQ},{name:"Does not equal",op:t.Operator.NE}]});var i=function(i){function n(n,r,l){void 0===l&&(l=!0);var a=i.call(this,n,null,!0)||this;a.filterChanged=new e.Event,a.buttonClicked=new e.Event,a._filter=e.asType(r,t.ColumnFilter);var o=a.getTemplate();a.applyTemplate("wj-control wj-content wj-columnfiltereditor",o,{_divSort:"div-sort",_btnAsc:"btn-asc",_btnDsc:"btn-dsc",_divType:"div-type",_aVal:"a-val",_aCnd:"a-cnd",_divEdtVal:"div-edt-val",_divEdtCnd:"div-edt-cnd",_btnApply:"btn-apply",_btnCancel:"btn-cancel",_btnClear:"btn-clear"});var s=e.culture.FlexGridFilter,u=s.ariaLabels,c=a.hostElement,d=a.filter.column,p=d.grid.collectionView;e.setAttribute(c,"role","dialog"),e.setAriaLabel(c,u.dialog+" "+d.header),e.setAriaLabel(a._btnAsc,u.asc),e.setAriaLabel(a._btnDsc,u.dsc),e.setText(a._btnAsc,s.ascending),e.setText(a._btnDsc,s.descending),e.setText(a._aVal,s.values),e.setText(a._aCnd,s.conditions),e.setText(a._btnApply,s.apply),e.setText(a._btnCancel,s.cancel),e.setText(a._btnClear,s.clear);var h=a.filter.conditionFilter.isActive||0==(r.filterType&t.FilterType.Value)?t.FilterType.Condition:t.FilterType.Value;a._showFilter(h),l&&p&&p.canSort||(a._divSort.style.display="none"),a._updateSortButtonState();var f=a._btnClicked.bind(a),_="click";return a._btnApply.addEventListener(_,f),a._btnCancel.addEventListener(_,f),a._btnClear.addEventListener(_,f),a._btnAsc.addEventListener(_,f),a._btnDsc.addEventListener(_,f),a._aVal.addEventListener(_,f),a._aCnd.addEventListener(_,f),a.addEventListener(c,"keydown",(function(t){if(!t.defaultPrevented){var i=t.target.tagName.match(/^(a|button)$/i);switch(t.keyCode){case e.Key.Space:i&&(a._btnClicked(t),t.preventDefault());break;case e.Key.Enter:i?a._btnClicked(t):(a.updateFilter(),a.onFilterChanged(),a.onButtonClicked()),t.preventDefault();break;case e.Key.Escape:a.onButtonClicked(),t.preventDefault();break;case e.Key.Tab:e.moveFocus(a.hostElement,t.shiftKey?-1:1),t.preventDefault()}}})),a.addEventListener(window,"resize",(function(){a.isTouching||a._wasTouching||a.onButtonClicked()})),a}return __extends(n,i),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),n.prototype.updateEditor=function(){this._edtVal&&this._edtVal.updateEditor(),this._edtCnd&&this._edtCnd.updateEditor()},n.prototype.updateFilter=function(){switch(this._getFilterType()){case t.FilterType.Value:this._edtVal.updateFilter(),this.filter.conditionFilter.clear();break;case t.FilterType.Condition:this._edtCnd.updateFilter(),this.filter.valueFilter.clear()}},n.prototype.onFilterChanged=function(e){this.filterChanged.raise(this,e)},n.prototype.onButtonClicked=function(e){this.buttonClicked.raise(this,e)},n.prototype._showFilter=function(i){var n=this;this._wasTouching=this.isTouching,i==t.FilterType.Value&&null==this._edtVal&&(this._edtVal=new t.ValueFilterEditor(this._divEdtVal,this.filter.valueFilter),this._edtVal.canApplyChanged.addHandler((function(t){e.enable(n._btnApply,n._edtVal.canApply)}))),i==t.FilterType.Condition&&null==this._edtCnd&&(this._edtCnd=new t.ConditionFilterEditor(this._divEdtCnd,this.filter.conditionFilter),this._edtCnd.canApplyChanged.addHandler((function(t){e.enable(n._btnApply,n._edtCnd.canApply)}))),0!=(i&this.filter.filterType)&&(i==t.FilterType.Value?(this._divEdtVal.style.display="",this._divEdtCnd.style.display="none",this._enableLink(this._aVal,!1),this._enableLink(this._aCnd,!0),this._edtVal.focus(),e.enable(this._btnApply,this._edtVal.canApply)):(this._divEdtVal.style.display="none",this._divEdtCnd.style.display="",this._enableLink(this._aVal,!0),this._enableLink(this._aCnd,!1),this._edtCnd.focus(),e.enable(this._btnApply,this._edtCnd.canApply)));var r=this._divType.style;switch(this.filter.filterType){case t.FilterType.None:case t.FilterType.Condition:case t.FilterType.Value:r.display="none";break;default:r.display=""}},n.prototype._enableLink=function(t,i){e.toggleClass(t,"wj-state-disabled",!i),e.setAttribute(t,"href",i?"":null),e.setAttribute(t,"disabled",i?null:"disabled")},n.prototype._updateSortButtonState=function(){var t=this.filter.column,i=t?t.currentSort:"",n="wj-state-active";e.toggleClass(this._btnAsc,n,"+"==i),e.toggleClass(this._btnDsc,n,"-"==i)},n.prototype._getFilterType=function(){var e=t.FilterType;return"none"!=this._divEdtVal.style.display?e.Value:e.Condition},n.prototype._btnClicked=function(i){var n=this,r=i.target;if(i.preventDefault(),i.stopPropagation(),!e.hasClass(r,"wj-state-disabled")){if(r==this._aVal)return this._showFilter(t.FilterType.Value),void e.moveFocus(this._edtVal.hostElement,0);if(r==this._aCnd)return this._showFilter(t.FilterType.Condition),void e.moveFocus(this._edtCnd.hostElement,0);if(r==this._btnAsc||r==this._btnDsc){var l=this.filter.column,a=l.sortMemberPath||l.binding,o=l.grid.collectionView.sortDescriptions;o.deferUpdate((function(){o.clear(),o.push(new e.collections.SortDescription(a,i.target==n._btnAsc))})),this._updateSortButtonState()}r==this._btnApply?(this.updateFilter(),this.onFilterChanged()):r==this._btnClear?this.filter.isActive&&(this.filter.clear(),this.onFilterChanged()):this.updateEditor(),this.onButtonClicked()}},n.controlTemplate='<div><div wj-part="div-sort" class="wj-sort-buttons"><button wj-part="btn-asc" class="wj-btn"></button>&nbsp;&nbsp;&nbsp;<button wj-part="btn-dsc" class="wj-btn"></button></div><div wj-part="div-type" class="wj-filtertype"><a wj-part="a-cnd" href="" draggable="false"></a>&nbsp;|&nbsp;<a wj-part="a-val" href="" draggable="false"></a></div><div wj-part="div-edt-val" tabindex="-1"></div><div wj-part="div-edt-cnd" tabindex="-1"></div><div style="text-align:right;margin-top:10px"><button wj-part="btn-apply" class="wj-btn"></button>&nbsp;&nbsp;<button wj-part="btn-cancel" class="wj-btn"></button>&nbsp;&nbsp;<button wj-part="btn-clear" class="wj-btn"></button></div></div>',n}(e.Control);t.ColumnFilterEditor=i})((t=e.grid||(e.grid={})).filter||(t.filter={}))}(wijmo||(wijmo={})),function(e){var t;(t=e.grid||(e.grid={})).filter||(t.filter={}),e._registerModule("wijmo.grid.filter",e.grid.filter)}(wijmo||(wijmo={}));