import{__assign,__decorate,__extends,__rest}from"tslib";import*as React from"react";import{polyfill}from"react-lifecycles-compat";import{DISPLAYNAME_PREFIX}from"../../common/props";var AsyncControllableInput=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasPendingUpdate:!1,isComposing:!1,nextValue:t.props.value,value:t.props.value},t.handleCompositionStart=function(e){var n,a;t.setState({isComposing:!0,nextValue:t.state.value}),null===(a=(n=t.props).onCompositionStart)||void 0===a||a.call(n,e)},t.handleCompositionEnd=function(e){var n,a;t.setState({isComposing:!1}),null===(a=(n=t.props).onCompositionEnd)||void 0===a||a.call(n,e)},t.handleChange=function(e){var n,a,o=e.target.value;t.setState({nextValue:o}),null===(a=(n=t.props).onChange)||void 0===a||a.call(n,e)},t}return __extends(t,e),t.getDerivedStateFromProps=function(e,t){return t.isComposing||void 0===e.value?null:t.nextValue!==t.value?e.value===t.nextValue?t.hasPendingUpdate?{value:e.value,hasPendingUpdate:!1}:{value:t.nextValue}:e.value===t.value?{hasPendingUpdate:!0}:{value:e.value,nextValue:e.value,hasPendingUpdate:!1}:{value:e.value,nextValue:e.value,hasPendingUpdate:!1}},t.prototype.render=function(){var e=this.state,t=e.isComposing,n=e.hasPendingUpdate,a=e.value,o=e.nextValue,l=this.props,i=l.inputRef,s=__rest(l,["inputRef"]);return React.createElement("input",__assign({},s,{ref:i,value:t||n?o:a,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onChange:this.handleChange}))},t.displayName=DISPLAYNAME_PREFIX+".AsyncControllableInput",__decorate([polyfill],t)}(React.PureComponent);export{AsyncControllableInput};