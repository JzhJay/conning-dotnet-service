import{__extends}from"tslib";import*as React from"react";import*as ReactDOM from"react-dom";import*as Classes from"../../common/classes";import*as Errors from"../../common/errors";import{DISPLAYNAME_PREFIX}from"../../common/props";import{isFunction}from"../../common/utils";var cannotCreatePortal=!isFunction(ReactDOM.createPortal),REACT_CONTEXT_TYPES={blueprintPortalClassName:function(t,e){if(null!=t[e]&&"string"!=typeof t[e])return new Error(Errors.PORTAL_CONTEXT_CLASS_NAME_STRING)}},Portal=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context={},e.state={hasMounted:!1},e.portalElement=null,e}return __extends(e,t),e.prototype.render=function(){return cannotCreatePortal||"undefined"==typeof document||!this.state.hasMounted||null===this.portalElement?null:ReactDOM.createPortal(this.props.children,this.portalElement)},e.prototype.componentDidMount=function(){this.props.container&&(this.portalElement=this.createContainerElement(),this.props.container.appendChild(this.portalElement),this.setState({hasMounted:!0},this.props.onChildrenMount),cannotCreatePortal&&this.unstableRenderNoPortal())},e.prototype.componentDidUpdate=function(t){null!=this.portalElement&&t.className!==this.props.className&&(maybeRemoveClass(this.portalElement.classList,t.className),maybeAddClass(this.portalElement.classList,this.props.className)),cannotCreatePortal&&this.unstableRenderNoPortal()},e.prototype.componentWillUnmount=function(){null!=this.portalElement&&(cannotCreatePortal&&ReactDOM.unmountComponentAtNode(this.portalElement),this.portalElement.remove())},e.prototype.createContainerElement=function(){var t=document.createElement("div");return t.classList.add(Classes.PORTAL),maybeAddClass(t.classList,this.props.className),null!=this.context&&maybeAddClass(t.classList,this.context.blueprintPortalClassName),t},e.prototype.unstableRenderNoPortal=function(){null!==this.portalElement&&ReactDOM.unstable_renderSubtreeIntoContainer(this,React.createElement("div",null,this.props.children),this.portalElement)},e.displayName=DISPLAYNAME_PREFIX+".Portal",e.contextTypes=REACT_CONTEXT_TYPES,e.defaultProps={container:"undefined"!=typeof document?document.body:void 0},e}(React.Component);export{Portal};function maybeRemoveClass(t,e){null!=e&&""!==e&&t.remove.apply(t,e.split(" "))}function maybeAddClass(t,e){null!=e&&""!==e&&t.add.apply(t,e.split(" "))}