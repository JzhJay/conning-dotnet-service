"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverlayToaster=exports.Toaster=void 0;var tslib_1=require("tslib"),classnames_1=tslib_1.__importDefault(require("classnames")),React=tslib_1.__importStar(require("react")),ReactDOM=tslib_1.__importStar(require("react-dom")),react_lifecycles_compat_1=require("react-lifecycles-compat"),common_1=require("../../common"),errors_1=require("../../common/errors"),keys_1=require("../../common/keys"),props_1=require("../../common/props"),utils_1=require("../../common/utils"),overlay_1=require("../overlay/overlay"),toast_1=require("./toast"),Toaster=function(t){function s(){var s=null!==t&&t.apply(this,arguments)||this;return s.state={toasts:[]},s.toastId=0,s.renderToast=function(t){return React.createElement(toast_1.Toast,tslib_1.__assign({},t,{onDismiss:s.getDismissHandler(t)}))},s.getDismissHandler=function(t){return function(e){s.dismiss(t.key,e)}},s.handleClose=function(t){t.which===keys_1.ESCAPE&&s.clear()},s}var e;return tslib_1.__extends(s,t),e=s,s.create=function(t,s){void 0===s&&(s=document.body),null==t||null==t.usePortal||utils_1.isNodeEnv("production")||console.warn(errors_1.TOASTER_WARN_INLINE);var o=document.createElement("div");s.appendChild(o);var r=ReactDOM.render(React.createElement(e,tslib_1.__assign({},t,{usePortal:!1})),o);if(null==r)throw new Error(errors_1.TOASTER_CREATE_NULL);return r},s.prototype.show=function(t,s){this.props.maxToasts&&this.dismissIfAtLimit();var e=this.createToastOptions(t,s);return void 0===s||this.isNewToastKey(s)?this.setState((function(t){return{toasts:tslib_1.__spreadArrays([e],t.toasts)}})):this.setState((function(t){return{toasts:t.toasts.map((function(t){return t.key===s?e:t}))}})),e.key},s.prototype.dismiss=function(t,s){void 0===s&&(s=!1),this.setState((function(e){return{toasts:e.toasts.filter((function(e){var o,r=e.key===t;return r&&(null===(o=e.onDismiss)||void 0===o||o.call(e,s)),!r}))}}))},s.prototype.clear=function(){this.state.toasts.forEach((function(t){var s;return null===(s=t.onDismiss)||void 0===s?void 0:s.call(t,!1)})),this.setState({toasts:[]})},s.prototype.getToasts=function(){return this.state.toasts},s.prototype.render=function(){var t=classnames_1.default(common_1.Classes.TOAST_CONTAINER,this.getPositionClasses(),this.props.className);return React.createElement(overlay_1.Overlay,{autoFocus:this.props.autoFocus,canEscapeKeyClose:this.props.canEscapeKeyClear,canOutsideClickClose:!1,className:t,enforceFocus:!1,hasBackdrop:!1,isOpen:this.state.toasts.length>0||null!=this.props.children,onClose:this.handleClose,shouldReturnFocusOnClose:!1,transitionDuration:350,transitionName:common_1.Classes.TOAST,usePortal:this.props.usePortal},this.state.toasts.map(this.renderToast,this),this.props.children)},s.prototype.validateProps=function(t){var s=t.maxToasts;if(void 0!==s&&s<1)throw new Error(errors_1.TOASTER_MAX_TOASTS_INVALID)},s.prototype.isNewToastKey=function(t){return this.state.toasts.every((function(s){return s.key!==t}))},s.prototype.dismissIfAtLimit=function(){this.state.toasts.length===this.props.maxToasts&&this.dismiss(this.state.toasts[this.state.toasts.length-1].key)},s.prototype.createToastOptions=function(t,s){return void 0===s&&(s="toast-"+this.toastId++),tslib_1.__assign(tslib_1.__assign({},t),{key:s})},s.prototype.getPositionClasses=function(){var t=this.props.position.split("-");return tslib_1.__spreadArrays(t.map((function(t){return common_1.Classes.TOAST_CONTAINER+"-"+t.toLowerCase()})),[common_1.Classes.TOAST_CONTAINER+"-"+(this.props.usePortal?"in-portal":"inline")])},s.displayName=props_1.DISPLAYNAME_PREFIX+".Toaster",s.defaultProps={autoFocus:!1,canEscapeKeyClear:!0,position:common_1.Position.TOP,usePortal:!0},e=tslib_1.__decorate([react_lifecycles_compat_1.polyfill],s)}(common_1.AbstractPureComponent2);exports.Toaster=Toaster,exports.OverlayToaster=Toaster;