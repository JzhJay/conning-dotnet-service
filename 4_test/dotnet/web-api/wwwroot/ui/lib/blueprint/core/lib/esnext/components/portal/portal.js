import*as React from"react";import*as ReactDOM from"react-dom";import*as Classes from"../../common/classes";import*as Errors from"../../common/errors";import{DISPLAYNAME_PREFIX}from"../../common/props";import{isFunction}from"../../common/utils";const cannotCreatePortal=!isFunction(ReactDOM.createPortal),REACT_CONTEXT_TYPES={blueprintPortalClassName:(t,e)=>{if(null!=t[e]&&"string"!=typeof t[e])return new Error(Errors.PORTAL_CONTEXT_CLASS_NAME_STRING)}};export class Portal extends React.Component{constructor(){super(...arguments),this.context={},this.state={hasMounted:!1},this.portalElement=null}render(){return cannotCreatePortal||"undefined"==typeof document||!this.state.hasMounted||null===this.portalElement?null:ReactDOM.createPortal(this.props.children,this.portalElement)}componentDidMount(){this.props.container&&(this.portalElement=this.createContainerElement(),this.props.container.appendChild(this.portalElement),this.setState({hasMounted:!0},this.props.onChildrenMount),cannotCreatePortal&&this.unstableRenderNoPortal())}componentDidUpdate(t){null!=this.portalElement&&t.className!==this.props.className&&(maybeRemoveClass(this.portalElement.classList,t.className),maybeAddClass(this.portalElement.classList,this.props.className)),cannotCreatePortal&&this.unstableRenderNoPortal()}componentWillUnmount(){null!=this.portalElement&&(cannotCreatePortal&&ReactDOM.unmountComponentAtNode(this.portalElement),this.portalElement.remove())}createContainerElement(){const t=document.createElement("div");return t.classList.add(Classes.PORTAL),maybeAddClass(t.classList,this.props.className),null!=this.context&&maybeAddClass(t.classList,this.context.blueprintPortalClassName),t}unstableRenderNoPortal(){null!==this.portalElement&&ReactDOM.unstable_renderSubtreeIntoContainer(this,React.createElement("div",null,this.props.children),this.portalElement)}}function maybeRemoveClass(t,e){null!=e&&""!==e&&t.remove(...e.split(" "))}function maybeAddClass(t,e){null!=e&&""!==e&&t.add(...e.split(" "))}Portal.displayName=`${DISPLAYNAME_PREFIX}.Portal`,Portal.contextTypes=REACT_CONTEXT_TYPES,Portal.defaultProps={container:"undefined"!=typeof document?document.body:void 0};