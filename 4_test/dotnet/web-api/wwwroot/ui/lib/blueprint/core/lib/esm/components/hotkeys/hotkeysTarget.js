import{__extends}from"tslib";import*as React from"react";import{HOTKEYS_WARN_DECORATOR_NEEDS_REACT_ELEMENT,HOTKEYS_WARN_DECORATOR_NO_METHOD}from"../../common/errors";import{getDisplayName,isFunction}from"../../common/utils";import{HotkeyScope,HotkeysEvents}from"./hotkeysEvents";export function HotkeysTarget(e){var t;return isFunction(e.prototype.renderHotkeys)||console.warn(HOTKEYS_WARN_DECORATOR_NO_METHOD),t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.globalHotkeysEvents=new HotkeysEvents(HotkeyScope.GLOBAL),t.localHotkeysEvents=new HotkeysEvents(HotkeyScope.LOCAL),t}return __extends(t,e),t.prototype.componentDidMount=function(){null!=e.prototype.componentDidMount&&e.prototype.componentDidMount.call(this),document.addEventListener("keydown",this.globalHotkeysEvents.handleKeyDown),document.addEventListener("keyup",this.globalHotkeysEvents.handleKeyUp)},t.prototype.componentWillUnmount=function(){var t;null===(t=e.prototype.componentWillUnmount)||void 0===t||t.call(this),document.removeEventListener("keydown",this.globalHotkeysEvents.handleKeyDown),document.removeEventListener("keyup",this.globalHotkeysEvents.handleKeyUp),this.globalHotkeysEvents.clear(),this.localHotkeysEvents.clear()},t.prototype.render=function(){var t=this,o=e.prototype.render.call(this);if(null==o)return o;if(!React.isValidElement(o))return console.warn(HOTKEYS_WARN_DECORATOR_NEEDS_REACT_ELEMENT),o;if(isFunction(this.renderHotkeys)){var n=this.renderHotkeys();if(this.localHotkeysEvents&&this.localHotkeysEvents.setHotkeys(n.props),this.globalHotkeysEvents&&this.globalHotkeysEvents.setHotkeys(n.props),this.localHotkeysEvents.count()>0){var s=void 0===n.props.tabIndex?0:n.props.tabIndex,l=o.props,r=l.onKeyDown,i=l.onKeyUp;return React.cloneElement(o,{onKeyDown:function(e){t.localHotkeysEvents.handleKeyDown(e.nativeEvent),null==r||r(e)},onKeyUp:function(e){t.localHotkeysEvents.handleKeyUp(e.nativeEvent),null==i||i(e)},tabIndex:s})}}return o},t}(e),t.displayName="HotkeysTarget("+getDisplayName(e)+")",t}