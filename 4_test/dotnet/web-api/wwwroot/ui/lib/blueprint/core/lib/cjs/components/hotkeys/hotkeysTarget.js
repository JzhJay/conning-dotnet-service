"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HotkeysTarget=void 0;var tslib_1=require("tslib"),React=tslib_1.__importStar(require("react")),errors_1=require("../../common/errors"),utils_1=require("../../common/utils"),hotkeysEvents_1=require("./hotkeysEvents");function HotkeysTarget(e){var t;return utils_1.isFunction(e.prototype.renderHotkeys)||console.warn(errors_1.HOTKEYS_WARN_DECORATOR_NO_METHOD),t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.globalHotkeysEvents=new hotkeysEvents_1.HotkeysEvents(hotkeysEvents_1.HotkeyScope.GLOBAL),t.localHotkeysEvents=new hotkeysEvents_1.HotkeysEvents(hotkeysEvents_1.HotkeyScope.LOCAL),t}return tslib_1.__extends(t,e),t.prototype.componentDidMount=function(){null!=e.prototype.componentDidMount&&e.prototype.componentDidMount.call(this),document.addEventListener("keydown",this.globalHotkeysEvents.handleKeyDown),document.addEventListener("keyup",this.globalHotkeysEvents.handleKeyUp)},t.prototype.componentWillUnmount=function(){var t;null===(t=e.prototype.componentWillUnmount)||void 0===t||t.call(this),document.removeEventListener("keydown",this.globalHotkeysEvents.handleKeyDown),document.removeEventListener("keyup",this.globalHotkeysEvents.handleKeyUp),this.globalHotkeysEvents.clear(),this.localHotkeysEvents.clear()},t.prototype.render=function(){var t=this,o=e.prototype.render.call(this);if(null==o)return o;if(!React.isValidElement(o))return console.warn(errors_1.HOTKEYS_WARN_DECORATOR_NEEDS_REACT_ELEMENT),o;if(utils_1.isFunction(this.renderHotkeys)){var n=this.renderHotkeys();if(this.localHotkeysEvents&&this.localHotkeysEvents.setHotkeys(n.props),this.globalHotkeysEvents&&this.globalHotkeysEvents.setHotkeys(n.props),this.localHotkeysEvents.count()>0){var s=void 0===n.props.tabIndex?0:n.props.tabIndex,r=o.props,l=r.onKeyDown,i=r.onKeyUp;return React.cloneElement(o,{onKeyDown:function(e){t.localHotkeysEvents.handleKeyDown(e.nativeEvent),null==l||l(e)},onKeyUp:function(e){t.localHotkeysEvents.handleKeyUp(e.nativeEvent),null==i||i(e)},tabIndex:s})}}return o},t}(e),t.displayName="HotkeysTarget("+utils_1.getDisplayName(e)+")",t}exports.HotkeysTarget=HotkeysTarget;