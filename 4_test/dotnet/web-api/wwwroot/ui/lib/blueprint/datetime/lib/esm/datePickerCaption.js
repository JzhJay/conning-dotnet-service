import{__decorate,__extends}from"tslib";import*as React from"react";import{polyfill}from"react-lifecycles-compat";import{AbstractPureComponent2,Divider,HTMLSelect,IconSize}from"@blueprintjs/core";import*as Classes from"./common/classes";import{clone}from"./common/dateUtils";import{measureTextWidth}from"./common/utils";var DatePickerCaption=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={monthRightOffset:0},t.handleMonthSelectChange=t.dateChangeHandler((function(e,t){return e.setMonth(t)}),t.props.onMonthChange),t.handleYearSelectChange=t.dateChangeHandler((function(e,t){return e.setFullYear(t)}),t.props.onYearChange),t}return __extends(t,e),t.prototype.render=function(){for(var e=this,t=this.props,n=t.date,a=t.locale,o=t.localeUtils,r=t.minDate,i=t.maxDate,s=t.months,l=void 0===s?o.getMonths(a):s,c=r.getFullYear(),h=i.getFullYear(),p=n.getMonth(),m=n.getFullYear(),u=m===c?r.getMonth():0,d=m===h?i.getMonth()+1:void 0,f=l.map((function(e,t){return{label:e,value:t}})).slice(u,d),C=[c],E=c+1;E<=h;++E)C.push(E);m>h&&C.push({value:m,disabled:!0}),this.displayedMonthText=l[p];var g=React.createElement(HTMLSelect,{iconProps:{style:{right:this.state.monthRightOffset}},className:Classes.DATEPICKER_MONTH_SELECT,key:"month",minimal:!0,onChange:this.handleMonthSelectChange,value:p,options:f}),v=React.createElement(HTMLSelect,{className:Classes.DATEPICKER_YEAR_SELECT,key:"year",minimal:!0,onChange:this.handleYearSelectChange,value:m,options:C}),M=this.props.reverseMonthAndYearMenus?[v,g]:[g,v];return React.createElement("div",{className:this.props.classNames.caption},React.createElement("div",{className:Classes.DATEPICKER_CAPTION,ref:function(t){return e.containerElement=t}},M),React.createElement(Divider,null))},t.prototype.componentDidMount=function(){var e=this;this.requestAnimationFrame((function(){return e.positionArrows()}))},t.prototype.componentDidUpdate=function(){this.positionArrows()},t.prototype.positionArrows=function(){var e=measureTextWidth(this.displayedMonthText,Classes.DATEPICKER_CAPTION_MEASURE,this.containerElement),t=null==this.containerElement?0:this.containerElement.firstElementChild.clientWidth,n=Math.max(2,t-e-IconSize.STANDARD-2);this.setState({monthRightOffset:n})},t.prototype.dateChangeHandler=function(e,t){var n=this;return function(a){var o,r,i=parseInt(a.target.value,10);if(!isNaN(i)){var s=clone(n.props.date);e(s,i),null===(r=(o=n.props).onDateChange)||void 0===r||r.call(o,s),null==t||t(i)}}},__decorate([polyfill],t)}(AbstractPureComponent2);export{DatePickerCaption};