import{__assign,__extends,__rest}from"tslib";import classNames from"classnames";import*as React from"react";import{AbstractComponent2,DISPLAYNAME_PREFIX,HotkeysTarget2,Utils as CoreUtils}from"@blueprintjs/core";import{Column}from"./column";import*as Classes from"./common/classes";import{columnInteractionBarContextTypes}from"./common/context";import*as Errors from"./common/errors";import{Grid}from"./common/grid";import*as FocusedCellUtils from"./common/internal/focusedCellUtils";import*as ScrollUtils from"./common/internal/scrollUtils";import{Rect}from"./common/rect";import{RenderMode}from"./common/renderMode";import{Utils}from"./common/utils";import{ColumnHeader}from"./headers/columnHeader";import{ColumnHeaderCell}from"./headers/columnHeaderCell";import{renderDefaultRowHeader,RowHeader}from"./headers/rowHeader";import{ResizeSensor}from"./interactions/resizeSensor";import{GuideLayer}from"./layers/guides";import{RegionLayer}from"./layers/regions";import{Locator}from"./locator";import{QuadrantType}from"./quadrants/tableQuadrant";import{TableQuadrantStack}from"./quadrants/tableQuadrantStack";import{ColumnLoadingOption,RegionCardinality,Regions,SelectionModes,TableLoadingOption}from"./regions";import{resizeRowsByApproximateHeight,resizeRowsByTallestCell}from"./resizeRows";import{getHotkeysFromProps,isSelectionModeEnabled}from"./table2Utils";import{TableBody}from"./tableBody";import{TableHotkeys}from"./tableHotkeys";import{clampNumFrozenColumns,clampNumFrozenRows,hasLoadingOption}from"./tableUtils";var Table2=function(e){function o(t,n){var r=e.call(this,t,n)||this;r.hotkeys=[],r.refHandlers={cellContainer:function(e){return r.cellContainerElement=e},columnHeader:function(e){return r.columnHeaderElement=e},quadrantStack:function(e){return r.quadrantStackInstance=e},rootTable:function(e){return r.rootTableElement=e},rowHeader:function(e){return r.rowHeaderElement=e},scrollContainer:function(e){return r.scrollContainerElement=e}},r.didCompletelyMount=!1,r.renderTableContents=function(e){var o,t=e.handleKeyDown,n=e.handleKeyUp,l=r.props,i=l.children,s=l.className,a=l.enableRowHeader,d=l.loadingOptions,c=l.numRows,u=l.enableColumnInteractionBar,m=r.state,p=m.horizontalGuides,R=m.numFrozenColumnsClamped,h=m.numFrozenRowsClamped,g=m.verticalGuides;r.gridDimensionsMatchProps()||r.invalidateGrid(),r.validateGrid();var C=classNames(Classes.TABLE_CONTAINER,((o={})[Classes.TABLE_REORDERING]=r.state.isReordering,o[Classes.TABLE_NO_VERTICAL_SCROLL]=r.shouldDisableVerticalScroll(),o[Classes.TABLE_NO_HORIZONTAL_SCROLL]=r.shouldDisableHorizontalScroll(),o[Classes.TABLE_SELECTION_ENABLED]=isSelectionModeEnabled(r.props,RegionCardinality.CELLS),o[Classes.TABLE_NO_ROWS]=0===c,o),s);return React.createElement("div",{className:C,ref:r.refHandlers.rootTable,onScroll:r.handleRootScroll,onKeyDown:t,onKeyUp:n,tabIndex:0},React.createElement(TableQuadrantStack,{bodyRef:r.refHandlers.cellContainer,bodyRenderer:r.renderBody,columnHeaderCellRenderer:r.renderColumnHeader,columnHeaderRef:r.refHandlers.columnHeader,enableColumnInteractionBar:u,enableRowHeader:a,grid:r.grid,handleColumnResizeGuide:r.handleColumnResizeGuide,handleColumnsReordering:r.handleColumnsReordering,handleRowResizeGuide:r.handleRowResizeGuide,handleRowsReordering:r.handleRowsReordering,isHorizontalScrollDisabled:r.shouldDisableHorizontalScroll(),isVerticalScrollDisabled:r.shouldDisableVerticalScroll(),loadingOptions:d,numColumns:React.Children.count(i),numFrozenColumns:R,numFrozenRows:h,numRows:c,onScroll:r.handleBodyScroll,ref:r.refHandlers.quadrantStack,menuRenderer:r.renderMenu,rowHeaderCellRenderer:r.renderRowHeader,rowHeaderRef:r.refHandlers.rowHeader,scrollContainerRef:r.refHandlers.scrollContainer}),React.createElement("div",{className:classNames(Classes.TABLE_OVERLAY_LAYER,Classes.TABLE_OVERLAY_REORDERING_CURSOR)}),React.createElement(GuideLayer,{className:Classes.TABLE_RESIZE_GUIDES,verticalGuides:g,horizontalGuides:p}))},r.renderMenu=function(e){var o,t=classNames(Classes.TABLE_MENU,((o={})[Classes.TABLE_SELECTION_ENABLED]=isSelectionModeEnabled(r.props,RegionCardinality.FULL_TABLE),o));return React.createElement("div",{className:t,ref:e,onMouseDown:r.handleMenuMouseDown},r.maybeRenderRegions(r.styleMenuRegion))},r.handleMenuMouseDown=function(e){r.selectAll(!e.shiftKey)},r.selectAll=function(e){if(r.getEnabledSelectionHandler(RegionCardinality.FULL_TABLE)([Regions.table()]),e){var o=Regions.getFocusCellCoordinatesFromRegion(Regions.table());r.handleFocus(FocusedCellUtils.toFullCoordinates(o))}},r.columnHeaderCellRenderer=function(e){var o=r.getColumnProps(e);if(void 0===o)return null;o.id;var t=o.loadingOptions,n=(o.cellRenderer,o.columnHeaderCellRenderer),l=__rest(o,["id","loadingOptions","cellRenderer","columnHeaderCellRenderer"]),i=hasLoadingOption(t,ColumnLoadingOption.HEADER);if(null!=n){var s=n(e),a=s.props.loading,d={loading:null!=a?a:i};return React.cloneElement(s,d)}var c=__assign({index:e,loading:i},l);return null!=o.name?React.createElement(ColumnHeaderCell,__assign({},c)):React.createElement(ColumnHeaderCell,__assign({},c,{name:Utils.toBase26Alpha(e)}))},r.renderColumnHeader=function(e,o,t,n){var l;void 0===n&&(n=!1);var i=r.state,s=i.focusedCell,a=i.selectedRegions,d=i.viewportRect,c=r.props,u=c.enableMultipleSelection,m=c.enableGhostCells,p=c.enableColumnReordering,R=c.enableColumnResizing,h=c.loadingOptions,g=c.maxColumnWidth,C=c.minColumnWidth,f=c.selectedRegionTransform,E=classNames(Classes.TABLE_COLUMN_HEADERS,((l={})[Classes.TABLE_SELECTION_ENABLED]=isSelectionModeEnabled(r.props,RegionCardinality.FULL_COLUMNS),l)),S=r.grid.getColumnIndicesInRect(d,m),w=n?0:S.columnIndexStart,L=n?r.getMaxFrozenColumnIndex():S.columnIndexEnd;return React.createElement("div",{className:E},React.createElement(ColumnHeader,{enableMultipleSelection:u,cellRenderer:r.columnHeaderCellRenderer,focusedCell:s,grid:r.grid,isReorderable:p,isResizable:R,loading:hasLoadingOption(h,TableLoadingOption.COLUMN_HEADERS),locator:r.locator,maxColumnWidth:g,measurableElementRef:e,minColumnWidth:C,onColumnWidthChanged:r.handleColumnWidthChanged,onFocusedCell:r.handleFocus,onLayoutLock:r.handleLayoutLock,onReordered:r.handleColumnsReordered,onReordering:t,onResizeGuide:o,onSelection:r.getEnabledSelectionHandler(RegionCardinality.FULL_COLUMNS),selectedRegions:a,selectedRegionTransform:f,columnIndexStart:w,columnIndexEnd:L},r.props.children),r.maybeRenderRegions(r.styleColumnHeaderRegion))},r.renderRowHeader=function(e,o,t,n){var l;void 0===n&&(n=!1);var i=r.state,s=i.focusedCell,a=i.selectedRegions,d=i.viewportRect,c=r.props,u=c.enableMultipleSelection,m=c.enableGhostCells,p=c.enableRowReordering,R=c.enableRowResizing,h=c.loadingOptions,g=c.maxRowHeight,C=c.minRowHeight,f=c.rowHeaderCellRenderer,E=c.selectedRegionTransform,S=classNames(Classes.TABLE_ROW_HEADERS,((l={})[Classes.TABLE_SELECTION_ENABLED]=isSelectionModeEnabled(r.props,RegionCardinality.FULL_ROWS),l)),w=r.grid.getRowIndicesInRect(d,m),L=n?0:w.rowIndexStart,y=n?r.getMaxFrozenRowIndex():w.rowIndexEnd;return React.createElement("div",{className:S,ref:e},React.createElement(RowHeader,{enableMultipleSelection:u,focusedCell:s,grid:r.grid,locator:r.locator,isReorderable:p,isResizable:R,loading:hasLoadingOption(h,TableLoadingOption.ROW_HEADERS),maxRowHeight:g,minRowHeight:C,onFocusedCell:r.handleFocus,onLayoutLock:r.handleLayoutLock,onResizeGuide:o,onReordered:r.handleRowsReordered,onReordering:t,onRowHeightChanged:r.handleRowHeightChanged,onSelection:r.getEnabledSelectionHandler(RegionCardinality.FULL_ROWS),rowHeaderCellRenderer:f,selectedRegions:a,selectedRegionTransform:E,rowIndexStart:L,rowIndexEnd:y}),r.maybeRenderRegions(r.styleRowHeaderRegion))},r.bodyCellRenderer=function(e,o){var t=r.getColumnProps(o);if(void 0===t)return null;t.id;var n=t.loadingOptions,l=t.cellRenderer,i=(t.columnHeaderCellRenderer,t.name,t.nameRenderer,__rest(t,["id","loadingOptions","cellRenderer","columnHeaderCellRenderer","name","nameRenderer"])),s=l(e,o),a=s.props.loading,d=void 0===a?hasLoadingOption(n,ColumnLoadingOption.CELLS):a,c=__assign(__assign({},i),{loading:d});return React.cloneElement(s,c)},r.renderBody=function(e,o,t){void 0===o&&(o=!1),void 0===t&&(t=!1);var n=r.state,l=n.focusedCell,i=n.numFrozenColumnsClamped,s=n.numFrozenRowsClamped,a=n.selectedRegions,d=n.viewportRect,c=r.props,u=c.enableMultipleSelection,m=c.enableGhostCells,p=c.loadingOptions,R=c.bodyContextMenuRenderer,h=c.selectedRegionTransform,g=r.grid.getRowIndicesInRect(d,m),C=r.grid.getColumnIndicesInRect(d,m),f=t?0:C.columnIndexStart+i,E=o?0:g.rowIndexStart+s,S=t?i-1:C.columnIndexEnd,w=o?s-1:g.rowIndexEnd,L=e===QuadrantType.MAIN?r.handleCompleteRender:void 0;return React.createElement("div",null,React.createElement(TableBody,{enableMultipleSelection:u,cellRenderer:r.bodyCellRenderer,focusedCell:l,grid:r.grid,loading:hasLoadingOption(p,TableLoadingOption.CELLS),locator:r.locator,onCompleteRender:L,onFocusedCell:r.handleFocus,onSelection:r.getEnabledSelectionHandler(RegionCardinality.CELLS),bodyContextMenuRenderer:R,renderMode:r.getNormalizedRenderMode(),selectedRegions:a,selectedRegionTransform:h,viewportRect:d,columnIndexStart:f,columnIndexEnd:S,rowIndexStart:E,rowIndexEnd:w,numFrozenColumns:t?i:void 0,numFrozenRows:o?s:void 0}),r.maybeRenderRegions(r.styleBodyRegion,e))},r.getEnabledSelectionHandler=function(e){return isSelectionModeEnabled(r.props,e)?r.handleSelection:r.clearSelection},r.handleCompleteRender=function(){var e,o;null!=r.state.viewportRect&&(null===(o=(e=r.props).onCompleteRender)||void 0===o||o.call(e),r.didCompletelyMount=!0)},r.styleBodyRegion=function(e,o){var t=r.props.numFrozenColumns,n=Regions.getRegionCardinality(e),l=r.grid.getRegionStyle(e),i=(o===QuadrantType.TOP_LEFT||o===QuadrantType.LEFT)&&null!=t&&t>0,s=r.grid.getHeight(),a=r.grid.getWidth(),d="-1px";switch(n){case RegionCardinality.CELLS:return l;case RegionCardinality.FULL_COLUMNS:return l.top=d,l.height=s+1,l;case RegionCardinality.FULL_ROWS:return l.left=d,l.width=a+1,i&&(l.right=d),l;case RegionCardinality.FULL_TABLE:return l.left=d,l.top=d,l.width=a+1,l.height=s+1,i&&(l.right=d),l;default:return{display:"none"}}},r.styleMenuRegion=function(e){if(null==r.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=r.grid.getRegionStyle(e);return o===RegionCardinality.FULL_TABLE?(t.right="0px",t.bottom="0px",t.top="0px",t.left="0px",t.borderBottom="none",t.borderRight="none",t):{display:"none"}},r.styleColumnHeaderRegion=function(e){if(null==r.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=r.grid.getRegionStyle(e);switch(o){case RegionCardinality.FULL_TABLE:return t.left="-1px",t.borderLeft="none",t.bottom="-1px",t;case RegionCardinality.FULL_COLUMNS:return t.bottom="-1px",t;default:return{display:"none"}}},r.styleRowHeaderRegion=function(e){if(null==r.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=r.grid.getRegionStyle(e);switch(o){case RegionCardinality.FULL_TABLE:return t.top="-1px",t.borderTop="none",t.right="-1px",t;case RegionCardinality.FULL_ROWS:return t.right="-1px",t;default:return{display:"none"}}},r.handleColumnWidthChanged=function(e,o){var t=r.state.selectedRegions,n=r.state.columnWidths.slice();if(Regions.hasFullTable(t))for(var l=0;l<n.length;l++)n[l]=o;Regions.hasFullColumn(t,e)?Regions.eachUniqueFullColumn(t,(function(e){n[e]=o})):n[e]=o,r.invalidateGrid(),r.setState({columnWidths:n});var i=r.props.onColumnWidthChanged;null!=i&&i(e,o)},r.handleRowHeightChanged=function(e,o){var t=r.state.selectedRegions,n=r.state.rowHeights.slice();if(Regions.hasFullTable(t))for(var l=0;l<n.length;l++)n[l]=o;Regions.hasFullRow(t,e)?Regions.eachUniqueFullRow(t,(function(e){n[e]=o})):n[e]=o,r.invalidateGrid(),r.setState({rowHeights:n});var i=r.props.onRowHeightChanged;null!=i&&i(e,o)},r.handleRootScroll=function(e){null!=r.rootTableElement&&(r.rootTableElement.scrollLeft=0,r.rootTableElement.scrollTop=0)},r.handleBodyScroll=function(e){if(e.stopPropagation(),null!=r.locator&&!r.state.isLayoutLocked){var o=r.locator.getViewportRect();r.updateViewportRect(o)}},r.clearSelection=function(e){r.handleSelection([])},r.syncViewportPosition=function(e){var o=e.nextScrollLeft,t=e.nextScrollTop,n=r.state.viewportRect;if(void 0!==o||void 0!==t){if(void 0!==t){var l=r.shouldDisableVerticalScroll()?0:r.columnHeaderElement.clientHeight;r.scrollContainerElement.scrollTop=t+l}if(void 0!==o){var i=r.shouldDisableHorizontalScroll()||null==r.rowHeaderElement?0:r.rowHeaderElement.clientWidth;r.scrollContainerElement.scrollLeft=o+i}var s=new Rect(o,t,n.width,n.height);r.updateViewportRect(s)}},r.handleFocus=function(e){var o,t;r.props.enableFocusedCell&&(null==r.props.focusedCell&&r.setState({focusedCell:e}),null===(t=(o=r.props).onFocusedCell)||void 0===t||t.call(o,e))},r.handleSelection=function(e){null==r.props.selectedRegions&&r.setState({selectedRegions:e});var o=r.props.onSelection;null!=o&&o(e)},r.handleColumnsReordering=function(e){r.setState({isReordering:!0,verticalGuides:e})},r.handleColumnsReordered=function(e,o,t){var n,l;r.setState({isReordering:!1,verticalGuides:void 0}),null===(l=(n=r.props).onColumnsReordered)||void 0===l||l.call(n,e,o,t)},r.handleRowsReordering=function(e){r.setState({isReordering:!0,horizontalGuides:e})},r.handleRowsReordered=function(e,o,t){var n,l;r.setState({isReordering:!1,horizontalGuides:void 0}),null===(l=(n=r.props).onRowsReordered)||void 0===l||l.call(n,e,o,t)},r.handleLayoutLock=function(e){void 0===e&&(e=!1),r.setState({isLayoutLocked:e})},r.updateViewportRect=function(e){var o=r.state.viewportRect;r.setState({viewportRect:e}),(null!=o&&!o.equals(e)||null==o&&null!=e)&&r.invokeOnVisibleCellsChangeCallback(e)},r.getMaxFrozenColumnIndex=function(){var e=r.state.numFrozenColumnsClamped;return null!=e?e-1:void 0},r.getMaxFrozenRowIndex=function(){var e=r.state.numFrozenRowsClamped;return null!=e?e-1:void 0},r.handleColumnResizeGuide=function(e){r.setState({verticalGuides:e})},r.handleRowResizeGuide=function(e){r.setState({horizontalGuides:e})};var l=r.props,i=l.children,s=l.columnWidths,a=l.defaultRowHeight,d=l.defaultColumnWidth,c=l.numRows,u=l.rowHeights,m=React.Children.toArray(i),p=o.createColumnIdIndex(m),R=m.map((function(){return d}));R=Utils.assignSparseValues(R,s);var h=Utils.times(c,(function(){return a}));h=Utils.assignSparseValues(h,u);var g=null==t.selectedRegions?[]:t.selectedRegions,C=FocusedCellUtils.getInitialFocusedCell(t.enableFocusedCell,t.focusedCell,void 0,g);return r.state={childrenArray:m,columnIdToIndex:p,columnWidths:R,focusedCell:C,isLayoutLocked:!1,isReordering:!1,numFrozenColumnsClamped:clampNumFrozenColumns(t),numFrozenRowsClamped:clampNumFrozenRows(t),rowHeights:h,selectedRegions:g},r.hotkeysImpl=new TableHotkeys(t,r.state,r.grid,{getEnabledSelectionHandler:r.getEnabledSelectionHandler,handleFocus:r.handleFocus,handleSelection:r.handleSelection,syncViewportPosition:r.syncViewportPosition}),r.hotkeys=getHotkeysFromProps(t,r.hotkeysImpl),r}return __extends(o,e),o.getDerivedStateFromProps=function(e,t){var n=e.children,r=e.defaultColumnWidth,l=e.defaultRowHeight,i=e.enableFocusedCell,s=e.focusedCell,a=e.numRows,d=e.selectedRegions,c=e.selectionModes,u=e.columnWidths,m=e.rowHeights;null==u&&(u=t.columnWidths),null==m&&(m=t.rowHeights);var p=React.Children.toArray(n),R=p!==t.childrenArray,h=p.length,g=u;if(u!==t.columnWidths||R){var C=p.map((function(e,o){var n=t.columnIdToIndex[e.props.id];return t.columnWidths[null!=n?n:o]}));g=Utils.arrayOfLength(g,h,r),g=Utils.assignSparseValues(g,C),g=Utils.assignSparseValues(g,u)}var f=m;m===t.rowHeights&&a===t.rowHeights.length||(f=Utils.arrayOfLength(f,a,l),f=Utils.assignSparseValues(f,m));var E=d;null==d&&(E=t.selectedRegions.filter((function(o){var t=Regions.getRegionCardinality(o);return isSelectionModeEnabled(e,t,c)&&Regions.isRegionValidForTable(o,a,h)})));var S=FocusedCellUtils.getInitialFocusedCell(i,s,t.focusedCell,E),w={childrenArray:p,columnIdToIndex:R?o.createColumnIdIndex(p):t.columnIdToIndex,columnWidths:g,focusedCell:S,numFrozenColumnsClamped:clampNumFrozenColumns(e),numFrozenRowsClamped:clampNumFrozenRows(e),rowHeights:f,selectedRegions:E};return CoreUtils.deepCompareKeys(t,w,o.SHALLOW_COMPARE_STATE_KEYS_DENYLIST)?null:w},o.createColumnIdIndex=function(e){for(var o={},t=0;t<e.length;t++){var n=e[t].props.id;null!=n&&(o[String(n)]=t)}return o},o.prototype.resizeRowsByApproximateHeight=function(e,o){var t=resizeRowsByApproximateHeight(this.props.numRows,this.state.columnWidths,e,o);this.invalidateGrid(),this.setState({rowHeights:t})},o.prototype.resizeRowsByTallestCell=function(e){var o=resizeRowsByTallestCell(this.grid,this.state.viewportRect,this.locator,this.state.rowHeights.length,e);this.invalidateGrid(),this.setState({rowHeights:o})},o.prototype.scrollToRegion=function(e){var o=this.state,t=o.numFrozenColumnsClamped,n=o.numFrozenRowsClamped,r=this.state.viewportRect,l=r.left,i=r.top,s=ScrollUtils.getScrollPositionForRegion(e,l,i,this.grid.getCumulativeWidthBefore,this.grid.getCumulativeHeightBefore,n,t),a=s.scrollLeft,d=s.scrollTop,c=this.shouldDisableHorizontalScroll()?0:a,u=this.shouldDisableVerticalScroll()?0:d;this.quadrantStackInstance.scrollToPosition(c,u)},o.prototype.getChildContext=function(){return{enableColumnInteractionBar:this.props.enableColumnInteractionBar}},o.prototype.shouldComponentUpdate=function(e,t){var n={exclude:o.SHALLOW_COMPARE_PROP_KEYS_DENYLIST},r={exclude:o.SHALLOW_COMPARE_STATE_KEYS_DENYLIST};return!(CoreUtils.shallowCompareKeys(this.props,e,n)&&CoreUtils.shallowCompareKeys(this.state,t,r)&&CoreUtils.deepCompareKeys(this.props,e,o.SHALLOW_COMPARE_PROP_KEYS_DENYLIST)&&CoreUtils.deepCompareKeys(this.state,t,o.SHALLOW_COMPARE_STATE_KEYS_DENYLIST))},o.prototype.render=function(){return React.createElement(HotkeysTarget2,{hotkeys:this.hotkeys},this.renderTableContents)},o.prototype.componentDidMount=function(){var e=this;this.validateGrid(),this.locator=new Locator(this.rootTableElement,this.scrollContainerElement,this.cellContainerElement),this.updateLocator(),this.updateViewportRect(this.locator.getViewportRect()),this.resizeSensorDetach=ResizeSensor.attach(this.rootTableElement,(function(){e.state.isLayoutLocked||e.updateViewportRect(e.locator.getViewportRect())}))},o.prototype.componentWillUnmount=function(){null!=this.resizeSensorDetach&&(this.resizeSensorDetach(),delete this.resizeSensorDetach),this.didCompletelyMount=!1},o.prototype.getSnapshotBeforeUpdate=function(){var e=this.state.viewportRect;this.validateGrid();var o=this.grid.getCumulativeHeightAt(this.grid.numRows-1),t=this.grid.getCumulativeWidthAt(this.grid.numCols-1),n=o<e.top+e.height?Math.max(0,o-e.height):void 0;return{nextScrollLeft:t<e.left+e.width?Math.max(0,t-e.width):void 0,nextScrollTop:n}},o.prototype.componentDidUpdate=function(o,t,n){e.prototype.componentDidUpdate.call(this,o,t,n),this.hotkeysImpl.setState(this.state),this.hotkeysImpl.setProps(this.props),(React.Children.toArray(this.props.children)!==this.state.childrenArray||this.props.columnWidths!==t.columnWidths||this.props.rowHeights!==t.rowHeights||this.props.numRows!==o.numRows||this.props.forceRerenderOnSelectionChange&&this.props.selectedRegions!==o.selectedRegions)&&this.invalidateGrid(),null!=this.locator&&(this.validateGrid(),this.updateLocator()),(!CoreUtils.arraysEqual(this.state.columnWidths,t.columnWidths)||!CoreUtils.arraysEqual(this.state.rowHeights,t.rowHeights))&&(this.quadrantStackInstance.synchronizeQuadrantViews(),this.syncViewportPosition(n)),(this.props.getCellClipboardData!==o.getCellClipboardData||this.props.enableFocusedCell!==o.enableFocusedCell||this.props.enableMultipleSelection!==o.enableMultipleSelection||this.props.selectionModes!==o.selectionModes)&&(this.hotkeys=getHotkeysFromProps(this.props,this.hotkeysImpl))},o.prototype.validateProps=function(e){var o=e.children,t=e.columnWidths,n=e.numFrozenColumns,r=e.numFrozenRows,l=e.numRows,i=e.rowHeights,s=React.Children.count(o);if(null!=l&&l<0)throw new Error(Errors.TABLE_NUM_ROWS_NEGATIVE);if(null!=r&&r<0)throw new Error(Errors.TABLE_NUM_FROZEN_ROWS_NEGATIVE);if(null!=n&&n<0)throw new Error(Errors.TABLE_NUM_FROZEN_COLUMNS_NEGATIVE);if(null!=l&&null!=i&&i.length!==l)throw new Error(Errors.TABLE_NUM_ROWS_ROW_HEIGHTS_MISMATCH);if(null!=s&&null!=t&&t.length!==s)throw new Error(Errors.TABLE_NUM_COLUMNS_COLUMN_WIDTHS_MISMATCH);React.Children.forEach(o,(function(e){if(!CoreUtils.isElementOfType(e,Column))throw new Error(Errors.TABLE_NON_COLUMN_CHILDREN_WARNING)})),null!=r&&null!=l&&r>l&&console.warn(Errors.TABLE_NUM_FROZEN_ROWS_BOUND_WARNING),null!=n&&n>s&&console.warn(Errors.TABLE_NUM_FROZEN_COLUMNS_BOUND_WARNING)},o.prototype.gridDimensionsMatchProps=function(){var e=this.props,o=e.children,t=e.numRows;return null!=this.grid&&this.grid.numCols===React.Children.count(o)&&this.grid.numRows===t},o.prototype.shouldDisableVerticalScroll=function(){var e=this.props.enableGhostCells,o=this.state.viewportRect,t=this.grid.getRowIndicesInRect(o,e),n=null!=o&&0===o.top,r=hasLoadingOption(this.props.loadingOptions,TableLoadingOption.ROW_HEADERS);return e&&this.grid.isGhostIndex(t.rowIndexEnd-1,0)&&(n||r)},o.prototype.shouldDisableHorizontalScroll=function(){var e=this.props.enableGhostCells,o=this.state.viewportRect,t=this.grid.getColumnIndicesInRect(o,e),n=null!=o&&0===o.left,r=e&&this.grid.isGhostColumn(t.columnIndexEnd),l=hasLoadingOption(this.props.loadingOptions,TableLoadingOption.COLUMN_HEADERS);return r&&(n||l)},o.prototype.getColumnProps=function(e){var o=this.state.childrenArray[e];return void 0===o?void 0:o.props},o.prototype.isGuidesShowing=function(){return null!=this.state.verticalGuides||null!=this.state.horizontalGuides},o.prototype.invalidateGrid=function(){this.grid=null},o.prototype.validateGrid=function(){if(null==this.grid){var e=this.props,o=e.defaultRowHeight,t=e.defaultColumnWidth,n=this.state,r=n.rowHeights,l=n.columnWidths;this.grid=new Grid(r,l,Grid.DEFAULT_BLEED,o,t),this.invokeOnVisibleCellsChangeCallback(this.state.viewportRect),this.hotkeysImpl.setGrid(this.grid)}},o.prototype.maybeRenderRegions=function(e,o){if(!this.isGuidesShowing()||this.state.isReordering)return Regions.joinStyledRegionGroups(this.state.selectedRegions,this.props.styledRegionGroups,this.state.focusedCell).map((function(t,n){var r=t.regions.map((function(t){return e(t,o)}));return React.createElement(RegionLayer,{className:classNames(t.className),key:n,regions:t.regions,regionStyles:r})}))},o.prototype.updateLocator=function(){this.locator.setGrid(this.grid).setNumFrozenRows(this.state.numFrozenRowsClamped).setNumFrozenColumns(this.state.numFrozenColumnsClamped)},o.prototype.invokeOnVisibleCellsChangeCallback=function(e){var o,t,n=this.grid.getColumnIndicesInRect(e),r=this.grid.getRowIndicesInRect(e);null===(t=(o=this.props).onVisibleCellsChange)||void 0===t||t.call(o,r,n)},o.prototype.getNormalizedRenderMode=function(){var e=this.props.renderMode;return e===RenderMode.BATCH||e===RenderMode.BATCH_ON_UPDATE&&this.didCompletelyMount?RenderMode.BATCH:RenderMode.NONE},o.displayName=DISPLAYNAME_PREFIX+".Table2",o.defaultProps={defaultColumnWidth:150,defaultRowHeight:20,enableFocusedCell:!1,enableGhostCells:!1,enableMultipleSelection:!0,enableRowHeader:!0,forceRerenderOnSelectionChange:!1,loadingOptions:[],minColumnWidth:50,minRowHeight:20,numFrozenColumns:0,numFrozenRows:0,numRows:0,renderMode:RenderMode.BATCH_ON_UPDATE,rowHeaderCellRenderer:renderDefaultRowHeader,selectionModes:SelectionModes.ALL},o.childContextTypes=columnInteractionBarContextTypes,o.SHALLOW_COMPARE_PROP_KEYS_DENYLIST=["selectedRegions"],o.SHALLOW_COMPARE_STATE_KEYS_DENYLIST=["selectedRegions","viewportRect"],o}(AbstractComponent2);export{Table2};