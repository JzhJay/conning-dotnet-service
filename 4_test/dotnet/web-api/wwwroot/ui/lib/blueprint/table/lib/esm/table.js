import{__assign,__decorate,__extends,__rest}from"tslib";import classNames from"classnames";import*as React from"react";import{polyfill}from"react-lifecycles-compat";import{AbstractComponent2,DISPLAYNAME_PREFIX,Hotkey,Hotkeys,HotkeysTarget,Utils as CoreUtils}from"@blueprintjs/core";import{Column}from"./column";import*as Classes from"./common/classes";import{columnInteractionBarContextTypes}from"./common/context";import*as Errors from"./common/errors";import{Grid}from"./common/grid";import*as FocusedCellUtils from"./common/internal/focusedCellUtils";import*as ScrollUtils from"./common/internal/scrollUtils";import{Rect}from"./common/rect";import{RenderMode}from"./common/renderMode";import{Utils}from"./common/utils";import{ColumnHeader}from"./headers/columnHeader";import{ColumnHeaderCell}from"./headers/columnHeaderCell";import{renderDefaultRowHeader,RowHeader}from"./headers/rowHeader";import{ResizeSensor}from"./interactions/resizeSensor";import{GuideLayer}from"./layers/guides";import{RegionLayer}from"./layers/regions";import{Locator}from"./locator";import{QuadrantType}from"./quadrants/tableQuadrant";import{TableQuadrantStack}from"./quadrants/tableQuadrantStack";import{ColumnLoadingOption,RegionCardinality,Regions,SelectionModes,TableLoadingOption}from"./regions";import{resizeRowsByApproximateHeight,resizeRowsByTallestCell}from"./resizeRows";import{TableBody}from"./tableBody";import{TableHotkeys}from"./tableHotkeys";import{clampNumFrozenColumns,clampNumFrozenRows,hasLoadingOption}from"./tableUtils";var Table=function(e){function o(o,n){var l=e.call(this,o,n)||this;l.refHandlers={cellContainer:function(e){return l.cellContainerElement=e},columnHeader:function(e){return l.columnHeaderElement=e},quadrantStack:function(e){return l.quadrantStackInstance=e},rootTable:function(e){return l.rootTableElement=e},rowHeader:function(e){return l.rowHeaderElement=e},scrollContainer:function(e){return l.scrollContainerElement=e}},l.didCompletelyMount=!1,l.renderMenu=function(e){var o,n=classNames(Classes.TABLE_MENU,((o={})[Classes.TABLE_SELECTION_ENABLED]=t.isSelectionModeEnabled(l.props,RegionCardinality.FULL_TABLE),o));return React.createElement("div",{className:n,ref:e,onMouseDown:l.handleMenuMouseDown},l.maybeRenderRegions(l.styleMenuRegion))},l.handleMenuMouseDown=function(e){l.selectAll(!e.shiftKey)},l.selectAll=function(e){if(l.getEnabledSelectionHandler(RegionCardinality.FULL_TABLE)([Regions.table()]),e){var o=Regions.getFocusCellCoordinatesFromRegion(Regions.table());l.handleFocus(FocusedCellUtils.toFullCoordinates(o))}},l.columnHeaderCellRenderer=function(e){var o=l.getColumnProps(e);if(void 0===o)return null;o.id;var t=o.loadingOptions,n=(o.cellRenderer,o.columnHeaderCellRenderer),r=__rest(o,["id","loadingOptions","cellRenderer","columnHeaderCellRenderer"]),i=hasLoadingOption(t,ColumnLoadingOption.HEADER);if(null!=n){var s=n(e),a=s.props.loading,d={loading:null!=a?a:i};return React.cloneElement(s,d)}var c=__assign({index:e,loading:i},r);return null!=o.name?React.createElement(ColumnHeaderCell,__assign({},c)):React.createElement(ColumnHeaderCell,__assign({},c,{name:Utils.toBase26Alpha(e)}))},l.renderColumnHeader=function(e,o,n,r){var i;void 0===r&&(r=!1);var s=l.state,a=s.focusedCell,d=s.selectedRegions,c=s.viewportRect,u=l.props,h=u.enableMultipleSelection,m=u.enableGhostCells,p=u.enableColumnReordering,R=u.enableColumnResizing,g=u.loadingOptions,C=u.maxColumnWidth,y=u.minColumnWidth,f=u.selectedRegionTransform,E=classNames(Classes.TABLE_COLUMN_HEADERS,((i={})[Classes.TABLE_SELECTION_ENABLED]=t.isSelectionModeEnabled(l.props,RegionCardinality.FULL_COLUMNS),i)),w=l.grid.getColumnIndicesInRect(c,m),S=r?0:w.columnIndexStart,L=r?l.getMaxFrozenColumnIndex():w.columnIndexEnd;return React.createElement("div",{className:E},React.createElement(ColumnHeader,{enableMultipleSelection:h,cellRenderer:l.columnHeaderCellRenderer,focusedCell:a,grid:l.grid,isReorderable:p,isResizable:R,loading:hasLoadingOption(g,TableLoadingOption.COLUMN_HEADERS),locator:l.locator,maxColumnWidth:C,measurableElementRef:e,minColumnWidth:y,onColumnWidthChanged:l.handleColumnWidthChanged,onFocusedCell:l.handleFocus,onLayoutLock:l.handleLayoutLock,onReordered:l.handleColumnsReordered,onReordering:n,onResizeGuide:o,onSelection:l.getEnabledSelectionHandler(RegionCardinality.FULL_COLUMNS),selectedRegions:d,selectedRegionTransform:f,columnIndexStart:S,columnIndexEnd:L},l.props.children),l.maybeRenderRegions(l.styleColumnHeaderRegion))},l.renderRowHeader=function(e,o,n,r){var i;void 0===r&&(r=!1);var s=l.state,a=s.focusedCell,d=s.selectedRegions,c=s.viewportRect,u=l.props,h=u.enableMultipleSelection,m=u.enableGhostCells,p=u.enableRowReordering,R=u.enableRowResizing,g=u.loadingOptions,C=u.maxRowHeight,y=u.minRowHeight,f=u.rowHeaderCellRenderer,E=u.selectedRegionTransform,w=classNames(Classes.TABLE_ROW_HEADERS,((i={})[Classes.TABLE_SELECTION_ENABLED]=t.isSelectionModeEnabled(l.props,RegionCardinality.FULL_ROWS),i)),S=l.grid.getRowIndicesInRect(c,m),L=r?0:S.rowIndexStart,b=r?l.getMaxFrozenRowIndex():S.rowIndexEnd;return React.createElement("div",{className:w,ref:e},React.createElement(RowHeader,{enableMultipleSelection:h,focusedCell:a,grid:l.grid,locator:l.locator,isReorderable:p,isResizable:R,loading:hasLoadingOption(g,TableLoadingOption.ROW_HEADERS),maxRowHeight:C,minRowHeight:y,onFocusedCell:l.handleFocus,onLayoutLock:l.handleLayoutLock,onResizeGuide:o,onReordered:l.handleRowsReordered,onReordering:n,onRowHeightChanged:l.handleRowHeightChanged,onSelection:l.getEnabledSelectionHandler(RegionCardinality.FULL_ROWS),rowHeaderCellRenderer:f,selectedRegions:d,selectedRegionTransform:E,rowIndexStart:L,rowIndexEnd:b}),l.maybeRenderRegions(l.styleRowHeaderRegion))},l.bodyCellRenderer=function(e,o){var t=l.getColumnProps(o);if(void 0===t)return null;t.id;var n=t.loadingOptions,r=t.cellRenderer,i=(t.columnHeaderCellRenderer,t.name,t.nameRenderer,__rest(t,["id","loadingOptions","cellRenderer","columnHeaderCellRenderer","name","nameRenderer"])),s=r(e,o),a=s.props.loading,d=void 0===a?hasLoadingOption(n,ColumnLoadingOption.CELLS):a,c=__assign(__assign({},i),{loading:d});return React.cloneElement(s,c)},l.renderBody=function(e,o,t){void 0===o&&(o=!1),void 0===t&&(t=!1);var n=l.state,r=n.focusedCell,i=n.numFrozenColumnsClamped,s=n.numFrozenRowsClamped,a=n.selectedRegions,d=n.viewportRect,c=l.props,u=c.enableMultipleSelection,h=c.enableGhostCells,m=c.loadingOptions,p=c.bodyContextMenuRenderer,R=c.selectedRegionTransform,g=l.grid.getRowIndicesInRect(d,h),C=l.grid.getColumnIndicesInRect(d,h),y=t?0:C.columnIndexStart+i,f=o?0:g.rowIndexStart+s,E=t?i-1:C.columnIndexEnd,w=o?s-1:g.rowIndexEnd,S=e===QuadrantType.MAIN?l.handleCompleteRender:void 0;return React.createElement("div",null,React.createElement(TableBody,{enableMultipleSelection:u,cellRenderer:l.bodyCellRenderer,focusedCell:r,grid:l.grid,loading:hasLoadingOption(m,TableLoadingOption.CELLS),locator:l.locator,onCompleteRender:S,onFocusedCell:l.handleFocus,onSelection:l.getEnabledSelectionHandler(RegionCardinality.CELLS),bodyContextMenuRenderer:p,renderMode:l.getNormalizedRenderMode(),selectedRegions:a,selectedRegionTransform:R,viewportRect:d,columnIndexStart:y,columnIndexEnd:E,rowIndexStart:f,rowIndexEnd:w,numFrozenColumns:t?i:void 0,numFrozenRows:o?s:void 0}),l.maybeRenderRegions(l.styleBodyRegion,e))},l.getEnabledSelectionHandler=function(e){return t.isSelectionModeEnabled(l.props,e)?l.handleSelection:l.clearSelection},l.handleCompleteRender=function(){var e,o;null!=l.state.viewportRect&&(null===(o=(e=l.props).onCompleteRender)||void 0===o||o.call(e),l.didCompletelyMount=!0)},l.styleBodyRegion=function(e,o){var t=l.props.numFrozenColumns,n=Regions.getRegionCardinality(e),r=l.grid.getRegionStyle(e),i=(o===QuadrantType.TOP_LEFT||o===QuadrantType.LEFT)&&null!=t&&t>0,s=l.grid.getHeight(),a=l.grid.getWidth(),d="-1px";switch(n){case RegionCardinality.CELLS:return r;case RegionCardinality.FULL_COLUMNS:return r.top=d,r.height=s+1,r;case RegionCardinality.FULL_ROWS:return r.left=d,r.width=a+1,i&&(r.right=d),r;case RegionCardinality.FULL_TABLE:return r.left=d,r.top=d,r.width=a+1,r.height=s+1,i&&(r.right=d),r;default:return{display:"none"}}},l.styleMenuRegion=function(e){if(null==l.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=l.grid.getRegionStyle(e);return o===RegionCardinality.FULL_TABLE?(t.right="0px",t.bottom="0px",t.top="0px",t.left="0px",t.borderBottom="none",t.borderRight="none",t):{display:"none"}},l.styleColumnHeaderRegion=function(e){if(null==l.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=l.grid.getRegionStyle(e);switch(o){case RegionCardinality.FULL_TABLE:return t.left="-1px",t.borderLeft="none",t.bottom="-1px",t;case RegionCardinality.FULL_COLUMNS:return t.bottom="-1px",t;default:return{display:"none"}}},l.styleRowHeaderRegion=function(e){if(null==l.state.viewportRect)return{};var o=Regions.getRegionCardinality(e),t=l.grid.getRegionStyle(e);switch(o){case RegionCardinality.FULL_TABLE:return t.top="-1px",t.borderTop="none",t.right="-1px",t;case RegionCardinality.FULL_ROWS:return t.right="-1px",t;default:return{display:"none"}}},l.handleColumnWidthChanged=function(e,o){var t=l.state.selectedRegions,n=l.state.columnWidths.slice();if(Regions.hasFullTable(t))for(var r=0;r<n.length;r++)n[r]=o;Regions.hasFullColumn(t,e)?Regions.eachUniqueFullColumn(t,(function(e){n[e]=o})):n[e]=o,l.invalidateGrid(),l.setState({columnWidths:n});var i=l.props.onColumnWidthChanged;null!=i&&i(e,o)},l.handleRowHeightChanged=function(e,o){var t=l.state.selectedRegions,n=l.state.rowHeights.slice();if(Regions.hasFullTable(t))for(var r=0;r<n.length;r++)n[r]=o;Regions.hasFullRow(t,e)?Regions.eachUniqueFullRow(t,(function(e){n[e]=o})):n[e]=o,l.invalidateGrid(),l.setState({rowHeights:n});var i=l.props.onRowHeightChanged;null!=i&&i(e,o)},l.handleRootScroll=function(e){null!=l.rootTableElement&&(l.rootTableElement.scrollLeft=0,l.rootTableElement.scrollTop=0)},l.handleBodyScroll=function(e){if(e.stopPropagation(),null!=l.locator&&!l.state.isLayoutLocked){var o=l.locator.getViewportRect();l.updateViewportRect(o)}},l.clearSelection=function(e){l.handleSelection([])},l.syncViewportPosition=function(e){var o=e.nextScrollLeft,t=e.nextScrollTop,n=l.state.viewportRect;if(void 0!==o||void 0!==t){if(void 0!==t){var r=l.shouldDisableVerticalScroll()?0:l.columnHeaderElement.clientHeight;l.scrollContainerElement.scrollTop=t+r}if(void 0!==o){var i=l.shouldDisableHorizontalScroll()||null==l.rowHeaderElement?0:l.rowHeaderElement.clientWidth;l.scrollContainerElement.scrollLeft=o+i}var s=new Rect(o,t,n.width,n.height);l.updateViewportRect(s)}},l.handleFocus=function(e){var o,t;l.props.enableFocusedCell&&(null==l.props.focusedCell&&l.setState({focusedCell:e}),null===(t=(o=l.props).onFocusedCell)||void 0===t||t.call(o,e))},l.handleSelection=function(e){null==l.props.selectedRegions&&l.setState({selectedRegions:e});var o=l.props.onSelection;null!=o&&o(e)},l.handleColumnsReordering=function(e){l.setState({isReordering:!0,verticalGuides:e})},l.handleColumnsReordered=function(e,o,t){var n,r;l.setState({isReordering:!1,verticalGuides:void 0}),null===(r=(n=l.props).onColumnsReordered)||void 0===r||r.call(n,e,o,t)},l.handleRowsReordering=function(e){l.setState({isReordering:!0,horizontalGuides:e})},l.handleRowsReordered=function(e,o,t){var n,r;l.setState({isReordering:!1,horizontalGuides:void 0}),null===(r=(n=l.props).onRowsReordered)||void 0===r||r.call(n,e,o,t)},l.handleLayoutLock=function(e){void 0===e&&(e=!1),l.setState({isLayoutLocked:e})},l.updateViewportRect=function(e){var o=l.state.viewportRect;l.setState({viewportRect:e}),(null!=o&&!o.equals(e)||null==o&&null!=e)&&l.invokeOnVisibleCellsChangeCallback(e)},l.getMaxFrozenColumnIndex=function(){var e=l.state.numFrozenColumnsClamped;return null!=e?e-1:void 0},l.getMaxFrozenRowIndex=function(){var e=l.state.numFrozenRowsClamped;return null!=e?e-1:void 0},l.handleColumnResizeGuide=function(e){l.setState({verticalGuides:e})},l.handleRowResizeGuide=function(e){l.setState({horizontalGuides:e})};var r=l.props,i=r.children,s=r.columnWidths,a=r.defaultRowHeight,d=r.defaultColumnWidth,c=r.numRows,u=r.rowHeights,h=React.Children.toArray(i),m=t.createColumnIdIndex(h),p=h.map((function(){return d}));p=Utils.assignSparseValues(p,s);var R=Utils.times(c,(function(){return a}));R=Utils.assignSparseValues(R,u);var g=null==o.selectedRegions?[]:o.selectedRegions,C=FocusedCellUtils.getInitialFocusedCell(o.enableFocusedCell,o.focusedCell,void 0,g);return l.state={childrenArray:h,columnIdToIndex:m,columnWidths:p,focusedCell:C,isLayoutLocked:!1,isReordering:!1,numFrozenColumnsClamped:clampNumFrozenColumns(o),numFrozenRowsClamped:clampNumFrozenRows(o),rowHeights:R,selectedRegions:g},l.hotkeysImpl=new TableHotkeys(o,l.state,l.grid,{getEnabledSelectionHandler:l.getEnabledSelectionHandler,handleFocus:l.handleFocus,handleSelection:l.handleSelection,syncViewportPosition:l.syncViewportPosition}),l}var t;return __extends(o,e),t=o,o.getDerivedStateFromProps=function(e,o){var n=e.children,l=e.defaultColumnWidth,r=e.defaultRowHeight,i=e.enableFocusedCell,s=e.focusedCell,a=e.numRows,d=e.selectedRegions,c=e.selectionModes,u=e.columnWidths,h=e.rowHeights;null==u&&(u=o.columnWidths),null==h&&(h=o.rowHeights);var m=React.Children.toArray(n),p=m!==o.childrenArray,R=m.length,g=u;if(u!==o.columnWidths||p){var C=m.map((function(e,t){var n=o.columnIdToIndex[e.props.id];return o.columnWidths[null!=n?n:t]}));g=Utils.arrayOfLength(g,R,l),g=Utils.assignSparseValues(g,C),g=Utils.assignSparseValues(g,u)}var y=h;h===o.rowHeights&&a===o.rowHeights.length||(y=Utils.arrayOfLength(y,a,r),y=Utils.assignSparseValues(y,h));var f=d;null==d&&(f=o.selectedRegions.filter((function(o){var n=Regions.getRegionCardinality(o);return t.isSelectionModeEnabled(e,n,c)&&Regions.isRegionValidForTable(o,a,R)})));var E=FocusedCellUtils.getInitialFocusedCell(i,s,o.focusedCell,f),w={childrenArray:m,columnIdToIndex:p?t.createColumnIdIndex(m):o.columnIdToIndex,columnWidths:g,focusedCell:E,numFrozenColumnsClamped:clampNumFrozenColumns(e),numFrozenRowsClamped:clampNumFrozenRows(e),rowHeights:y,selectedRegions:f};return CoreUtils.deepCompareKeys(o,w,t.SHALLOW_COMPARE_STATE_KEYS_DENYLIST)?null:w},o.createColumnIdIndex=function(e){for(var o={},t=0;t<e.length;t++){var n=e[t].props.id;null!=n&&(o[String(n)]=t)}return o},o.isSelectionModeEnabled=function(e,o,t){void 0===t&&(t=e.selectionModes);var n=e.children,l=e.numRows,r=React.Children.count(n);return t.indexOf(o)>=0&&l>0&&r>0},o.prototype.resizeRowsByApproximateHeight=function(e,o){var t=resizeRowsByApproximateHeight(this.props.numRows,this.state.columnWidths,e,o);this.invalidateGrid(),this.setState({rowHeights:t})},o.prototype.resizeRowsByTallestCell=function(e){var o=resizeRowsByTallestCell(this.grid,this.state.viewportRect,this.locator,this.state.rowHeights.length,e);this.invalidateGrid(),this.setState({rowHeights:o})},o.prototype.scrollToRegion=function(e){var o=this.state,t=o.numFrozenColumnsClamped,n=o.numFrozenRowsClamped,l=this.state.viewportRect,r=l.left,i=l.top,s=ScrollUtils.getScrollPositionForRegion(e,r,i,this.grid.getCumulativeWidthBefore,this.grid.getCumulativeHeightBefore,n,t),a=s.scrollLeft,d=s.scrollTop,c=this.shouldDisableHorizontalScroll()?0:a,u=this.shouldDisableVerticalScroll()?0:d;this.quadrantStackInstance.scrollToPosition(c,u)},o.prototype.getChildContext=function(){return{enableColumnInteractionBar:this.props.enableColumnInteractionBar}},o.prototype.shouldComponentUpdate=function(e,o){var n={exclude:t.SHALLOW_COMPARE_PROP_KEYS_DENYLIST},l={exclude:t.SHALLOW_COMPARE_STATE_KEYS_DENYLIST};return!(CoreUtils.shallowCompareKeys(this.props,e,n)&&CoreUtils.shallowCompareKeys(this.state,o,l)&&CoreUtils.deepCompareKeys(this.props,e,t.SHALLOW_COMPARE_PROP_KEYS_DENYLIST)&&CoreUtils.deepCompareKeys(this.state,o,t.SHALLOW_COMPARE_STATE_KEYS_DENYLIST))},o.prototype.render=function(){var e,o=this.props,n=o.children,l=o.className,r=o.enableRowHeader,i=o.loadingOptions,s=o.numRows,a=o.enableColumnInteractionBar,d=this.state,c=d.horizontalGuides,u=d.numFrozenColumnsClamped,h=d.numFrozenRowsClamped,m=d.verticalGuides;this.gridDimensionsMatchProps()||this.invalidateGrid(),this.validateGrid();var p=classNames(Classes.TABLE_CONTAINER,((e={})[Classes.TABLE_REORDERING]=this.state.isReordering,e[Classes.TABLE_NO_VERTICAL_SCROLL]=this.shouldDisableVerticalScroll(),e[Classes.TABLE_NO_HORIZONTAL_SCROLL]=this.shouldDisableHorizontalScroll(),e[Classes.TABLE_SELECTION_ENABLED]=t.isSelectionModeEnabled(this.props,RegionCardinality.CELLS),e[Classes.TABLE_NO_ROWS]=0===s,e),l);return React.createElement("div",{className:p,ref:this.refHandlers.rootTable,onScroll:this.handleRootScroll},React.createElement(TableQuadrantStack,{bodyRef:this.refHandlers.cellContainer,bodyRenderer:this.renderBody,columnHeaderCellRenderer:this.renderColumnHeader,columnHeaderRef:this.refHandlers.columnHeader,enableColumnInteractionBar:a,enableRowHeader:r,grid:this.grid,handleColumnResizeGuide:this.handleColumnResizeGuide,handleColumnsReordering:this.handleColumnsReordering,handleRowResizeGuide:this.handleRowResizeGuide,handleRowsReordering:this.handleRowsReordering,isHorizontalScrollDisabled:this.shouldDisableHorizontalScroll(),isVerticalScrollDisabled:this.shouldDisableVerticalScroll(),loadingOptions:i,numColumns:React.Children.count(n),numFrozenColumns:u,numFrozenRows:h,numRows:s,onScroll:this.handleBodyScroll,ref:this.refHandlers.quadrantStack,menuRenderer:this.renderMenu,rowHeaderCellRenderer:this.renderRowHeader,rowHeaderRef:this.refHandlers.rowHeader,scrollContainerRef:this.refHandlers.scrollContainer}),React.createElement("div",{className:classNames(Classes.TABLE_OVERLAY_LAYER,Classes.TABLE_OVERLAY_REORDERING_CURSOR)}),React.createElement(GuideLayer,{className:Classes.TABLE_RESIZE_GUIDES,verticalGuides:m,horizontalGuides:c}))},o.prototype.renderHotkeys=function(){var e=[this.maybeRenderCopyHotkey(),this.maybeRenderSelectAllHotkey(),this.maybeRenderFocusHotkeys(),this.maybeRenderSelectionResizeHotkeys()];return React.createElement(Hotkeys,null,e.filter((function(e){return void 0!==e})))},o.prototype.componentDidMount=function(){var e=this;this.validateGrid(),this.locator=new Locator(this.rootTableElement,this.scrollContainerElement,this.cellContainerElement),this.updateLocator(),this.updateViewportRect(this.locator.getViewportRect()),this.resizeSensorDetach=ResizeSensor.attach(this.rootTableElement,(function(){e.state.isLayoutLocked||e.updateViewportRect(e.locator.getViewportRect())}))},o.prototype.componentWillUnmount=function(){null!=this.resizeSensorDetach&&(this.resizeSensorDetach(),delete this.resizeSensorDetach),this.didCompletelyMount=!1},o.prototype.getSnapshotBeforeUpdate=function(){var e=this.state.viewportRect;this.validateGrid();var o=this.grid.getCumulativeHeightAt(this.grid.numRows-1),t=this.grid.getCumulativeWidthAt(this.grid.numCols-1),n=o<e.top+e.height?Math.max(0,o-e.height):void 0;return{nextScrollLeft:t<e.left+e.width?Math.max(0,t-e.width):void 0,nextScrollTop:n}},o.prototype.componentDidUpdate=function(o,t,n){e.prototype.componentDidUpdate.call(this,o,t,n),this.hotkeysImpl.setState(this.state),this.hotkeysImpl.setProps(this.props),(React.Children.toArray(this.props.children)!==this.state.childrenArray||this.props.columnWidths!==t.columnWidths||this.props.rowHeights!==t.rowHeights||this.props.numRows!==o.numRows||this.props.forceRerenderOnSelectionChange&&this.props.selectedRegions!==o.selectedRegions)&&this.invalidateGrid(),null!=this.locator&&(this.validateGrid(),this.updateLocator()),(!CoreUtils.arraysEqual(this.state.columnWidths,t.columnWidths)||!CoreUtils.arraysEqual(this.state.rowHeights,t.rowHeights))&&(this.quadrantStackInstance.synchronizeQuadrantViews(),this.syncViewportPosition(n))},o.prototype.validateProps=function(e){var o=e.children,t=e.columnWidths,n=e.numFrozenColumns,l=e.numFrozenRows,r=e.numRows,i=e.rowHeights,s=React.Children.count(o);if(null!=r&&r<0)throw new Error(Errors.TABLE_NUM_ROWS_NEGATIVE);if(null!=l&&l<0)throw new Error(Errors.TABLE_NUM_FROZEN_ROWS_NEGATIVE);if(null!=n&&n<0)throw new Error(Errors.TABLE_NUM_FROZEN_COLUMNS_NEGATIVE);if(null!=r&&null!=i&&i.length!==r)throw new Error(Errors.TABLE_NUM_ROWS_ROW_HEIGHTS_MISMATCH);if(null!=s&&null!=t&&t.length!==s)throw new Error(Errors.TABLE_NUM_COLUMNS_COLUMN_WIDTHS_MISMATCH);React.Children.forEach(o,(function(e){if(!CoreUtils.isElementOfType(e,Column))throw new Error(Errors.TABLE_NON_COLUMN_CHILDREN_WARNING)})),null!=l&&null!=r&&l>r&&console.warn(Errors.TABLE_NUM_FROZEN_ROWS_BOUND_WARNING),null!=n&&n>s&&console.warn(Errors.TABLE_NUM_FROZEN_COLUMNS_BOUND_WARNING)},o.prototype.gridDimensionsMatchProps=function(){var e=this.props,o=e.children,t=e.numRows;return null!=this.grid&&this.grid.numCols===React.Children.count(o)&&this.grid.numRows===t},o.prototype.maybeRenderCopyHotkey=function(){return null!=this.props.getCellClipboardData?React.createElement(Hotkey,{key:"copy-hotkey",label:"Copy selected table cells",group:"Table",combo:"mod+c",onKeyDown:this.hotkeysImpl.handleCopy}):void 0},o.prototype.maybeRenderSelectionResizeHotkeys=function(){var e=this.props,o=e.enableMultipleSelection,t=e.selectionModes.length>0;return o&&t?[React.createElement(Hotkey,{key:"resize-selection-up",label:"Resize selection upward",group:"Table",combo:"shift+up",onKeyDown:this.hotkeysImpl.handleSelectionResizeUp}),React.createElement(Hotkey,{key:"resize-selection-down",label:"Resize selection downward",group:"Table",combo:"shift+down",onKeyDown:this.hotkeysImpl.handleSelectionResizeDown}),React.createElement(Hotkey,{key:"resize-selection-left",label:"Resize selection leftward",group:"Table",combo:"shift+left",onKeyDown:this.hotkeysImpl.handleSelectionResizeLeft}),React.createElement(Hotkey,{key:"resize-selection-right",label:"Resize selection rightward",group:"Table",combo:"shift+right",onKeyDown:this.hotkeysImpl.handleSelectionResizeRight})]:void 0},o.prototype.maybeRenderFocusHotkeys=function(){return null!=this.props.enableFocusedCell?[React.createElement(Hotkey,{key:"move left",label:"Move focus cell left",group:"Table",combo:"left",onKeyDown:this.hotkeysImpl.handleFocusMoveLeft}),React.createElement(Hotkey,{key:"move right",label:"Move focus cell right",group:"Table",combo:"right",onKeyDown:this.hotkeysImpl.handleFocusMoveRight}),React.createElement(Hotkey,{key:"move up",label:"Move focus cell up",group:"Table",combo:"up",onKeyDown:this.hotkeysImpl.handleFocusMoveUp}),React.createElement(Hotkey,{key:"move down",label:"Move focus cell down",group:"Table",combo:"down",onKeyDown:this.hotkeysImpl.handleFocusMoveDown}),React.createElement(Hotkey,{key:"move tab",label:"Move focus cell tab",group:"Table",combo:"tab",onKeyDown:this.hotkeysImpl.handleFocusMoveRightInternal,allowInInput:!0}),React.createElement(Hotkey,{key:"move shift-tab",label:"Move focus cell shift tab",group:"Table",combo:"shift+tab",onKeyDown:this.hotkeysImpl.handleFocusMoveLeftInternal,allowInInput:!0}),React.createElement(Hotkey,{key:"move enter",label:"Move focus cell enter",group:"Table",combo:"enter",onKeyDown:this.hotkeysImpl.handleFocusMoveDownInternal,allowInInput:!0}),React.createElement(Hotkey,{key:"move shift-enter",label:"Move focus cell shift enter",group:"Table",combo:"shift+enter",onKeyDown:this.hotkeysImpl.handleFocusMoveUpInternal,allowInInput:!0})]:[]},o.prototype.maybeRenderSelectAllHotkey=function(){return t.isSelectionModeEnabled(this.props,RegionCardinality.FULL_TABLE)?React.createElement(Hotkey,{key:"select-all-hotkey",label:"Select all",group:"Table",combo:"mod+a",onKeyDown:this.hotkeysImpl.handleSelectAllHotkey}):void 0},o.prototype.shouldDisableVerticalScroll=function(){var e=this.props.enableGhostCells,o=this.state.viewportRect,t=this.grid.getRowIndicesInRect(o,e),n=null!=o&&0===o.top,l=hasLoadingOption(this.props.loadingOptions,TableLoadingOption.ROW_HEADERS);return e&&this.grid.isGhostIndex(t.rowIndexEnd-1,0)&&(n||l)},o.prototype.shouldDisableHorizontalScroll=function(){var e=this.props.enableGhostCells,o=this.state.viewportRect,t=this.grid.getColumnIndicesInRect(o,e),n=null!=o&&0===o.left,l=e&&this.grid.isGhostColumn(t.columnIndexEnd),r=hasLoadingOption(this.props.loadingOptions,TableLoadingOption.COLUMN_HEADERS);return l&&(n||r)},o.prototype.getColumnProps=function(e){var o=this.state.childrenArray[e];return void 0===o?void 0:o.props},o.prototype.isGuidesShowing=function(){return null!=this.state.verticalGuides||null!=this.state.horizontalGuides},o.prototype.invalidateGrid=function(){this.grid=null},o.prototype.validateGrid=function(){if(null==this.grid){var e=this.props,o=e.defaultRowHeight,t=e.defaultColumnWidth,n=this.state,l=n.rowHeights,r=n.columnWidths;this.grid=new Grid(l,r,Grid.DEFAULT_BLEED,o,t),this.invokeOnVisibleCellsChangeCallback(this.state.viewportRect),this.hotkeysImpl.setGrid(this.grid)}},o.prototype.maybeRenderRegions=function(e,o){if(!this.isGuidesShowing()||this.state.isReordering)return Regions.joinStyledRegionGroups(this.state.selectedRegions,this.props.styledRegionGroups,this.state.focusedCell).map((function(t,n){var l=t.regions.map((function(t){return e(t,o)}));return React.createElement(RegionLayer,{className:classNames(t.className),key:n,regions:t.regions,regionStyles:l})}))},o.prototype.updateLocator=function(){this.locator.setGrid(this.grid).setNumFrozenRows(this.state.numFrozenRowsClamped).setNumFrozenColumns(this.state.numFrozenColumnsClamped)},o.prototype.invokeOnVisibleCellsChangeCallback=function(e){var o,t,n=this.grid.getColumnIndicesInRect(e),l=this.grid.getRowIndicesInRect(e);null===(t=(o=this.props).onVisibleCellsChange)||void 0===t||t.call(o,l,n)},o.prototype.getNormalizedRenderMode=function(){var e=this.props.renderMode;return e===RenderMode.BATCH||e===RenderMode.BATCH_ON_UPDATE&&this.didCompletelyMount?RenderMode.BATCH:RenderMode.NONE},o.displayName=DISPLAYNAME_PREFIX+".Table",o.defaultProps={defaultColumnWidth:150,defaultRowHeight:20,enableFocusedCell:!1,enableGhostCells:!1,enableMultipleSelection:!0,enableRowHeader:!0,forceRerenderOnSelectionChange:!1,loadingOptions:[],minColumnWidth:50,minRowHeight:20,numFrozenColumns:0,numFrozenRows:0,numRows:0,renderMode:RenderMode.BATCH_ON_UPDATE,rowHeaderCellRenderer:renderDefaultRowHeader,selectionModes:SelectionModes.ALL},o.childContextTypes=columnInteractionBarContextTypes,o.SHALLOW_COMPARE_PROP_KEYS_DENYLIST=["selectedRegions"],o.SHALLOW_COMPARE_STATE_KEYS_DENYLIST=["selectedRegions","viewportRect"],t=__decorate([HotkeysTarget,polyfill],o)}(AbstractComponent2);export{Table};