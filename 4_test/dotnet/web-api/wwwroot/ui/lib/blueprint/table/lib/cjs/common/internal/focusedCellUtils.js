"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.expandFocusedRegion=exports.toFullCoordinates=exports.isFocusedCellAtRegionRight=exports.isFocusedCellAtRegionLeft=exports.isFocusedCellAtRegionBottom=exports.isFocusedCellAtRegionTop=exports.getInitialFocusedCell=exports.getFocusedOrLastSelectedIndex=void 0;var tslib_1=require("tslib"),regions_1=require("../../regions"),Errors=tslib_1.__importStar(require("../errors"));function getFocusedOrLastSelectedIndex(e,o){return 0===e.length?void 0:null!=o?o.focusSelectionIndex:e.length-1}function getInitialFocusedCell(e,o,t,n){if(e){if(null!=o)return o;if(null!=t)return t;if(n.length>0){var s=n.length-1;return tslib_1.__assign(tslib_1.__assign({},regions_1.Regions.getFocusCellCoordinatesFromRegion(n[s])),{focusSelectionIndex:s})}return{col:0,row:0,focusSelectionIndex:0}}}function isFocusedCellAtRegionTop(e,o){return null!=e.rows&&o.row===e.rows[0]}function isFocusedCellAtRegionBottom(e,o){return null!=e.rows&&o.row===e.rows[1]}function isFocusedCellAtRegionLeft(e,o){return null!=e.cols&&o.col===e.cols[0]}function isFocusedCellAtRegionRight(e,o){return null!=e.cols&&o.col===e.cols[1]}function toFullCoordinates(e,o){return void 0===o&&(o=0),tslib_1.__assign(tslib_1.__assign({},e),{focusSelectionIndex:o})}function expandFocusedRegion(e,o){switch(regions_1.Regions.getRegionCardinality(o)){case regions_1.RegionCardinality.FULL_COLUMNS:var t=getExpandedRegionIndices(e,o,"col","cols"),n=t[0],s=t[1];return regions_1.Regions.column(n,s);case regions_1.RegionCardinality.FULL_ROWS:var i=getExpandedRegionIndices(e,o,"row","rows");return n=i[0],s=i[1],regions_1.Regions.row(n,s);case regions_1.RegionCardinality.CELLS:var r=getExpandedRegionIndices(e,o,"row","rows"),l=r[0],u=r[1],c=getExpandedRegionIndices(e,o,"col","cols"),d=c[0],g=c[1];return regions_1.Regions.cell(l,d,u,g);default:return regions_1.Regions.table()}}function getExpandedRegionIndices(e,o,t,n){var s=e[t],i=o[n],r=i[0];if(r!==i[1]){if("rows"===n)throw new Error(Errors.TABLE_EXPAND_FOCUSED_REGION_MULTI_ROW_REGION);if("cols"===n)throw new Error(Errors.TABLE_EXPAND_FOCUSED_REGION_MULTI_COLUMN_REGION)}return s<=r?[s,r]:[r,s]}exports.getFocusedOrLastSelectedIndex=getFocusedOrLastSelectedIndex,exports.getInitialFocusedCell=getInitialFocusedCell,exports.isFocusedCellAtRegionTop=isFocusedCellAtRegionTop,exports.isFocusedCellAtRegionBottom=isFocusedCellAtRegionBottom,exports.isFocusedCellAtRegionLeft=isFocusedCellAtRegionLeft,exports.isFocusedCellAtRegionRight=isFocusedCellAtRegionRight,exports.toFullCoordinates=toFullCoordinates,exports.expandFocusedRegion=expandFocusedRegion;