"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TableBody=void 0;var tslib_1=require("tslib"),classnames_1=tslib_1.__importDefault(require("classnames")),React=tslib_1.__importStar(require("react")),core_1=require("@blueprintjs/core"),Classes=tslib_1.__importStar(require("./common/classes")),contextMenuTargetWrapper_1=require("./common/contextMenuTargetWrapper"),renderMode_1=require("./common/renderMode"),menus_1=require("./interactions/menus"),selectable_1=require("./interactions/selectable"),regions_1=require("./regions"),tableBodyCells_1=require("./tableBodyCells"),DEEP_COMPARE_KEYS=["selectedRegions"],TableBody=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderContextMenu=function(e){var o=t.props,n=o.grid,r=o.onFocusedCell,l=o.onSelection,s=o.bodyContextMenuRenderer,i=o.selectedRegions,a=n.numRows,c=n.numCols;if(null!=s){var d=t.locateClick(e.nativeEvent),u=i;regions_1.Regions.findContainingRegion(i,d)<0&&(l(u=[d]),r(tslib_1.__assign(tslib_1.__assign({},regions_1.Regions.getFocusCellCoordinatesFromRegion(d)),{focusSelectionIndex:0})));var p=s(new menus_1.MenuContext(d,u,a,c));return null==p?void 0:p}},t.handleSelectionEnd=function(){t.activationCell=null},t.locateClick=function(e){return t.activationCell=t.props.locator.convertPointToCell(e.clientX,e.clientY),regions_1.Regions.cell(t.activationCell.row,t.activationCell.col)},t.locateDrag=function(e,o,n){void 0===n&&(n=!1);var r=t.activationCell,l=t.props.locator.convertPointToCell(o.current[0],o.current[1]);return n?regions_1.Regions.cell(l.row,l.col):regions_1.Regions.cell(r.row,r.col,l.row,l.col)},t}return tslib_1.__extends(t,e),t.cellClassNames=function(e,t){return tableBodyCells_1.cellClassNames(e,t)},t.prototype.shouldComponentUpdate=function(e){return!core_1.Utils.shallowCompareKeys(this.props,e,{exclude:DEEP_COMPARE_KEYS})||!core_1.Utils.deepCompareKeys(this.props,e,DEEP_COMPARE_KEYS)},t.prototype.render=function(){var e=this.props,t=e.grid,o=e.numFrozenColumns,n=e.numFrozenRows,r=t.getRect().sizeStyle(),l={height:null!=n?t.getCumulativeHeightAt(n-1):r.height,width:null!=o?t.getCumulativeWidthAt(o-1):r.width};return React.createElement(selectable_1.DragSelectable,{enableMultipleSelection:this.props.enableMultipleSelection,focusedCell:this.props.focusedCell,locateClick:this.locateClick,locateDrag:this.locateDrag,onFocusedCell:this.props.onFocusedCell,onSelection:this.props.onSelection,onSelectionEnd:this.handleSelectionEnd,selectedRegions:this.props.selectedRegions,selectedRegionTransform:this.props.selectedRegionTransform},React.createElement(contextMenuTargetWrapper_1.ContextMenuTargetWrapper,{className:classnames_1.default(Classes.TABLE_BODY_VIRTUAL_CLIENT,Classes.TABLE_CELL_CLIENT),renderContextMenu:this.renderContextMenu,style:l},React.createElement(tableBodyCells_1.TableBodyCells,{cellRenderer:this.props.cellRenderer,focusedCell:this.props.focusedCell,grid:t,loading:this.props.loading,onCompleteRender:this.props.onCompleteRender,renderMode:this.props.renderMode,columnIndexStart:this.props.columnIndexStart,columnIndexEnd:this.props.columnIndexEnd,rowIndexStart:this.props.rowIndexStart,rowIndexEnd:this.props.rowIndexEnd,viewportRect:this.props.viewportRect})))},t.defaultProps={loading:!1,renderMode:renderMode_1.RenderMode.BATCH},t}(core_1.AbstractComponent2);exports.TableBody=TableBody;