/*! For license information please see wijmo.grid.min.js.LICENSE.txt */
var wijmo,__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();!function(e){!function(t){"use strict";!function(e){e[e.AutoComplete=0]="AutoComplete",e[e.DropDownList=1]="DropDownList",e[e.RadioButtons=2]="RadioButtons"}(t.DataMapEditor||(t.DataMapEditor={}));var i=function(){function t(t,i,o){this._keyPath="",this._displayPath="",this._sortByVal=!0,this._editable=!1,this._serK=!0,this.mapChanged=new e.Event,!e.isArray(t)||i||o||(t=t.map((function(e){return{value:e}})),i=o="value"),this._cv=e.asCollectionView(t),this._keyPath=e.asString(i,!1),this._displayPath=e.asString(o,!1),this._cv.collectionChanged.addHandler(this.onMapChanged,this)}return Object.defineProperty(t.prototype,"sortByDisplayValues",{get:function(){return this._sortByVal},set:function(t){this._sortByVal=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serializeKeys",{get:function(){return this._serK},set:function(t){if((t=e.asBoolean(t))!==this._serK){var i=this._map,o=i&&i.size;this._map=null,this._serK=t,o&&this.onMapChanged(e.EventArgs.empty)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0}),t.prototype.getDataItem=function(t){var i=this;if(!this._map){var o=this._cv.sourceCollection,n=new e._Map(this.serializeKeys);e.isArray(o)&&this._keyPath&&o.forEach((function(e){var t=e[i._keyPath];n.has(t)||n.set(t,e)})),this._map=n}return this._map.get(t)},t.prototype.getDisplayValue=function(e){var t=this._displayPath,i=this.getDataItem(e);return t&&i?i[t]:e},t.prototype.getKeyValue=function(e,t){var i=this._displayPath,o=this._indexOf(e,i,t,!0);return o<0&&(o=this._indexOf(e,i,t,!1)),o>-1?this._cv.sourceCollection[o][this._keyPath]:null},t.prototype.getDisplayValues=function(e){var t=this;return this._cv&&this._displayPath?this._cv.items.map((function(e){return e[t._displayPath]})):[]},t.prototype.getKeyValues=function(){var e=this;return this._cv&&this._keyPath?this._cv.items.map((function(t){return t[e._keyPath]})):[]},Object.defineProperty(t.prototype,"isEditable",{get:function(){return this._editable},set:function(t){this._editable=e.asBoolean(t)},enumerable:!0,configurable:!0}),t.prototype.onMapChanged=function(e){this._map=null,this.mapChanged.raise(this,e)},t.prototype._indexOf=function(t,i,o,n){var r=-1,s=-1;if(this._cv&&i){var l=null!=t?t.toString():"";l&&o&&(t=e.toPlainText(l));for(var a=n?l:l.toLowerCase(),c=this._cv.sourceCollection,u=0;u<c.length;u++){var h=c[u],d=h[i];if(o&&e.isString(d)&&(d=e.toPlainText(d)),d==t?r=u:n||d.length!=a.length||d.toLowerCase()!=a?null!=d&&d.toString()==l&&(r=u):r=u,r==u){if(!this._cv.filter||this._cv.filter(h))return r;s<0&&(s=r)}}}return s},t}();t.DataMap=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function t(e,t,i,o){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===i&&(i=e),void 0===o&&(o=t),this.setRange(e,t,i,o)}return t.prototype.setRange=function(t,i,o,n){void 0===t&&(t=-1),void 0===i&&(i=-1),void 0===o&&(o=t),void 0===n&&(n=i),this._row=e.asInt(t),this._col=e.asInt(i),this._row2=e.asInt(o),this._col2=e.asInt(n)},Object.defineProperty(t.prototype,"row",{get:function(){return this._row},set:function(t){this._row=e.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},set:function(t){this._col=e.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=e.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=e.asInt(t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this._row,this._col,this._row2,this._col2)},t.prototype.copy=function(e){this.setRange(e._row,e._col,e._row2,e._col2)},Object.defineProperty(t.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0}),t.prototype.contains=function(i,o){var n=e.tryCast(i,t);if(n)return n.topRow>=this.topRow&&n.bottomRow<=this.bottomRow&&n.leftCol>=this.leftCol&&n.rightCol<=this.rightCol;if(e.isInt(i)&&e.isInt(o))return i>=this.topRow&&i<=this.bottomRow&&o>=this.leftCol&&o<=this.rightCol;throw"contains expects a CellRange or row/column indices."},t.prototype.containsRow=function(t){return e.asInt(t)>=this.topRow&&t<=this.bottomRow},t.prototype.containsColumn=function(t){return e.asInt(t)>=this.leftCol&&t<=this.rightCol},t.prototype.intersects=function(e){return this.intersectsRow(e)&&this.intersectsColumn(e)},t.prototype.intersectsRow=function(e){return e&&!(this.bottomRow<e.topRow||this.topRow>e.bottomRow)},t.prototype.intersectsColumn=function(e){return e&&!(this.rightCol<e.leftCol||this.leftCol>e.rightCol)},t.prototype.getRenderSize=function(t){var i=new e.Size(0,0);if(this.isValid){for(var o=this.topRow;o<=this.bottomRow;o++)i.height+=t.rows[o].renderSize;for(var n=this.leftCol;n<=this.rightCol;n++)i.width+=t.columns[n].renderSize}return i},t.prototype.equals=function(e){return e instanceof t&&this._row==e._row&&this._col==e._col&&this._row2==e._row2&&this._col2==e._col2},t.prototype.combine=function(e){return e?new t(Math.min(this.topRow,e.topRow),Math.min(this.leftCol,e.leftCol),Math.max(this.bottomRow,e.bottomRow),Math.max(this.rightCol,e.rightCol)):this},t.prototype.toString=function(){return e.format("({row}, {col})-({row2}, {col2})",this)},t}();t.CellRange=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None",e[e.Cell=1]="Cell",e[e.ColumnHeader=2]="ColumnHeader",e[e.RowHeader=3]="RowHeader",e[e.TopLeft=4]="TopLeft",e[e.ColumnFooter=5]="ColumnFooter",e[e.BottomLeft=6]="BottomLeft"}(i=t.CellType||(t.CellType={}));var o=function(){function o(i,o,n,r,s){this._offsetY=0,this._rng=new t.CellRange,this._g=e.asType(i,t.FlexGrid),this._ct=e.asInt(o),this._rows=e.asType(n,t.RowCollection),this._cols=e.asType(r,t.ColumnCollection),this._e=e.asType(s,HTMLElement),this._vrb=new t.CellRange}return Object.defineProperty(o.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"viewRange",{get:function(){return this._getViewRange()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),o.prototype.getCellData=function(o,n,r){var s,l=this._g,a=this._rows[e.asNumber(o,!1,!0)],c=null;if(!a)return null;n=this._toIndex(n),s=this._cols[e.asNumber(n,!1,!0)];var u=l?l._getBindingColumn(this,o,s):s,h=null;if(a instanceof t.GroupRow&&a.dataItem instanceof e.collections.CollectionViewGroup&&!l.childItemsPath&&(h=a.dataItem),u.binding&&a.dataItem&&!h?c=u._binding.getValue(a.dataItem):a._ubv&&(c=a._ubv[s._hash]),null==c){var d=i;switch(this._ct){case d.TopLeft:case d.ColumnHeader:o!=this._rows.length-1&&u==s||(c=u.header);break;case d.ColumnFooter:if(a instanceof t.GroupRow&&u.aggregate!=e.Aggregate.None){var p=this._g.collectionView;if(p){var g=e.tryCast(p,e.collections.CollectionView);c=g?g.getAggregate(u.aggregate,u.binding):e.getAggregate(u.aggregate,p.items,u.binding)}}break;case d.Cell:a instanceof t.GroupRow&&(n==this._cols.firstVisibleIndex?c=a.getGroupHeader():h&&u.aggregate!=e.Aggregate.None&&(c=h.getAggregate(u.aggregate,u.binding,this._g.collectionView)))}}if(r){var f=u.dataMap||a.dataMap;this.cellType==i.Cell&&f&&(c=f.getDisplayValue(c)),c=null!=c?e.Globalize.format(c,u.format||a.format):""}return c},o.prototype.setCellData=function(t,o,n,r,s){void 0===r&&(r=!0),void 0===s&&(s=!0);var l=this._g,a=this._rows[e.asNumber(t,!1,!0)],c=this._cols[e.asNumber(this._toIndex(o),!1,!0)],u=e.DataType;if(!a)return!1;var h=l?l._getBindingColumn(this,t,c):c,d=h.dataMap||a.dataMap;if(this._ct==i.Cell){var p=h.getIsRequired(a),g=h.isContentHtml||a.isContentHtml;if(d&&null!=n){var f=d.getKeyValue(n,g);if(null==f&&null==d.getDisplayValue(null)){if(d.getDisplayValue(n)!=n);else if(!d.isEditable||d.displayMemberPath!=d.selectedValuePath){if(""!=n||p)return!1;n=null}}else n=f}var _=u.Object,m=h.dataType||a.dataType,w=this.getCellData(t,o,!1);_=m||e.getType(w);var C=null==n||""===n&&!d;if(!p&&C)_!=u.String&&(n=null),r=!1;else if(p&&C&&r)return!1;if(r){var v=h.format||a.format;if(v||_!=u.Date||(v="d"),h.mask&&e.isString(n)&&_!=u.String&&(n=n.replace(/_/g,"")),n=e.changeType(n,_,v,w),_!=u.Object&&e.getType(n)!=_)return!1}}if(a.dataItem&&h.binding){var y=h._binding,b=a.dataItem,R=y.getValue(b);if(n!==R&&(d&&!d.serializeKeys||!e.DateTime.equals(n,R))){var E=l.collectionView,S=E instanceof e.collections.CollectionView&&b!=E.currentEditItem&&E.trackChanges,x=null;if(S&&(x=E._extend({},b)),y.setValue(b,n),S){var H=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,b,E.items.indexOf(b));E.onCollectionChanged(H),E._trackItemChanged(b,x)}}}else a._ubv||(a._ubv={}),a._ubv[c._hash]=n;return s&&l&&l.invalidate(),!0},o.prototype.getCellBoundingRect=function(t,i,o){var n=this._g,r=this.rows[t],s=this.columns[this._toIndex(i)],l=new e.Rect(s.pos,r.pos,s.renderSize,r.renderSize);if(n.rightToLeft&&(l.left=this.hostElement.clientWidth-l.right,e.isIE()||(l.left-=n._root.offsetWidth-n._root.clientWidth)),!o){var a=this.hostElement.getBoundingClientRect();l.left+=a.left,l.top+=a.top-this._offsetY}return t<this.rows.frozen&&(l.top-=n.scrollPosition.y),i<this.columns.frozen&&(l.left-=n.scrollPosition.x*(n.rightToLeft?-1:1)),l},o.prototype.getCellElement=function(e,t){var i=this.hostElement.children,n=Math.min(e+2,i.length);t=this._toIndex(t);for(var r=0;r<n;r++)for(var s=i[r].children,l=Math.min(t+2,s.length),a=0;a<l;a++){var c=s[a],u=c[o._INDEX_KEY];if(u&&(u.row==e&&u.col==t||u.rng&&u.rng.contains(e,t)))return c}return null},o.prototype.getSelectedState=function(e,o,n){var r=this._g,s=r.selectionMode,l=r._selHdl.selection,a=t.SelectionMode,c=t.SelectedState;if(s==a.None)return c.None;switch(o=this._toIndex(o),this._ct){case i.Cell:if(n||(n=r.getMergedRange(this,e,o)),n){if(n.contains(l.row,l.col))return r.showMarquee?c.Active:c.Cursor;if(n.intersects(l)&&s!=a.ListBox)return c.Selected;for(var u=n.leftCol;u<=n.rightCol;u++)if(r.columns[u].isSelected)return c.Selected;for(var h=n.topRow;h<=n.bottomRow;h++)if(r.rows[h].isSelected)return c.Selected}if(l.row==e&&l.col==o)return r.showMarquee?c.Active:c.Cursor;if(r.rows[e].isSelected||r.columns[o].isSelected)return c.Selected;if(s==a.MultiRange)for(var d=r._selHdl.extendedSelection,p=0;p<d.length;p++)if(d[p].contains(e,o)||n&&n.intersects(d[p]))return c.Selected;if(n)switch(s){case a.Row:case a.RowRange:if(n.containsRow(l.row))return c.Selected}return s==a.ListBox?c.None:(l=this._getAdjustedSelection(l)).containsRow(e)&&l.containsColumn(o)?c.Selected:c.None;case i.ColumnHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Column&&(r.columns[o].isSelected||l.containsColumn(o)||l.intersectsColumn(n))&&(n&&(e=n.bottomRow),e==this.rows.length-1))return c.Selected;break;case i.RowHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Row&&(r.rows[e].isSelected||l.containsRow(e)||l.intersectsRow(n))&&(n&&(o=n.rightCol),o==this.columns.length-1))return c.Selected}return c.None},Object.defineProperty(o.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),o.prototype._toIndex=function(t){if(e.isString(t)&&(t=this._cols.indexOf(t))<0)throw"Invalid column name or binding.";return t},o.prototype._getAdjustedSelection=function(e){var i=this._g,o=this._rng,n=t.SelectionMode;switch(i.selectionMode){case n.Cell:o.setRange(e.row,e.col,e.row,e.col);break;case n.Row:o.setRange(e.row,0,e.row,i.columns.length-1);break;case n.RowRange:case n.ListBox:o.setRange(e.row,0,e.row2,i.columns.length-1);break;default:o.copy(e)}return o},o.prototype._getOffsetY=function(){return this._offsetY},o.prototype._updateContent=function(o,n,r){var s=this._g,l=this._e,a=this._rows,c=this._cols,u=this._ct;if(u==i.ColumnHeader||u==i.ColumnFooter||u==i.RowHeader){var h=s._ptScrl,d=l.style;u==i.RowHeader?d.top=h.y+"px":s.rightToLeft?d.right=h.x+"px":d.left=h.x+"px"}this._offsetY!=r&&(o=!1,this._offsetY=r);var p=this._getViewRange(),g=p;if(g.isValid){var f=a.length<=s._vtRows?a.length:0,_=c.length<=s._vtCols?c.length:0;g=new t.CellRange(Math.max(p.row-f,a.frozen),Math.max(p.col-_,c.frozen),Math.min(p.row2+f,a.length-1),Math.min(p.col2+_,c.length-1))}if(o&&!n&&this._vrb.contains(p)&&!a.frozen&&!c.frozen)return this._activeCell;o&&g.equals(this._vrb)||(n=!1),o&&!n&&this._ct!=i.TopLeft&&this._reorderCells(g,this._vrb),this._activeCell=null,this._vru=p,this._vrb=g,this._recycle=o;var m=0;this._ct==i.Cell&&(m=this._renderColHdrRow(g,n));for(var w=0;w<a.frozen&&w<a.length;w++)m=this._renderRow(w,g,n,m);for(w=g.topRow;w<=g.bottomRow&&w>-1;w++)m=this._renderRow(w,g,n,m);for(;l.childElementCount>m;){var C=l.lastElementChild;e.removeChild(C),this._removeExtraCells(C,0)}return this._activeCell},o.prototype._clearCells=function(){for(var t=this.hostElement,i=this._g.cellFactory,o=t.childElementCount-1;o>=0;o--){var n=t.children[o];e.removeChild(n);for(var r=n.childElementCount-1;r>=0;r--)i.disposeCell(n.children[r])}},o.prototype._reorderCells=function(t,o){var n=this;if(this._g._reorderCells&&o.isValid&&t.isValid&&t.intersects(o)){var r,s=function(t,i,o,r,s,l){e.assert(o<0,"Scroll delta must be a negative number");var a,c,u=-o,h=i+(r-s+1),d=t.childElementCount-h;if(d<u?(a=d,c=u-d):(a=u,c=0),a>0){var p=n._createRange(t,h,h+a);p&&t.insertBefore(p.extractContents(),t.children[i])}if(c>0)for(var g=t.children[i],f=0;f<c;f++){var _=document.createElement("div");_.className=l,t.insertBefore(_,g)}};if(t.row!=o.row){var l=this._e;if(0!=(r=t.row-o.row)){var a=this._ct==i.Cell?1:0,c=l.childElementCount;if(a+=this.rows.frozen,r>0){var u=a,h=Math.min(a+r,c);(g=this._createRange(l,u,h))&&l.appendChild(g.extractContents())}else s(l,a,r,t.row2,o.row,"wj-row")}}if(t.col!=o.col&&(l=this._e,0!=(r=t.col-o.col))){a=this._ct==i.Cell&&this._g.rowHeaderPath?1:0,a+=this.columns.frozen;for(var d=0;d<l.children.length;d++){var p=l.children[d];if(c=p.children.length,e.hasClass(p,"wj-row"))if(r>0){var g;u=a,h=Math.min(a+r,c),(g=this._createRange(p,u,h))&&p.appendChild(g.extractContents())}else s(p,a,r,t.col2,o.col,"wj-cell")}}}},o.prototype._createRange=function(e,t,i){if(i>t&&i<=e.children.length&&t>-1){this._docRange||(this._docRange=document.createRange());var o=this._docRange;return o.setStart(e,t),o.setEnd(e,i),o}return null},o.prototype._renderColHdrRow=function(t,i){if(i)return 1;var o=this._e.children[0];o||(o=e.createElement('<div class="wj-row" role="row"></div>',this._e));var n=this._g,r=n?n.columnHeaders.rows.ariaLabel:null;e.setAttribute(o,"aria-label",r),e.setAttribute(o,"aria-selected",null);var s=0,l=this._g._getRowHeaderPath();l&&(s=this._renderRowHdrCell(o,-1,l.path));for(var a=0;a<this.columns.frozen&&a<this.columns.length;a++)s=this._renderColHdrCell(o,a,t,i,s);for(a=t.leftCol;a<=t.rightCol&&a>-1;a++)s=this._renderColHdrCell(o,a,t,i,s);return this._removeExtraCells(o,s),1},o.prototype._renderColHdrCell=function(t,i,n,r,s){var l=this.grid,a=this.columns[i];if(a.renderSize<=0)return s;if(r)return s+1;var c=t.children[s];if(c||(c=e.createElement(o._HTML_CELL,t)),e.setAttribute(c,"role","columnheader"),c&&this._recycle&&l._lazyRender){var u=c[o._INDEX_KEY];if(u&&-1==u.row&&u.col==i&&i>=this.columns.frozen)return s+1}if(c.textContent=this.columns[i].header,e.setCss(c,{position:"fixed",left:a.pos,top:-32e3,width:a.renderSize,height:.1,overflow:"hidden",opacity:"0",pointerEvents:"none"}),a.describedById||this.columns.describedById){var h=[a.describedById,this.columns.describedById].join(" ").trim();e.setAttribute(c,"aria-describedby",h||null)}if(l.allowSorting){var d="none";switch(l._getBindingColumn(this,0,a).currentSort){case"+":d="ascending";break;case"-":d="descending"}e.setAttribute(c,"aria-sort",d)}return l.isReadOnly||(e.setAttribute(c,"aria-readonly",a.isReadOnly),e.setAttribute(c,"aria-required",a.getIsRequired())),c[o._INDEX_KEY]={row:-1,col:i,panel:this},s+1},o.prototype._renderRowHdrCell=function(t,i,n){var r=t.children[0];return r||(r=e.createElement(o._HTML_CELL,t)),r.setAttribute("role",i<0?"columnheader":"rowheader"),r.textContent=n?n.toString():"",e.setCss(r,{position:"fixed",left:-32e3,top:-32e3,width:.1,height:.1,overflow:"hidden",opacity:"0"}),r[o._INDEX_KEY]={row:i,col:-1,panel:this},1},o.prototype._renderRow=function(o,n,r,s){var l=this._g,a=this.rows[o];if(a.renderSize<=0)return s;var c=this._e.children[s];if(c||(c=e.createElement('<div class="wj-row"></div>',this._e)),this._ct==i.Cell){c.setAttribute("role","row");var u=t.SelectionMode,h=a.isSelected;switch(l.selectionMode){case u.Row:case u.RowRange:h=h||this._g._selHdl.selection.containsRow(o)}e.setAttribute(c,"aria-selected",!!h||null),e.setAttribute(c,"aria-level",a instanceof t.GroupRow?a.level+1:null),e.setAttribute(c,"aria-expanded",a instanceof t.GroupRow?!a.isCollapsed:null),this.rows.ariaLabel&&e.setAttribute(c,"aria-label",this.rows.ariaLabel)}var d=0;if(this._ct==i.Cell){var p=this._g._getRowHeaderPath();p&&(d=this._renderRowHdrCell(c,o,p.getValue(a.dataItem)))}for(var g=0;g<this.columns.frozen&&g<this.columns.length;g++)d=this._renderCell(c,o,g,n,r,d);for(g=n.leftCol;g<=n.rightCol&&g>-1;g++)d=this._renderCell(c,o,g,n,r,d);return this._removeExtraCells(c,d),s+1},o.prototype._renderCell=function(n,r,s,l,a,c){var u=this._g,h=u.getMergedRange(this,r,s);if(h){for(var d=Math.max(l.row,h.row);d<r;d++)if(this.rows[d].renderSize)return c;for(d=Math.max(l.col,h.col);d<s;d++)if(this.columns[d].renderSize)return c;var p=this.columns.frozen;if(p&&h.col<p&&h.col2>=p&&s>h.col)return c}var g=this.columns[s];if(g.renderSize<=0&&(!h||h.getRenderSize(this).width<=0))return c;var f=n.children[c];if(f&&!a&&this._recycle&&u._lazyRender&&!u.activeEditor){var _=f[o._INDEX_KEY];_&&_.row==r&&_.col==s&&_.rng==h&&r>=this.rows.frozen&&s>=this.columns.frozen&&(a=!0)}var m=t.SelectedState,w=this.getSelectedState(r,s,h),C=w==m.Cursor||w==m.Active;return f&&a?(e.toggleClass(f,"wj-state-active",C),e.toggleClass(f,"wj-state-selected",w==m.Cursor),e.toggleClass(f,"wj-state-multi-selected",w==m.Selected),e.setAttribute(f,"aria-selected",!(!C&&w==m.None)||null),C&&(this._activeCell=f),c+1):(f||(f=e.createElement(o._HTML_CELL,n)),C&&(this._activeCell=f),this._ct==i.Cell&&(e.setAttribute(f,"role","gridcell"),e.setAttribute(f,"aria-selected",!(w==m.None&&!C)||null),e.setAttribute(f,"aria-readonly",!u.canEditCell(r,s)||null),e.setAttribute(f,"aria-required",g.getIsRequired())),u.cellFactory.updateCell(this,r,s,f,h),f[o._INDEX_KEY]={row:r,col:s,rng:h,panel:this},c+1)},o.prototype._removeExtraCells=function(t,i){for(var o=this._g.cellFactory;t.childElementCount>i;){var n=t.lastElementChild;e.removeChild(n),o.disposeCell(n)}},o.prototype._getViewRange=function(){var e=this._g,o=e._ptScrl,n=e._szClientSB,r=this._rows,s=this._cols,l=new t.CellRange(0,0,r.length-1,s.length-1);if(this._ct==i.Cell||this._ct==i.RowHeader){var a=-o.y+this._offsetY,c=n.height;(p=Math.min(r.frozen,r.length-1))>0&&(a+=g=r[p-1].pos,c-=g),p>0&&r[p].pos>n.height?l.row=l.row2=-1:(l.row=Math.min(r.length-1,Math.max(p,r.getItemAt(a))),l.row2=Math.max(l.row,r.getItemAt(a+c)));var u=e.hostElement;if(e._clipToScreen&&u){var h=u.getBoundingClientRect(),d=-h.top-e.cells._e.offsetTop;h.top<0&&(l.row=Math.max(l.row,r.getItemAt(d)-1)),h.bottom>innerHeight&&(l.row2=Math.min(l.row2,r.getItemAt(d+innerHeight)+1))}}if(this._ct==i.Cell||this._ct==i.ColumnHeader){var p,g,f=-o.x,_=n.width;(p=Math.min(s.frozen,s.length-1))>0&&(f+=g=s[p-1].pos,_-=g),p>0&&s[p].pos>n.width?l.col=l.col2=-1:(l.col=Math.min(s.length-1,Math.max(p,s.getItemAt(f))),l.col2=Math.max(l.col,s.getItemAt(f+_)))}return r.length<=r.frozen&&(l.row=l.row2=-1),s.length<=s.frozen&&(l.col=l.col2=-1),l},o.prototype._getFrozenPos=function(){var t=this._rows.frozen,i=this._cols.frozen,o=t>0?this._rows[t-1]:null,n=i>0?this._cols[i-1]:null,r=o?o.pos+o.renderSize:0,s=n?n.pos+n.renderSize:0;return new e.Point(s,r)},o._INDEX_KEY="wj-cell-index",o._HTML_CELL='<div class="wj-cell" tabindex="-1"></div>',o}();t.GridPanel=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(i){function o(o,n,r){var s=i.call(this)||this;return s._p=e.asType(o,t.GridPanel,!0),s._rng=e.asType(n,t.CellRange,!0),s._data=r,s}return __extends(o,i),Object.defineProperty(o.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),o.prototype.getRow=function(){return this._p&&this.row>-1?this._p.rows[this.row]:null},o.prototype.getColumn=function(e){var i=this._p,o=i&&this.col>-1?i.columns[this.col]:null;if(o&&e){var n=i.grid;o=i.cellType===t.CellType.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this.row,this.col):i.grid._getBindingColumn(i,this.row,o)}return o},o}(e.CancelEventArgs);t.CellRangeEventArgs=i;var o=function(t){function i(i,o,n,r){void 0===r&&(r=!0);var s=t.call(this,i,o)||this;return s._updateContent=!0,s._cell=e.asType(n,HTMLElement),s}return __extends(i,t),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"updateContent",{get:function(){return this._updateContent},enumerable:!0,configurable:!0}),i}(i);t.FormatItemEventArgs=o;var n=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._stayInEditMode=!1,e._refresh=!0,e}return __extends(i,t),Object.defineProperty(i.prototype,"stayInEditMode",{get:function(){return this._stayInEditMode},set:function(t){this._stayInEditMode=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"refresh",{get:function(){return this._refresh},set:function(t){this._refresh=e.asBoolean(t)},enumerable:!0,configurable:!0}),i}(i);t.CellEditEndingEventArgs=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i,o;!function(e){e[e.None=0]="None",e[e.Cell=1]="Cell",e[e.CellRange=2]="CellRange",e[e.Row=3]="Row",e[e.RowRange=4]="RowRange",e[e.ListBox=5]="ListBox",e[e.MultiRange=6]="MultiRange"}(i=t.SelectionMode||(t.SelectionMode={})),function(e){e[e.None=0]="None",e[e.Selected=1]="Selected",e[e.Cursor=2]="Cursor",e[e.Active=3]="Active"}(t.SelectedState||(t.SelectedState={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Prev=2]="Prev",e[e.NextPage=3]="NextPage",e[e.PrevPage=4]="PrevPage",e[e.Home=5]="Home",e[e.End=6]="End",e[e.NextCell=7]="NextCell",e[e.PrevCell=8]="PrevCell",e[e.NextEditableCell=9]="NextEditableCell",e[e.PrevEditableCell=10]="PrevEditableCell"}(o=t.SelMove||(t.SelMove={}));var n=function(){function n(o){this._sel=new t.CellRange(0,0),this._xSel=new e.collections.ObservableArray,this._mode=i.CellRange,this._g=o,this._e=new t.CellRangeEventArgs(o.cells,new t.CellRange(0,0)),this._xSel.collectionChanged.addHandler((function(){o.invalidate()}))}return Object.defineProperty(n.prototype,"selectionMode",{get:function(){return this._mode},set:function(e){e!=this._mode&&this._setSelectionMode(e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this._sel},set:function(e){this.select(e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"extendedSelection",{get:function(){return this._xSel},enumerable:!0,configurable:!0}),n.prototype.select=function(o,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1);var s=this._g,l=this._e.range,a=this._sel,c=l,u=!1,h=i;if(e.isNumber(o)&&e.isString(n)){var d=s.columns.indexOf(n);if(d<0)throw"Invalid column name or binding.";l.setRange(o,d),n=!0}else e.isNumber(o)&&e.isNumber(n)?(l.setRange(o,n),n=!0):o instanceof t.CellRange?l.copy(o):e.assert(!1,"CellRange expected");switch(s.selectionMode){case h.Cell:c.row2=c.row,c.col2=c.col;break;case h.Row:c.row2=c.row;break;case h.ListBox:u=!0}var p=c.equals(a);if(p&&u)for(var g=0;g<s.rows.length;g++)if(s.rows[g].isSelected!==c.containsRow(g)){p=!1;break}if(p&&s.isRangeValid(c))return n&&this._showSelection(),!0;var f=e.Control.getControl(e.closest(e.getActiveElement(),".wj-flexgrid"));if(f&&f.activeEditor&&!f.finishEditing())return!1;var _=this._e;if(_._rng=c,_.cancel=!1,!s.onSelectionChanging(_)&&!r)return!1;u&&s.rows.forEach((function(e,i){e._setFlag(t.RowColFlags.Selected,c.containsRow(i),!0)})),c.row=Math.min(c.row,s.rows.length-1),c.row2=Math.min(c.row2,s.rows.length-1),this._sel.copy(c),s.refreshCells(!1,!0,!0),n&&this._showSelection();var m=s.collectionView;if(m){var w=s._getCvIndex(c.row);m.moveCurrentToPosition(w)}return s.onSelectionChanged(_),!0},n.prototype.moveSelection=function(e,i,n){var r=this._g,s=this._sel,l=n&&r.anchorCursor?new t.CellRange(s.row2,s.col2):new t.CellRange(s.row,s.col);this._adjustReferenceCell(l,e,i);var a=l.row,c=l.col,u=r.rows,h=r.columns,d=Math.max(0,r._szClient.height-r.columnHeaders.height),p=o;switch(i){case p.NextCell:case p.NextEditableCell:(c=h.getNextCell(c,i))==l.col&&(a=u.getNextCell(a,i))>l.row&&(c=h.getNextCell(0,i),c=h.getNextCell(c,i==p.NextCell?p.PrevCell:p.PrevEditableCell)),r.select(a,c);break;case p.PrevCell:case p.PrevEditableCell:(c=h.getNextCell(l.col,i))==l.col&&(a=u.getNextCell(a,i))<l.row&&(c=h.getNextCell(h.length-1,i),c=h.getNextCell(c,i==p.PrevCell?p.NextCell:p.NextEditableCell)),r.select(a,c);break;default:a=u.getNextCell(a,e,d),c=h.getNextCell(c,i,d),n?r.selection=r.anchorCursor?new t.CellRange(s.row,s.col,a,c):new t.CellRange(a,c,s.row2,s.col2):r.select(a,c)}},n.prototype._setSelectionMode=function(e){var o=this._g,n=o.rows,r=i;if(e==r.ListBox||this._mode==r.ListBox)for(var s=0;s<n.length;s++){var l=e==r.ListBox&&this._sel.containsRow(s);n[s]._setFlag(t.RowColFlags.Selected,l,!0)}this._mode=e,this._xSel.clear(),n.length&&(l=this._sel,l=e!=r.None?new t.CellRange(l.row,l.col):new t.CellRange,this.select(l,!1,!0),o.invalidate())},n.prototype._expandSelection=function(){var e=this._g,o=e.selectionMode;if(e.expandSelectionOnCopyPaste&&o){var n=this.selection,r=i;switch(o){case r.Cell:case r.Row:break;case r.ListBox:this._expandSelectedRows();break;case r.RowRange:n=new t.CellRange(n.topRow,0,n.bottomRow,e.columns.length-1);default:var s=this._expandSelectionRange(n);s&&this.select(s,!1)}}},n.prototype._deselectRange=function(e){var i=this.selection,o=this.extendedSelection;if(i.contains(e)){var n=o.length;return this._sel=n?o[n-1]:new t.CellRange,n&&o.removeAt(n-1),!0}for(var r=0;r<o.length;r++)if(o[r].contains(e))return o.removeAt(r),!0;return!1},n.prototype._expandSelectedRows=function(){e.assert(this.selectionMode==i.ListBox,"ListBox mode expected");for(var o=this._g,n=o.selectedRows.map((function(e){return e.index})),r=[],s=0;s<n.length;s++)for(var l=new t.CellRange(n[s],0,n[s],o.columns.length-1),a=this._expandSelectionRange(l)||l,c=a.topRow;c<=a.bottomRow;c++)-1===r.indexOf(c)&&r.push(c);r.sort(),this._selectRows(r)},n.prototype._expandSelectionRange=function(e){var i=this._g,o=i.cells,n=i.getMergedRange(o,e.topRow,e.leftCol,!1),r=i.getMergedRange(o,e.bottomRow,e.leftCol,!1),s=i.getMergedRange(o,e.topRow,e.rightCol,!1),l=i.getMergedRange(o,e.bottomRow,e.rightCol,!1);return n||r||s||l?(n=n||new t.CellRange(e.topRow,e.leftCol),r=r||new t.CellRange(e.bottomRow,e.leftCol),s=s||new t.CellRange(e.topRow,e.rightCol),l=l||new t.CellRange(e.bottomRow,e.rightCol),new t.CellRange(Math.min(n.topRow,r.topRow,s.topRow,l.topRow),Math.min(n.leftCol,r.leftCol,s.leftCol,l.leftCol),Math.max(n.bottomRow,r.bottomRow,s.bottomRow,l.bottomRow),Math.max(n.rightCol,r.rightCol,s.rightCol,l.rightCol))):null},n.prototype._selectRows=function(t){e.assert(this.selectionMode==i.ListBox,"ListBox mode expected");for(var o=this._g,n=0,r=!0;n<o.rows.length;n++){var s=o.rows[n],l=t&&t.indexOf(s.index)>-1;l&&r&&(r=!1,this.select(n,this.selection.col)),s.isSelected=l}},n.prototype._showSelection=function(){var e=this._g,t=this._sel;e.anchorCursor?e.scrollIntoView(t.row2,t.col2):e.scrollIntoView(t.row,t.col)},n.prototype._adjustReferenceCell=function(e,t,i){var n=this._g,r=n.getMergedRange(n.cells,e.row,e.col);if(r&&!r.isSingleCell){var s=o;switch(t){case s.Next:case s.NextCell:case s.NextEditableCell:e.row=r.bottomRow;break;case s.Prev:case s.PrevCell:case s.PrevEditableCell:e.row=r.topRow}switch(i){case s.Next:case s.NextCell:case s.NextEditableCell:e.col=r.rightCol;break;case s.Prev:case s.PrevCell:case s.PrevEditableCell:e.col=r.leftCol}}},n}();t._SelectionHandler=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i;!function(e){e[e.Visible=1]="Visible",e[e.AllowResizing=2]="AllowResizing",e[e.AllowDragging=4]="AllowDragging",e[e.AllowMerging=8]="AllowMerging",e[e.AllowSorting=16]="AllowSorting",e[e.AutoGenerated=32]="AutoGenerated",e[e.Collapsed=64]="Collapsed",e[e.ParentCollapsed=128]="ParentCollapsed",e[e.Selected=256]="Selected",e[e.ReadOnly=512]="ReadOnly",e[e.HtmlContent=1024]="HtmlContent",e[e.WordWrap=2048]="WordWrap",e[e.MultiLine=4096]="MultiLine",e[e.HasTemplate=8192]="HasTemplate",e[e.RowDefault=3]="RowDefault",e[e.ColumnDefault=23]="ColumnDefault"}(i=t.RowColFlags||(t.RowColFlags={}));var o=function(){function o(){this._type=null,this._align=null,this._inpType=null,this._mask=null,this._maxLen=null,this._required=null,this._fmt=null,this._map=null,this._ddCssClass=null,this._cssClass=null,this._cssClassAll=null,this._szMin=null,this._szMax=null,this._sz=null,this._pos=0,this._idx=-1,this._idxVis=-1,this._idxData=-1,this.gridChanged=new e.Event}return Object.defineProperty(o.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){if(t!=this.binding){var i=e.asString(t);if(this._binding=i?new e.Binding(i):null,!this._type&&this.grid&&this._binding){var o=this.grid.collectionView;if(o&&o.sourceCollection&&o.sourceCollection.length){var n=o.sourceCollection[0];this._type=e.getType(this._binding.getValue(n))}}this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(t){if(t!=this.sortMemberPath){var i=e.asString(t);this._bindingSort=i?new e.Binding(i):null,this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dataType",{get:function(){return this._type},set:function(t){t=e.asEnum(t,e.DataType,!0),this._type!=t&&(this._type=t,this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=e.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=e.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"maxLength",{get:function(){return this._maxLen},set:function(t){this._maxLen=e.asNumber(t,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"align",{get:function(){return this._align},set:function(e){this._align!=e&&(this._align=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"format",{get:function(){return this._fmt},set:function(e){this._fmt!=e&&(this._fmt=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map!=i&&(this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this),e.isArray(i)&&(i=new t.DataMap(i,null,null)),this._map=e.asType(i,t.DataMap,!0),this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dataMapEditor",{get:function(){return null!=this._mapEditor?this._mapEditor:t.DataMapEditor.DropDownList},set:function(i){i!=this._mapEditor&&(this._mapEditor=e.asEnum(i,t.DataMapEditor),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"showDropDown",{get:function(){return this.dataMapEditor==t.DataMapEditor.DropDownList},set:function(i){e._deprecated("showDropDown","dataMapEditor"),this.dataMapEditor=i?t.DataMapEditor.DropDownList:t.DataMapEditor.AutoComplete},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dropDownCssClass",{get:function(){return this._ddCssClass},set:function(t){this._ddCssClass=e.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"visible",{get:function(){return this._getFlag(i.Visible)},set:function(e){this._setFlag(i.Visible,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isVisible",{get:function(){return!!this._getFlag(i.Visible)&&(!this._getFlag(i.ParentCollapsed)||this instanceof t._NewRowTemplate)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pos",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"index",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"visibleIndex",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this.isVisible?this._idxVis:-1},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this._sz},set:function(t){t!=this._sz&&(this._sz=e.asNumber(t,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"renderSize",{get:function(){var e=0,t=this._list;return this.isVisible&&((null==(e=this._sz)||e<0)&&(e=t?t.defaultSize:0),t&&null!=t.minSize&&e<t.minSize&&(e=t.minSize),t&&null!=t.maxSize&&e>t.maxSize&&(e=t.maxSize),null!=this._szMin&&e<this._szMin&&(e=this._szMin),null!=this._szMax&&e>this._szMax&&(e=this._szMax)),e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"allowResizing",{get:function(){return this._getFlag(i.AllowResizing)},set:function(e){this._setFlag(i.AllowResizing,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"allowDragging",{get:function(){return this._getFlag(i.AllowDragging)},set:function(e){this._setFlag(i.AllowDragging,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"allowMerging",{get:function(){return this._getFlag(i.AllowMerging)},set:function(e){this._setFlag(i.AllowMerging,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSelected",{get:function(){return this._getFlag(i.Selected)},set:function(e){if(!!e!=this.isSelected){var o=this.grid;if(o){var n=this instanceof r?new t.CellRange(this.index,-1):new t.CellRange(-1,this.index),s=new t.CellRangeEventArgs(o?o.cells:null,n);o.onSelectionChanging(s)&&this._setFlag(i.Selected,e,!0)&&(o.refreshCells(!1,!0,!0),o.onSelectionChanged(s))}else this._setFlag(i.Selected,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isReadOnly",{get:function(){return this._getFlag(i.ReadOnly)},set:function(e){this._setFlag(i.ReadOnly,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isRequired",{get:function(){return this._required},set:function(t){this._required=e.asBoolean(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isContentHtml",{get:function(){return this._getFlag(i.HtmlContent)},set:function(e){this.isContentHtml!=e&&(this._setFlag(i.HtmlContent,e),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"wordWrap",{get:function(){return this._getFlag(i.WordWrap)},set:function(e){this._setFlag(i.WordWrap,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"multiLine",{get:function(){return this._getFlag(i.MultiLine)},set:function(e){this._setFlag(i.MultiLine,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t!=this._cssClass&&(this._cssClass=e.asString(t),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"cssClassAll",{get:function(){return this._cssClassAll},set:function(t){t!=this._cssClassAll&&(this._cssClassAll=e.asString(t),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"collectionView",{get:function(){return this.grid?this.grid.collectionView:null},enumerable:!0,configurable:!0}),o.prototype.onPropertyChanged=function(){this._list&&(this._list._dirty=!0,this.grid.invalidate())},o.prototype.onGridChanged=function(e){this.gridChanged.raise(this,e)},o.prototype._setList=function(e){e!=this._list&&(this._list=e,this.onGridChanged())},o.prototype._getFlag=function(e){return 0!=(this._f&e)},o.prototype._setFlag=function(e,t,i){return!!t!=this._getFlag(e)&&(this._f=t?this._f|e:this._f&~e,i||this.onPropertyChanged(),!0)},o}();t.RowCol=o;var n=function(o){function n(t){var r=o.call(this)||this;return r._hdr=null,r._name=null,r._agg=null,r._quickSize=null,r._descById=null,r._tpl=null,r._f=i.ColumnDefault,r._hash=n._ctr.toString(36),n._ctr++,e.copy(r,t),r}return __extends(n,o),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return null!=this._szStar?this._szStar:this.size},set:function(t){null!=n._parseStarSize(t)?(this._szStar=t,this.onPropertyChanged()):(this._szStar=null,this.size=e.asNumber(t,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=e.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=e.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0}),n.prototype._getQuickAutoSize=function(){return!!this.grid._getQuickAutoSize()&&(e.isBoolean(this._quickSize)?this._quickSize:!(this.isContentHtml||this.wordWrap||this.multiLine||this._getFlag(i.HasTemplate)))},Object.defineProperty(n.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(e){this._hdr!=e&&(this._hdr=e,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellTemplate",{get:function(){return this._tpl},set:function(t){t!=this._tpl&&(e.assert(null==t||e.isString(t)||e.isFunction(t),"cellTemplate should be a string or an ICellTemplateFunction."),this._tpl=t,this._setFlag(i.HasTemplate,null!=t&&""!=t),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editor",{get:function(){var e=this._edt;return e?e.control:null},set:function(i){i!=this.editor&&(this._edt&&(this._edt.dispose(),this._edt=null),null!=i&&(i=e.asType(i,e.Control),this._edt=new t._CustomEditor(this,i)))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allowSorting",{get:function(){return this._getFlag(i.AllowSorting)},set:function(e){this._setFlag(i.AllowSorting,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSort",{get:function(){var e=this.currentSortIndex;return e>-1?this.grid.collectionView.sortDescriptions[e].ascending?"+":"-":null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSortIndex",{get:function(){var e=this.grid?this.grid.collectionView:null,t=e?e.sortDescriptions:null,i=t&&t.length?this._getBindingSort():null;if(i)for(var o=0;o<t.length;o++)if(t[o].property==i)return o;return-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"aggregate",{get:function(){return null!=this._agg?this._agg:e.Aggregate.None},set:function(t){(t=e.asEnum(t,e.Aggregate))!=this._agg&&(this._agg=t,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"describedById",{get:function(){return this._descById},set:function(t){t!=this._descById&&(this._descById=e.asString(t),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),n.prototype.getIsRequired=function(t){return null!=this._required?this._required:t&&null!=t.isRequired?t.isRequired:this.dataType==e.DataType.String?null!=this.dataMap||null!=this._mask&&this._mask.length>0:!t||t.dataType!=e.DataType.String||null!=t.dataMap||null!=t.mask&&t.mask.length>0},n.prototype.getAlignment=function(t){if(null!=this._align)return this._align;if(t&&null!=t.align)return t.align;if(!this._map)switch(this.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}if(t&&!t.dataMap)switch(t.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}return""},n.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null},n._parseStarSize=function(t){if(e.isString(t)){var i=t.length;if(i>0&&"*"==t[i-1]){var o=1==i?1:parseFloat(t);if(o>0&&!isNaN(o))return o}}return null},n._ctr=0,n}(o);t.Column=n;var r=function(e){function t(t){var o=e.call(this)||this;return o._f=i.ColumnDefault,o._data=t||null,o}return __extends(t,e),Object.defineProperty(t.prototype,"dataItem",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataIndex",{get:function(){return this._list&&this._list._dirty&&this._list._update(),this._idxData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),t}(o);t.Row=r;var s=function(o){function n(t){var i=o.call(this,t)||this;return i._level=-1,i.level=t instanceof e.collections.CollectionViewGroup?t.level:-1,i.isReadOnly=!0,i}return __extends(n,o),Object.defineProperty(n.prototype,"level",{get:function(){return this._level},set:function(t){e.asInt(t),t!=this._level&&(this._level=t,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasChildren",{get:function(){if(null!=this.grid&&null!=this._list){this._list._update();var i=this.index<this._list.length-1?this._list[this.index+1]:null,o=e.tryCast(i,n),r=e.tryCast(i,t._NewRowTemplate);return null!=i&&null==r&&(null==o||o.level>this.level)}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCollapsed",{get:function(){return this._getFlag(i.Collapsed)},set:function(t){!!t!=this.isCollapsed&&null!=this._list&&this._setCollapsed(e.asBoolean(t))},enumerable:!0,configurable:!0}),n.prototype.getGroupHeader=function(){var t=this.grid,i=t.groupHeaderFormat||e.culture.FlexGrid.groupHeaderFormat,o=this.dataItem;if(o instanceof e.collections.CollectionViewGroup&&i&&t.showGroups&&!t.childItemsPath){var n=o.groupDescription.propertyName,r=o.name,s=t.getColumn(n),l=this.isContentHtml;if(s){l=l||s.isContentHtml,s.header&&(n=s.header);var a=s.dataMap;a&&(r=a.getDisplayValue(r)),s.dataType==e.getType(r)&&(r=e.Globalize.format(r,s.format))}else n=e.toHeaderCase(n);var c=o.getAggregate(e.Aggregate.CntAll,null,t.collectionView);return e.format(i,{name:e.escapeHtml(n),value:l?r:e.escapeHtml(r),level:o.level,count:c})}return""},n.prototype._setCollapsed=function(e){var o=this,r=this.grid,s=r.rows,l=this.getCellRange(),a=new t.CellRangeEventArgs(r.cells,new t.CellRange(this.index,-1));r.onGroupCollapsedChanging(a)&&(r.deferUpdate((function(){s.deferUpdate((function(){o._setFlag(i.Collapsed,e,!0);for(var t=l.topRow+1;t<=l.bottomRow&&t>-1&&t<s.length;t++){s[t]._setFlag(i.ParentCollapsed,e,!0);var r=s[t];r instanceof n&&r.isCollapsed&&(t=r.getCellRange().bottomRow)}}))})),r.onGroupCollapsedChanged(a))},n.prototype.getCellRange=function(){for(var e=this._list,i=this.index,o=e.length-1,r=i+1;r<=o;r++){var s=e[r];if(s instanceof n&&s.level<=this.level){o=r-1;break}}return new t.CellRange(i,0,o,this.grid.columns.length-1)},n}(r);t.GroupRow=s;var l=function(i){function n(o,n){var r=i.call(this)||this;return r._frozen=0,r._lastFrozen=-1,r._firstVisible=-1,r._vlen=0,r._szDef=28,r._szTot=0,r._szCustom=!1,r._dirty=!1,r._g=e.asType(o,t.FlexGrid),r._szDef=e.asNumber(n,!1,!0),r}return __extends(n,i),Object.defineProperty(n.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szCustom=!0,this._szDef!=t&&(this._szDef=e.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"frozen",{get:function(){return this._frozen},set:function(t){t!=this._frozen&&(this._frozen=e.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),n.prototype.isFrozen=function(e){return e<this.frozen},Object.defineProperty(n.prototype,"minSize",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=e.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=e.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),n.prototype.getTotalSize=function(){return this._dirty&&this._update(),this._szTot},Object.defineProperty(n.prototype,"visibleLength",{get:function(){return this._dirty&&this._update(),this._vlen},enumerable:!0,configurable:!0}),n.prototype.getItemAt=function(e){if(this._dirty&&this._update(),e<=0&&this.length>0&&this[0].renderSize)return 0;for(var t,i,o=this.length,n=0,r=o-1;n<=r;)if((i=this[t=n+r>>>1])._pos>=e&&t>0)r=t-1;else{if(!(i._pos+i.renderSize<=e&&t<o-1)){for(;t>0&&!this[t].renderSize;)t--;for(;t<o-1&&!this[t].renderSize;)t++;return t}n=t+1}return r},n.prototype.getNextCell=function(e,i,o){void 0===o&&(o=0);var n,r=t.SelMove;switch(i){case r.Next:case r.NextCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.NextEditableCell:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case r.Prev:case r.PrevCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.PrevEditableCell:for(n=e-1;n>=0;n--)if(this[n].renderSize>0&&!this[n].isReadOnly)return n;break;case r.End:for(n=this.length-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.Home:for(n=0;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.NextPage:return(n=this.getItemAt(this[e].pos+this[e].renderSize+o))<0?this.getNextCell(e,t.SelMove.End,o):n==e&&n<this.length-1&&this[n+1].renderSize?n+1:n;case r.PrevPage:return(n=this.getItemAt(this[e].pos-o))<0?this.getNextCell(e,t.SelMove.Home,o):n==e&&n>0&&this[n-1].renderSize?n-1:n}return e},n.prototype.canMoveElement=function(e,i,o){if(void 0===o&&(o=!0),i==e)return!1;if(e<0||e>=this.length||i>=this.length)return!1;if(o){i<0&&(i=this.length-1);for(var n=Math.min(e,i),r=Math.max(e,i),s=n;s<=r;s++)if(!this[s].allowDragging)return!1}return!(this[i]instanceof t._NewRowTemplate)},n.prototype.moveElement=function(e,t,i){if(void 0===i&&(i=!0),this.canMoveElement(e,t,i)){var o=this[e];if(this.removeAt(e),t<0&&(t=this.length),this.insert(t,o),i){var n=this.frozen;e<n&&t>=n?this.frozen--:e>=n&&t<n&&this.frozen++}return!0}return!1},n.prototype.onCollectionChanged=function(t){void 0===t&&(t=e.collections.NotifyCollectionChangedEventArgs.reset),this._dirty=!0,this._g.invalidate(),i.prototype.onCollectionChanged.call(this,t)},n.prototype.push=function(e){return e._setList(this),i.prototype.push.call(this,e)},n.prototype.splice=function(e,t){for(var n=this,r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];for(var l=e;l<e+t&&l<this.length;l++){var a=this[l];a instanceof o&&a._setList(null)}return r.forEach((function(e){return e._setList(n)})),i.prototype.splice.apply(this,[e,t].concat(r))},n.prototype.beginUpdate=function(){this._update(),i.prototype.beginUpdate.call(this)},n.prototype._setDefaultSize=function(e){this._szCustom||(this.defaultSize=e,this._szCustom=!1)},n.prototype._update=function(){if(this._dirty&&!this.isUpdating){this._dirty=!1,this._lastFrozen=-1,this._firstVisible=-1;for(var e=0,t=0,i=void 0,o=void 0,n=0;n<this.length;n++)(o=this[n])._idx=n,o._idxVis=e,o._pos=t,o._setList(this),(i=o.renderSize)>0&&(t+=i,e++,n<this._frozen&&(this._lastFrozen=n)),this._firstVisible<0&&o.visible&&(this._firstVisible=n);return this._vlen=e,this._szTot=t,!0}return!1},n}(e.collections.ObservableArray);t.RowColCollection=l;var a=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getColumn=function(t){var i=e.isNumber(t)?t:this.indexOf(t);return i>-1?this[i]:null},i.prototype.indexOf=function(e){if(e instanceof n)return t.prototype.indexOf.call(this,e);for(var i=0;i<this.length;i++)if(this[i].name==e)return i;for(i=0;i<this.length;i++)if(this[i].binding==e)return i;return-1},Object.defineProperty(i.prototype,"describedById",{get:function(){return this._descById},set:function(t){t!=this._descById&&(this._descById=e.asString(t),this._g&&this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"firstVisibleIndex",{get:function(){return this._dirty&&this._update(),this._firstVisible},enumerable:!0,configurable:!0}),i.prototype._updateStarSizes=function(e){var t,i=!1,o=0;e-=.5;for(var r=0;r<this.length;r++)(l=this[r]).isVisible&&(l._szStar?(o+=n._parseStarSize(l._szStar),t=l):e-=l.renderWidth);if(t){var s=e;for(r=0;r<this.length;r++){var l;if((l=this[r]).isVisible&&l._szStar){var a=l._sz;l==t&&s>0?a=s:s-=a=Math.max(0,Math.round(n._parseStarSize(l._szStar)/o*e)),a!=l._sz&&(l._sz=a,i=!0)}}return i&&(this._dirty=!0,this._update()),i}return!1},i}(l);t.ColumnCollection=a;var c=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._maxLevel=-1,e}return __extends(i,t),Object.defineProperty(i.prototype,"ariaLabel",{get:function(){return this._ariaLabel},set:function(t){t!=this.ariaLabel&&(this._ariaLabel=e.asString(t),this._g&&this._g.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxGroupLevel",{get:function(){return this._dirty&&this._update(),this._maxLevel},enumerable:!0,configurable:!0}),i.prototype._update=function(){var e=this;if(t.prototype._update.call(this)){var i=this.grid?this.grid.collectionView:null,o=i?i.items:null,n=0;return this._maxLevel=-1,this.forEach((function(t){t instanceof s&&t.level>e._maxLevel&&(e._maxLevel=t.level),t._idxData=-1;var i=t.dataItem;i&&o&&(t._idxData=i===o[n]?n:i===o[n+1]?++n:-1)})),!0}return!1},i}(l);t.RowCollection=c}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){var i=function(){function i(e){this._updatingCollection=0,this._initialized=!1,this._grid=e,this._initializeColumnGroups(),this._initialized=!0}return Object.defineProperty(i.prototype,"columnGroups",{get:function(){return this._colGroups},enumerable:!0,configurable:!0}),i.prototype.createColumnGroups=function(e){this._initialized=!1,this._createColumnGroups(e),this._initialized=!0},i.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0},i.prototype.getGroupDefinitions=function(){return this._groupDefs},i.prototype.getColumnGroup=function(e,t){return this._getColumnGroup(e,t)},i.prototype.canMoveColumnGroup=function(e,t,i,o){if(e==i&&t==o)return!1;var n=this._grid,r=n.columnHeaders.rows,s=n.columns;if(e<0||e>=r.length||t<0||t>=s.length||i<0||i>=r.length||o<0||o>=s.length)return!1;var l=this._getColumnGroup(e,t),a=this._getColumnGroup(i,o);if(!l||!a||l==a)return!1;if(l.level<a.level&&l._containsGroup(a))return!1;var c=l.parentGroup,u=a.parentGroup;return!c||c===u||!c._isCollapseTo(l)},i.prototype.moveColumnGroup=function(e,t,i,o,n){if(this.canMoveColumnGroup(e,t,i,o)){var r=this._getColumnGroup(e,t),s=this._getColumnGroup(i,o);if(!r||!s||r==s)return!1;if(n&&!s.isEmpty)return!1;var l=this._getCollection(r),a=n?s.columns:this._getCollection(s);if(!l||!a)return!1;var c=n?0:a.indexOf(s);return!(c<0||(!n&&l!=a&&o>t&&c++,this._deferCollectionUpdate((function(){if(!l.remove(r))return!1;a.insert(c,r)})),0))}return!1},i.prototype.handleCollectionChange=function(){this._initialized&&!this._updatingCollection&&(this._initialized=!1,this._buildColumnGroups(),this._initialized=!0)},i.prototype.handlePropertyChange=function(e){if(e&&this._initialized){var t=this._grid,i=e._rng,o=e.header;if(o!=e._curr_header)for(var n=i.topRow;n<=i.bottomRow;n++)for(var r=i.leftCol;r<=i.rightCol;r++)t.columnHeaders.setCellData(n,r,o),e._curr_header=o;e.columns.length>0&&t.invalidate()}},i.prototype._initializeColumnGroups=function(){var e=this._grid,t=new n;this._groupDefs=t,this._colGroups=t,this._colGroups._setOwner(e),this._colGroups._setChangeHandler(this)},i.prototype._createColumnGroups=function(t){this._grid,this._groupDefs=e.asArray(t),this._colGroups&&this._colGroups._setOwner(null),this._colGroups=n._parse(t),this._buildColumnGroups()},i.prototype._buildColumnGroups=function(){var i=this,o=this._grid;this._colGroups._removeChangeHandler(),this._assertColumnGroups(this._colGroups),o.autoGenerateColumns=!1,o.columns.clear(),this._colGroups._setOwner(o),this._colGroups.forEach((function(e){e._beginBuild()}));var n=0;this._colGroups.forEach((function(e){i._addColumnGroup(e),n=Math.max(n,e._getMaxLevel())})),this._colGroups.forEach((function(e){e._expandRange(n)}));var r=o.columnHeaders.rows;r.clear();for(var s=0;s<=n;s++){var l=new t.Row;r.splice(s,0,l),s<n&&(l.cssClassAll="wj-colgroup")}for(s=0;s<r.length;s++)for(var a=0;a<o.columns.length;a++){var c=this._getColumnGroup(s,a);if(c){var u=c.header||e.toHeaderCase(c.binding);o.columnHeaders.setCellData(s,a,u),c._curr_header=c.header}}this._colGroups._setChangeHandler(this),this._colGroups.forEach((function(e){e._checkIfCollapsed()}))},i.prototype._getColumnGroup=function(e,t){var i=this._grid;if(e<i.columnHeaders.rows.length&&t<i.columns.length)for(var o=this._colGroups;o;){for(var n=o,r=0;r<o.length;r++){var s=o[r],l=s._rng;if(l.containsColumn(t)){if(l.containsRow(e)||0==s.columns.length)return s;o=s.columns;break}}if(o==n)break}return null},i.prototype._getCollection=function(e){var t=e.parentGroup;return t?t.columns:this._colGroups},i.prototype._assertColumnGroups=function(t){var i=this;e.assert(t instanceof n,"column groups contain items of invalid collection type"),t.forEach((function(t){e.assert(t instanceof o,"column groups contain items of invalid type"),i._assertColumnGroups(t.columns)}))},i.prototype._addColumnGroup=function(e){var t=this,i=this._grid;e._rng.col=i.columns.length,0==e.columns.length?i.columns.push(e):e.columns.forEach((function(e){t._addColumnGroup(e)})),e._rng.col2=i.columns.length-1},i.prototype._beginCollectionUpdate=function(){this._updatingCollection++},i.prototype._endCollectionUpdate=function(){this._updatingCollection--,this._updatingCollection<=0&&this.handleCollectionChange()},i.prototype._deferCollectionUpdate=function(e){try{this._beginCollectionUpdate(),e()}finally{this._endCollectionUpdate()}},i}();t._ColumnGroupHandler=i;var o=function(i){function o(o,r){var s=i.call(this)||this;s._rng=new t.CellRange(0,-1),s._lvl=0,s._collapsed=!1,s._cols=new n,e.copy(s,o);var l=r&&r.columns;return l&&l.indexOf(s)<0&&l.push(s),s}return __extends(o,i),o.prototype._copy=function(t,i){if("columns"==t){var o=e.asArray(i);return this._cols=n._parse(o),!0}return!1},Object.defineProperty(o.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"columnGroups",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isEmpty",{get:function(){return 0===this._cols.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parentGroup",{get:function(){var e=this._ownerList,t=e&&e.owner;return t instanceof o?t:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"level",{get:function(){for(var e=this,t=0;e.parentGroup;)e=e.parentGroup,t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"collapseTo",{get:function(){return this._collTo},set:function(t){var i=e.asString(t);this._collTo!=i&&(this._collTo=i,this._updateCollapsedState())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(i){var o=this.grid,n=null;i!=this._collapsed&&(o?(n=new t.CellRangeEventArgs(o.columnHeaders,this._rng,this),o.onColumnGroupCollapsedChanging(n)?this._collapsed=e.asBoolean(i):n=null):this._collapsed=e.asBoolean(i)),this._updateCollapsedState(),o&&n&&o.onColumnGroupCollapsedChanged(n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"grid",{get:function(){var e=this._ownerList,i=e&&e.owner;return i instanceof o?i.grid:i instanceof t.FlexGrid?i:null},enumerable:!0,configurable:!0}),o.prototype._beginBuild=function(){this._lvl=0;for(var e=this.parentGroup;e;e=e.parentGroup)this._lvl++;this._rng=new t.CellRange(0,-1),this._rng.row=this._rng.row2=this._lvl,this._cols.forEach((function(e){e._beginBuild()}))},o.prototype._setChangeHandler=function(e){this._changeHdl=e,this._cols._setChangeHandler(e)},o.prototype._removeChangeHandler=function(){this._changeHdl=null,this._cols._removeChangeHandler()},o.prototype._setOwnerList=function(e){e!=this._ownerList&&(this._ownerList=e)},o.prototype._checkIfCollapsed=function(){var e=this.grid;e&&e.columns&&(this._collapsed?this._updateCollapsedState():this._cols.forEach((function(e){e._checkIfCollapsed()})))},o.prototype._updateCollapsedState=function(){var e=this.grid,i=e?e.columns:null,n=this._rng,r=this._collapsed;if(i){this._cols.forEach((function(e){e instanceof o&&(e._collapsed=r,e._updateCollapsedState())}));var s=n.rightCol;if(this.collapseTo)switch(this.collapseTo){case"$first":s=n.leftCol;break;case"$last":s=n.rightCol;break;default:var l=i.getColumn(this.collapseTo),a=i.indexOf(l);l&&n.containsColumn(a)&&(s=a)}for(var c=n.leftCol;c<=n.rightCol;c++){var u=!r||c==s;i[c]._setFlag(t.RowColFlags.ParentCollapsed,!u)}}},o.prototype._getMaxLevel=function(){var e=this._lvl;return this.columns.forEach((function(t){e=Math.max(e,t._getMaxLevel())})),e},o.prototype._expandRange=function(e){var t=e-this._getMaxLevel();t>0&&(this._rng.row2+=t,this._cols.forEach((function(e){e._shiftRange(t)})));for(var i=this.grid.columns,o=this._rng,n=o.col;n<=o.col2;n++)i[n]._rng.row2=e},o.prototype._shiftRange=function(e){this._rng.row+=e,this._rng.row2+=e,this._cols.forEach((function(t){t._shiftRange(e)}))},o.prototype._containsGroup=function(e){for(var t=0;t<this._cols.length;t++){var i=this._cols[t];if(i==e||i._containsGroup(e))return!0}return!1},o.prototype._isCollapseTo=function(e){var t=this.grid,i=t?t.columns:null;if(!e||!i)return!1;if(this.collapseTo)switch(this.collapseTo){case"$first":case"$last":return!1;default:return e===i.getColumn(this.collapseTo)}return!1},o.prototype.onPropertyChanged=function(){var e=this._changeHdl;e&&e.handlePropertyChange(this),i.prototype.onPropertyChanged.call(this)},o}(t.Column);t.ColumnGroup=o;var n=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getColumn=function(t){return e.isNumber(t)?this._getColByIdx(t):this._findColByProp("name",t)||this._findColByProp("binding",t)},Object.defineProperty(i.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),i.prototype.push=function(e){return e._setOwnerList(this),t.prototype.push.call(this,e)},i.prototype.splice=function(e,i){for(var n=this,r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];for(var l=e;l<e+i&&l<this.length;l++){var a=this[l];a instanceof o&&a._setOwnerList(null)}return r.forEach((function(e){return e._setOwnerList(n)})),t.prototype.splice.apply(this,[e,i].concat(r))},i._parse=function(e){var t=null;return e?e instanceof i?t=e:(t=new i,e.forEach((function(e){var i=e instanceof o?e:new o(e);t.indexOf(i)<0&&t.push(i)}))):t=new i,t},i.prototype._setChangeHandler=function(e){this._changeHdl=e,this.forEach((function(t){return t._setChangeHandler(e)}))},i.prototype._removeChangeHandler=function(){this._changeHdl=null,this.forEach((function(e){return e._removeChangeHandler()}))},i.prototype._setOwner=function(e){this._owner=e,this.forEach((function(e){return e.columns._setOwner(e)}))},i.prototype._getColByIdx=function(e){return e>-1&&e<this.length?this[e]:null},i.prototype._findColByProp=function(e,t){for(var i=0;i<this.length;i++){var o=this[i];if(o[e]===t)return o;if(null!==(o=o.columns._findColByProp(e,t)))return o}return null},i.prototype.onCollectionChanged=function(i){void 0===i&&(i=e.collections.NotifyCollectionChangedEventArgs.reset);var o=this._changeHdl;o&&o.handleCollectionChange(),t.prototype.onCollectionChanged.call(this,i)},i}(e.collections.ObservableArray);t.ColumnGroupCollection=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i,o,n,r,s;e._addCultureInfo("FlexGrid",{groupHeaderFormat:"{name}: <b>{value}</b> ({count:n0} items)",ariaLabels:{toggleDropDown:"Toggle Dropdown",toggleGroup:"Toggle Group"}}),function(e){e[e.None=0]="None",e[e.SingleColumn=1]="SingleColumn",e[e.MultiColumn=2]="MultiColumn"}(o=t.AllowSorting||(t.AllowSorting={})),function(e){e[e.None=0]="None",e[e.SingleColumn=1]="SingleColumn",e[e.ColumnRange=2]="ColumnRange",e[e.Both=3]="Both"}(n=t.AllowPinning||(t.AllowPinning={})),function(e){e[e.None=0]="None",e[e.Column=1]="Column",e[e.Row=2]="Row",e[e.All=3]="All"}(r=t.HeadersVisibility||(t.HeadersVisibility={})),function(e){e[e.Default=0]="Default",e[e.CSV=1]="CSV",e[e.QuoteAll=2]="QuoteAll",e[e.SkipMerged=4]="SkipMerged",e[e.Unformatted=8]="Unformatted",e[e.InvisibleRows=16]="InvisibleRows",e[e.InvisibleColumns=32]="InvisibleColumns",e[e.InvisibleCells=48]="InvisibleCells"}(s=t.ClipStringOptions||(t.ClipStringOptions={}));var l=function(l){function a(i,s){var a=l.call(this,i,null,!0)||this;a._activeCell=null,a._szClient=new e.Size(0,0),a._szClientSB=new e.Size(0,0),a._offsetY=0,a._cssPage=0,a._ptScrl=new e.Point(0,0),a._cellPadLeft=3,a._cellPadHorz=3,a._cellPadVert=0,a._clipToScreen=!1,a._autoGenCols=!0,a._autoClipboard=!0,a._xOnCopyPaste=!0,a._autoScroll=!0,a._autoSearch=!1,a._caseSensitive=!1,a._readOnly=!1,a._indent=14,a._autoSizeMode=t.AutoSizeMode.Both,a._autoHeights=!1,a._quickSize=null,a._hdrVis=r.All,a._alSorting=o.SingleColumn,a._alPinning=n.None,a._alAddNew=!1,a._alDelete=!1,a._alResizing=t.AllowResizing.Columns,a._alDragging=t.AllowDragging.Columns,a._alMerging=t.AllowMerging.None,a._ssHdr=r.None,a._shSort=!0,a._shGroups=!0,a._shMarquee=!1,a._shPlcHld=!1,a._altStep=1,a._shErr=!0,a._shDropDown=!0,a._valEdt=!0,a._gHdrFmt=null,a._childItemsPath=null,a._sortRowIndex=null,a._editColIndex=null,a._deferResizing=!1,a._pSel=!0,a._pOutline=!0,a._stickyHdr=!1,a._anchorCursor=!1,a._copyHeaders=r.None,a._bigChecks=!1,a._fzClone=null,a._vt=0,a._vtRows=0,a._vtCols=0,a._lazyRender=!0,a._refreshOnEdit=!0,a._reorderCells=!0,a._touchEdit=!1,a.itemsSourceChanging=new e.Event,a.itemsSourceChanged=new e.Event,a.scrollPositionChanged=new e.Event,a.selectionChanging=new e.Event,a.selectionChanged=new e.Event,a.loadingRows=new e.Event,a.loadedRows=new e.Event,a.updatingLayout=new e.Event,a.updatedLayout=new e.Event,a.resizingColumn=new e.Event,a.resizedColumn=new e.Event,a.autoSizingColumn=new e.Event,a.autoSizedColumn=new e.Event,a.starSizedColumns=new e.Event,a.draggingColumn=new e.Event,a.draggingColumnOver=new e.Event,a.draggedColumn=new e.Event,a.pinningColumn=new e.Event,a.pinnedColumn=new e.Event,a.resizingRow=new e.Event,a.resizedRow=new e.Event,a.autoSizingRow=new e.Event,a.autoSizedRow=new e.Event,a.draggingRow=new e.Event,a.draggingRowOver=new e.Event,a.draggedRow=new e.Event,a.groupCollapsedChanging=new e.Event,a.groupCollapsedChanged=new e.Event,a.columnGroupCollapsedChanging=new e.Event,a.columnGroupCollapsedChanged=new e.Event,a.sortingColumn=new e.Event,a.sortedColumn=new e.Event,a.beginningEdit=new e.Event,a.prepareCellForEdit=new e.Event,a.cellEditEnding=new e.Event,a.cellEditEnded=new e.Event,a.rowEditStarting=new e.Event,a.rowEditStarted=new e.Event,a.rowEditEnding=new e.Event,a.rowEditEnded=new e.Event,a.rowAdded=new e.Event,a.deletingRow=new e.Event,a.deletedRow=new e.Event,a.copying=new e.Event,a.copied=new e.Event,a.pasting=new e.Event,a.pasted=new e.Event,a.pastingCell=new e.Event,a.pastedCell=new e.Event,a.formatItem=new e.Event((function(){a._clearCells()})),a.updatingView=new e.Event,a.updatedView=new e.Event,a._mappedColumns=null;var c=a.hostElement;e.isIE()&&(c.style.borderRadius="0");var u=a.getTemplate();if(a.applyTemplate("wj-control wj-content wj-flexgrid",u,{_root:"root",_eSz:"sz",_eCt:"cells",_fCt:"fcells",_eTL:"tl",_eBL:"bl",_eCHdr:"ch",_eRHdr:"rh",_eCFtr:"cf",_eTLCt:"tlcells",_eBLCt:"blcells",_eCHdrCt:"chcells",_eCFtrCt:"cfcells",_eRHdrCt:"rhcells",_eMarquee:"marquee",_eFocus:"focus"}),e.setCss(a._root.parentElement,{position:"relative",left:"0",top:"0",width:"100%",height:"100%",overflow:"hidden",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit"}),e.setCss(a._root,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",minWidth:"inherit",minHeight:"inherit",maxWidth:"inherit",maxHeight:"inherit",overflow:"auto",webkitOverflowScrolling:"touch"}),e.setCss(a._eCt,{position:"absolute"}),e.setCss(a._eMarquee,{display:"none"}),e.setCss(a._eMarquee.firstChild,{width:"100%",height:"100%"}),e.setCss(a._fCt,{position:"absolute",left:"0",top:"0",overflow:"hidden",pointerEvents:"none"}),e.setCss(a._eFocus,{position:"fixed",left:"-32000px"}),e.setCss(a._eSz,{position:"relative",visibility:"hidden"}),[a._eRHdr,a._eCFtr,a._eCHdr,a._eBL,a._eTL].forEach((function(t){e.setAttribute(t,"aria-hidden",!0),e.setCss(t,{position:"absolute",overflow:"hidden",outline:"none"}),e.setCss(t.firstElementChild,{position:"relative"})})),[a._eFocus,a._eMarquee,a._fCt,a._eSz].forEach((function(t){e.setAttribute(t,"aria-hidden",!0)})),e.isIE9()||e.isIE10()){var h=a._eMarquee;["click","dblclick","mousedown","mouseup"].forEach((function(e){a.addEventListener(h,e,(function(t){var i=h.style.display;h.style.display="none";var o=document.elementFromPoint(t.clientX,t.clientY);h.style.display=i;var n=document.createEvent("Event");for(var r in n.initEvent(e,!0,!0),t)try{n[r]=t[r]}catch(e){}o.dispatchEvent(n)}))}))}return c.tabIndex=-1,a.deferUpdate((function(){var i=a._getDefaultRowHeight();a._rows=new t.RowCollection(a,i),a._cols=new t.ColumnCollection(a,4*i),a._hdrRows=new t.RowCollection(a,i),a._hdrCols=new t.ColumnCollection(a,Math.round(1.25*i)),a._ftrRows=new t.RowCollection(a,i);var o=t.CellType;a._gpTL=new t.GridPanel(a,o.TopLeft,a._hdrRows,a._hdrCols,a._eTLCt),a._gpCHdr=new t.GridPanel(a,o.ColumnHeader,a._hdrRows,a._cols,a._eCHdrCt),a._gpRHdr=new t.GridPanel(a,o.RowHeader,a._rows,a._hdrCols,a._eRHdrCt),a._gpCells=new t.GridPanel(a,o.Cell,a._rows,a._cols,a._eCt),a._gpBL=new t.GridPanel(a,o.BottomLeft,a._ftrRows,a._hdrCols,a._eBLCt),a._gpCFtr=new t.GridPanel(a,o.ColumnFooter,a._ftrRows,a._cols,a._eCFtrCt),a._hdrRows.push(new t.Row),a._hdrCols.push(new t.Column({align:"center"})),a._cf=new t.CellFactory,a._keyHdl=new t._KeyboardHandler(a),a._mouseHdl=new t._MouseHandler(a),a._edtHdl=new t._EditHandler(a),a._selHdl=new t._SelectionHandler(a),a._addHdl=new t._AddNewHandler(a),a._grpHdl=new t._ColumnGroupHandler(a),a._mrgMgr=new t.MergeManager,a._bndSortConverter=a._sortConverter.bind(a),a._errorTip=new e.Tooltip({isContentHtml:!1,showDelay:0,cssClass:"wj-error-tip"}),e.setAttribute(a.cells.hostElement,"role","grid"),a.selectionMode=t.SelectionMode.CellRange,a._root.tabIndex=-1,a.initialize(s)})),a.addEventListener(a._root,"scroll",(function(e){if(a._updateScrollPosition()||a._forceScrollUpdate){var t=a.activeEditor,i=a.activeCell,o=i?i.className:null;a._forceScrollUpdate||a.finishEditing(),a._forceScrollUpdate=!1,a._updateContent(!0);var n=a.activeEditor,r=a.activeCell;n&&r&&t&&o?(n.value=t.value,r.className=o,a._setFocusNoScroll(n)):n&&!r&&a.finishEditing(!0),a.frozenColumns&&setTimeout((function(){var e=a.columnHeaders.hostElement.style,t=parseInt(e.left),i=a._ptScrl.x;Math.abs(t-i)>1&&a.invalidate()}))}})),a.addEventListener(c,"focus",(function(e){if(c.tabIndex>-1){var t=e.target;t instanceof HTMLElement&&t.tabIndex<0&&a._setFocus(!0)}}),!0),a}return __extends(a,l),a.prototype._handleResize=function(){var e=this;this._rcBounds=null,this.activeEditor&&this.isTouching||this._touchEdit?setTimeout((function(){e.activeEditor||(e._touchEdit=!0,e.startEditing(!0))}),50):l.prototype._handleResize.call(this),this._touchEdit=!1},Object.defineProperty(a.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){(t=e.asEnum(t,r))!=this._hdrVis&&(this._hdrVis=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"stickyHeaders",{get:function(){return this._stickyHdr},set:function(t){t!=this._stickyHdr&&(this._stickyHdr=e.asBoolean(t),this._updateStickyHeaders(),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"preserveSelectedState",{get:function(){return this._pSel},set:function(t){this._pSel=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"preserveOutlineState",{get:function(){return this._pOutline},set:function(t){this._pOutline=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"anchorCursor",{get:function(){return this._anchorCursor},set:function(t){this._anchorCursor=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"copyHeaders",{get:function(){return this._copyHeaders},set:function(t){this._copyHeaders=e.asEnum(t,r)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"lazyRender",{get:function(){return this._lazyRender},set:function(t){this._lazyRender=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"refreshOnEdit",{get:function(){return this._refreshOnEdit},set:function(t){this._refreshOnEdit=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"virtualizationThreshold",{get:function(){return this._vt},set:function(t){this._vt=t,e.isNumber(t)?this._vtRows=this._vtCols=e.asNumber(t):t?e.isArray(t)&&2==t.length?(this._vtRows=e.asNumber(t[0]),this._vtCols=e.asNumber(t[1])):e.assert(!1,"virtualizationThreshold should be a number or an array with two numbers."):this._vtRows=this._vtCols=0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"expandSelectionOnCopyPaste",{get:function(){return this._xOnCopyPaste},set:function(t){this._xOnCopyPaste=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoScroll",{get:function(){return this._autoScroll},set:function(t){this._autoScroll=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoSearch",{get:function(){return this._autoSearch},set:function(t){this._autoSearch=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"caseSensitiveSearch",{get:function(){return this._caseSensitive},set:function(t){this._caseSensitive=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnLayout",{get:function(){var i,o=this._hasColumnGroups(),n=o?t.ColumnGroup:t.Column,r=o?"columnGroups":"columns",s=a._getSerializableProperties(n),l=new n,c=o?this.getColumnGroups():this.columns,u=function(t){var i=[];return t.forEach((function(t){var n={};if(s.forEach((function(i){var o=t[i];o!=l[i]&&e.isPrimitive(o)&&"size"!=i&&(n[i]=o)})),o){var r=t.columns;r.length&&(n.columns=u(r))}i.push(n)})),i},h=u(c);return JSON.stringify(((i={})[r]=h,i))},set:function(i){var o=this,n=JSON.parse(e.asString(i));e.assert(n,"Invalid columnLayout data."),this.columns.deferUpdate((function(){o.columns.clear(),o._hasColumnGroups()&&(o.columnGroups=new t.ColumnGroupCollection),o.initialize(n)}))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(t){this.columns.clear(),this._grpHdl.createColumnGroups(e.asArray(t))},enumerable:!0,configurable:!0}),a.prototype.getColumnGroups=function(){return this._grpHdl.columnGroups},Object.defineProperty(a.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){t!=this._readOnly&&(this._readOnly=e.asBoolean(t),this.finishEditing(),this.invalidate(!0),this._addHdl.updateNewRowTemplate(),e.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly),this._setAria("readonly",this.isReadOnly?"true":null))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bigCheckboxes",{get:function(){return this._bigChecks},set:function(t){this._bigChecks=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(t){if((t=e.asBoolean(t,!0))!=this.isDisabled){var i=this._e;i&&(e.enable(i,!t),this.invalidate())}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"imeEnabled",{get:function(){return null!=this._imeHdl},set:function(i){if(e.asBoolean(i)!=this.imeEnabled&&this.finishEditing()){var o=this.containsFocus();this._imeHdl&&(this._imeHdl.dispose(),this._imeHdl=null),i&&(this._imeHdl=new t._ImeHandler(this)),o&&this.focus()}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(i){this._alResizing=e.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(t){this._deferResizing=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(i){this._autoSizeMode=e.asEnum(i,t.AutoSizeMode)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoRowHeights",{get:function(){return this._autoHeights},set:function(t){this._autoHeights=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0}),a.prototype._getQuickAutoSize=function(){return e.isBoolean(this._quickSize)?this._quickSize:!this.formatItem.hasHandlers&&null==this.itemFormatter},Object.defineProperty(a.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){e.isBoolean(t)&&(t=t?o.SingleColumn:o.None),this._alSorting=e.asEnum(t,o)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowPinning",{get:function(){return this._alPinning},set:function(t){t!=this._alPinning&&(e.isBoolean(t)&&(t=t?n.SingleColumn:n.None),this._alPinning=e.asEnum(t,n),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){t!=this._alAddNew&&(this._alAddNew=e.asBoolean(t),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"newRowAtTop",{get:function(){return this._addHdl.newRowAtTop},set:function(t){this._addHdl.newRowAtTop=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=e.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){(i=e.asEnum(i,t.AllowMerging))!=this._alMerging&&(this._alMerging=i,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(t){(t=e.asEnum(t,r))!=this._ssHdr&&(this._ssHdr=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showMarquee",{get:function(){return this._shMarquee},set:function(t){t!=this._shMarquee&&(this._shMarquee=e.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showPlaceholders",{get:function(){return this._shPlcHld},set:function(t){this._shPlcHld=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showSort",{get:function(){return this._shSort},set:function(t){t!=this._shSort&&(this._shSort=e.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){t!=this._shGroups&&(this._shGroups=e.asBoolean(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"alternatingRowStep",{get:function(){return this._altStep},set:function(t){t!=this._altStep&&(this._altStep=e.asInt(t,!1,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showAlternatingRows",{get:function(){return this._altStep>0},set:function(t){e._deprecated("showAlternatingRows","alternatingRowStep"),this.alternatingRowStep=t?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showErrors",{get:function(){return this._shErr},set:function(t){t!=this._shErr&&(this._clearCells(),this._shErr=e.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"errorTip",{get:function(){return this._errorTip},set:function(t){t!=this._errorTip&&(this._clearCells(),this._errorTip=e.asType(t,e.Tooltip,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(t){t!=this.itemValidator&&(this._itemValidator=e.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"validateEdits",{get:function(){return this._valEdt},set:function(t){this._valEdt=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){t!=this._gHdrFmt&&(this._gHdrFmt=e.asString(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(i){(i=e.asEnum(i,t.AllowDragging))!=this._alDragging&&(this._alDragging=i,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsSource",{get:function(){return this._items},set:function(t){var i=this;if(t!=this._items){var o,n=new e.CancelEventArgs;if(this.onItemsSourceChanging(n))this._cv&&((o=this._cv).currentChanged.removeHandler(null,this),o.collectionChanged.removeHandler(null,this),o instanceof e.collections.CollectionView&&o.sortConverter==this._bndSortConverter&&(o.sortConverter=null),this._cv=null),this._items=t,this._cv=this._getCollectionView(t),this._lastCount=0,this._cv&&((o=this._cv).currentChanged.addHandler((function(e,t){return i._cvCurrentChanged(e,t)}),this),o.collectionChanged.addHandler((function(e,t){return i._cvCollectionChanged(e,t)}),this),o instanceof e.collections.CollectionView&&!o.sortConverter&&(o.sortConverter=this._bndSortConverter)),this._bindGrid(!0),this._selHdl._setSelectionMode(this.selectionMode),this.onItemsSourceChanged(n)}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"editableCollectionView",{get:function(){return e.tryCast(this._cv,"IEditableCollectionView")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(t){t!=this._childItemsPath&&(e.assert(null==t||e.isArray(t)||e.isString(t),"childItemsPath should be an array or a string."),this._childItemsPath=t,this._bindGrid(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rowHeaderPath",{get:function(){return this._rowHdrPath?this._rowHdrPath.path:null},set:function(t){t!=this.rowHeaderPath&&(t=e.asString(t),this._rowHdrPath=t?new e.Binding(t):null,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnFooters",{get:function(){return this._gpCFtr},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bottomLeftCells",{get:function(){return this._gpBL},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),a.prototype.getColumn=function(e,t){if(this._hasColumnGroups()&&t){var i=this.getColumnGroups();return null!==i?i.getColumn(e):null}return this.columns.getColumn(e)},Object.defineProperty(a.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(e){this.rows.frozen=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(e){this.columns.frozen=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cloneFrozenCells",{get:function(){return this._fzClone},set:function(t){t!=this._fzClone&&(e.setText(this._fCt,null),this._fzClone=e.asBoolean(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(t){t!=this._sortRowIndex&&(this._sortRowIndex=e.asNumber(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"editColumnIndex",{get:function(){return this._editColIndex},set:function(t){t!=this._editColIndex&&(this._editColIndex=e.asNumber(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(e){var t=this._root,i=-e.x;if(this.rightToLeft)switch(a._getRtlMode()){case"rev":i=t.scrollWidth-t.clientWidth+e.x;break;case"neg":i=e.x;break;default:i=-e.x}t.scrollLeft=i,t.scrollTop=-e.y,this._updateScrollPosition()&&(this._forceScrollUpdate=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"controlRect",{get:function(){return this._rcBounds||(this._rcBounds=e.getElementRect(this._root)),this._rcBounds},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSize",{get:function(){return new e.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cellFactory",{get:function(){return this._cf},set:function(i){i!=this._cf&&(this._clearCells(),this._cf=e.asType(i,t.CellFactory,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._clearCells(),this._itemFormatter=e.asFunction(t))},enumerable:!0,configurable:!0}),a.prototype.canEditCell=function(e,t){return this._edtHdl._allowEdit(e,t)},a.prototype.getCellData=function(e,t,i){return this.cells.getCellData(e,t,i)},a.prototype.getCellBoundingRect=function(e,t,i){return this.cells.getCellBoundingRect(e,t,i)},a.prototype.setCellData=function(e,t,i,o,n){return void 0===o&&(o=!0),void 0===n&&(n=!0),this.cells.setCellData(e,t,i,o,n)},a.prototype.hitTest=function(i,o){return e.isNumber(i)&&e.isNumber(o)&&(i=new e.Point(i,o)),e.isBoolean(o)&&o&&(this._rcBounds=null),new t.HitTestInfo(this,i)},a.prototype.getClipString=function(t,i,o,n){var r;return r=null==i||e.isBoolean(i)?i?s.CSV:s.Default:i,e.assert(e.isNumber(r),"Unexpected value for ClipStringOptions parameter."),this._edtHdl.getClipString(t,r,o,n)},a.prototype.setClipString=function(e,t){this._edtHdl.setClipString(e,t)},a.prototype.focus=function(e){this._setFocus(e)},a.prototype.dispose=function(){this.finishEditing(!0),this.itemsSource=null,l.prototype.dispose.call(this)},a.prototype.refresh=function(t){void 0===t&&(t=!0),l.prototype.refresh.call(this,t),this.finishEditing(),t&&(this._updateColumnTypes(),this.scrollPosition=this._ptScrl,this._updateDefaultSizes(),clearTimeout(this._toInv),this._toInv=null),this.refreshCells(t);var i=this._e;i&&(this._szCtl=new e.Size(i.offsetWidth,i.offsetHeight))},a.prototype.refreshCells=function(e,t,i){this.isUpdating||(e?this._updateLayout():this._updateContent(t,i))},a.prototype.refreshRange=function(e){for(var i=e.topRow;i<=e.bottomRow;i++)for(var o=e.leftCol;o<=e.rightCol;o++){var n=this.cells.getCellElement(i,o);if(n){var r=n[t.GridPanel._INDEX_KEY];this.cellFactory.updateCell(this.cells,i,o,n,r.rng)}}},a.prototype.autoSizeColumn=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=4),this.autoSizeColumns(e,e,t,i)},a.prototype.autoSizeColumns=function(i,o,n,r){var s=this;void 0===n&&(n=!1),void 0===r&&(r=4);var l=0,c=n?this.topLeftCells:this.columnHeaders,u=n?this.bottomLeftCells:this.columnFooters,h=n?this.rowHeaders:this.cells,d=this.viewRange;i=null==i?0:e.asInt(i),o=null==o?h.columns.length-1:e.asInt(o),d.row=Math.max(0,d.row-1e3),d.row2=Math.min(d.row2+1e3,this.rows.length-1),this.finishEditing()&&this.columns.deferUpdate((function(){e.setCss(s._eCt,{width:s._gpCells.width});for(var n=e.createElement("<div "+a._WJS_MEASURE+'="true"/>',h.hostElement,{visibility:"hidden"}),p=s._getCanvasContext(),g=i;g<=o&&g>-1&&g<h.columns.length;g++){var f=h.columns[g];if(f.isVisible){if(l=0,s.autoSizeMode&t.AutoSizeMode.Headers){for(var _=0;_<c.rows.length;_++)c.rows[_].isVisible&&(l=Math.max(s._getDesiredWidth(c,_,g,n),l));for(_=0;_<u.rows.length;_++)u.rows[_].isVisible&&(l=Math.max(s._getDesiredWidth(u,_,g,n),l))}if(s.autoSizeMode&t.AutoSizeMode.Cells&&d.row>-1&&d.row2>-1)if(f._getQuickAutoSize())_=s._getWidestRow(h,d,g,p),l=Math.max(s._getDesiredWidth(h,_,g,n),l);else for(_=d.row;_<=d.row2&&_<h.rows.length;_++)h.rows[_].isVisible&&(l=Math.max(s._getDesiredWidth(h,_,g,n),l));l>0&&(f.width=l+r+2)}}s.cellFactory.disposeCell(n),e.removeChild(n)}))},a.prototype.autoSizeRow=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=0),this.autoSizeRows(e,e,t,i)},a.prototype.autoSizeRows=function(i,o,n,r){var s=this;void 0===n&&(n=!1),void 0===r&&(r=0);var l=0,c=1==n?this.topLeftCells:null==n?this.bottomLeftCells:this.rowHeaders,u=1==n?this.columnHeaders:null==n?this.columnFooters:this.cells;if(r=e.asNumber(r),i=null==i?0:e.asInt(i),(o=null==o?u.rows.length-1:e.asInt(o))>=i&&this.finishEditing()){e.setCss(this._eCt,{width:this._gpCells.width});var h=e.createElement("<div "+a._WJS_MEASURE+'="true"/>',u.hostElement,{visibility:"hidden"});this.rows.deferUpdate((function(){for(var e={},n=s._autoSizeMode,a=t.AutoSizeMode,d=i;d<=o&&d>-1&&d<u.rows.length;d++)u.rows[d].isVisible&&(l=0,n&a.Headers&&(l=s._getDesiredRowHeight(c,d,h,e)),n&a.Cells&&(l=Math.max(s._getDesiredRowHeight(u,d,h,e),l)),l>0&&(u.rows[d].height=l+r))})),this.cellFactory.disposeCell(h),e.removeChild(h)}},Object.defineProperty(a.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){t!=this._indent&&(this._indent=e.asNumber(t,!1,!0),this.columns.onCollectionChanged())},enumerable:!0,configurable:!0}),a.prototype.collapseGroupsToLevel=function(e){var i=this;this.finishEditing()&&this.deferUpdate((function(){var o=i.rows;o.deferUpdate((function(){for(var i=0;i<o.length;i++){var n=o[i];n instanceof t.GroupRow&&(n.isCollapsed=n.level>=e)}}))}))},Object.defineProperty(a.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){(i=e.asEnum(i,t.SelectionMode))!=this.selectionMode&&(this._selHdl.selectionMode=i)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(e){this._selHdl.selection=e},enumerable:!0,configurable:!0}),a.prototype.select=function(e,t){return void 0===t&&(t=!0),this._selHdl.select(e,t)},a.prototype.selectAll=function(){var e=this.rows.length,i=this.columns.length;return!(!e||!i)&&this.select(new t.CellRange(0,0,e-1,i-1),!1)},a.prototype.getSelectedState=function(e,t){return this.cells.getSelectedState(e,t)},Object.defineProperty(a.prototype,"selectedRows",{get:function(){var e=this,i=this.selectionMode,o=this.rows.filter((function(e){return e.isSelected}));if(0==o.length&&i!=t.SelectionMode.None){var n=[];this.selectedRanges.forEach((function(t){for(var i=t.topRow;i<=t.bottomRow&&i>-1&&i<e.rows.length;i++)n.indexOf(i)<0&&n.push(i)})),n.sort(),o=n.map((function(t){return e.rows[t]}))}return o},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode."),i=e.asArray(i),this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n)>-1;r&&t&&(t=!1,o.select(e,o.selection.col)),n.isSelected=r}}))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectedItems",{get:function(){var e=[];return this.selectedRows.forEach((function(t){var i=t?t.dataItem:null;i&&e.indexOf(i)<0&&e.push(i)})),e},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode."),i=e.asArray(i),this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n.dataItem)>-1;r&&t&&(t=!1,o.select(e,o.selection.col)),n.isSelected=r}}))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectedRanges",{get:function(){var e=[this.selection];return this._selHdl.extendedSelection.forEach((function(t){e.push(t)})),e},set:function(i){if((i=e.asArray(i))&&i.length>0&&(this.select(i[0]),this.selectionMode==t.SelectionMode.MultiRange)){var o=this._selHdl.extendedSelection;o.deferUpdate((function(){o.clear();for(var e=1;e<i.length;e++)o.push(i[e])}))}},enumerable:!0,configurable:!0}),a.prototype.scrollIntoView=function(t,i,o){(null==this._maxOffsetY||this._rows._dirty||this._cols._dirty)&&this._updateLayout();var n=this.scrollPosition,r=this._szClient,s=r.width,l=r.height-this._gpCFtr.rows.getTotalSize(),a=this.cells._getFrozenPos();if((t=e.asInt(t))>-1&&t<this._rows.length&&t>=this._rows.frozen){var c=this._rows[t],u=this._getCssPage(c.pos);if(u!=this._cssPage){for(var h=this._maxOffsetY,d=Math.round(h*u);d>c.pos;u-=.1)d=Math.round(h*u);this._offsetY=d}var p=c.pos-this._offsetY,g=p+c.renderSize;g>l-n.y&&(n.y=Math.max(-p,l-g)),p-a.y<-n.y&&(n.y=-(p-a.y)),u!=this._cssPage&&(this._cssPage=this._getCssPage(-n.y))}if(e.isString(i)&&(i=this.columns.indexOf(i)),(i=e.asInt(i))>-1&&i<this._cols.length&&i>=this._cols.frozen){var f=this._cols[i],_=f.pos+f.renderSize;_>-n.x+s&&(n.x=Math.max(-f.pos,s-_)),f.pos-a.x<-n.x&&(n.x=-(f.pos-a.x))}if(!n.equals(this._ptScrl))return this.scrollPosition=n,o&&(this._updateScrollPosition(),this._forceScrollUpdate=!1,this.refresh()),!0;if(this._activeCell&&t>-1&&i>-1){var m=this._root,w=m.scrollWidth==m.clientWidth,C=m.scrollHeight==m.clientHeight;if(w||C){var v=this._activeCell.getBoundingClientRect(),y=innerWidth,b=innerHeight,R=v.right<0||v.left>y,E=v.bottom<0||v.top>b;n.x=pageXOffset+(v.left<0?v.left:v.right>y?v.right-y:0),n.y=pageYOffset+(v.top<0?v.top:v.bottom>b?v.bottom-b:0),R&&w&&E&&C?scrollTo(n.x,n.y):R&&w?scrollTo(n.x,document.documentElement.scrollLeft):E&&C&&scrollTo(document.documentElement.scrollTop,n.y)}}return!1},a.prototype.isRangeValid=function(e){return e&&e.isValid&&e.bottomRow<this.rows.length&&e.rightCol<this.columns.length},a.prototype.startEditing=function(e,t,i,o,n){return void 0===e&&(e=!0),this._edtHdl.startEditing(e,t,i,o,n)},a.prototype.finishEditing=function(e){return this._edtHdl.finishEditing(e)},Object.defineProperty(a.prototype,"activeCell",{get:function(){return this._activeCell},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"activeEditor",{get:function(){var e=this._edtHdl;return e?e.activeEditor:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"editRange",{get:function(){var e=this._edtHdl.editRange;return e?e.clone():null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(i){i!=this._mrgMgr&&(this._mrgMgr=e.asType(i,t.MergeManager,!0),this.invalidate())},enumerable:!0,configurable:!0}),a.prototype.getMergedRange=function(e,t,i,o){return void 0===o&&(o=!0),this._mrgMgr?this._mrgMgr.getMergedRange(e,t,i,o):null},Object.defineProperty(a.prototype,"keyActionTab",{get:function(){return this._keyHdl._kaTab},set:function(i){this._keyHdl._kaTab=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"keyActionEnter",{get:function(){return this._keyHdl._kaEnter},set:function(i){this._keyHdl._kaEnter=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"preserveWhiteSpace",{get:function(){return e.hasClass(this.hostElement,a._WJS_WSPRE)},set:function(t){e.toggleClass(this.hostElement,a._WJS_WSPRE,e.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showDropDown",{get:function(){return this._shDropDown},set:function(t){t!=this._shDropDown&&(this._shDropDown=e.asBoolean(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),a.prototype.toggleDropDownList=function(){return this._tglDropDown||(this._tglDropDown=!0,this._edtHdl._toggleListBox(null),this._tglDropDown=!1),null!=this._edtHdl._lbx},Object.defineProperty(a,"defaultTypeWidth",{get:function(){return a._defTypeWidth},enumerable:!0,configurable:!0}),a.prototype.onItemsSourceChanging=function(e){return this.itemsSourceChanging.raise(this,e),!e.cancel},a.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)},a.prototype.onScrollPositionChanged=function(e){this.scrollPositionChanged.raise(this,e)},a.prototype.onSelectionChanging=function(e){return this.selectionChanging.raise(this,e),!e.cancel},a.prototype.onSelectionChanged=function(e){this.selectionChanged.raise(this,e)},a.prototype.onLoadingRows=function(e){return this.loadingRows.raise(this,e),!e.cancel},a.prototype.onLoadedRows=function(e){this.loadedRows.raise(this,e),this._autoRowHeights()},a.prototype.onUpdatingLayout=function(e){return this.updatingLayout.raise(this,e),!e.cancel},a.prototype.onUpdatedLayout=function(e){this.updatedLayout.raise(this,e)},a.prototype.onResizingColumn=function(e){return this.resizingColumn.raise(this,e),!e.cancel},a.prototype.onResizedColumn=function(e){this.resizedColumn.raise(this,e),this._autoRowHeights()},a.prototype.onAutoSizingColumn=function(e){return this.autoSizingColumn.raise(this,e),!e.cancel},a.prototype.onAutoSizedColumn=function(e){this.autoSizedColumn.raise(this,e)},a.prototype.onStarSizedColumns=function(e){this.starSizedColumns.raise(this,e),this._autoRowHeights()},a.prototype.onDraggingColumn=function(e){return this.draggingColumn.raise(this,e),!e.cancel},a.prototype.onDraggingColumnOver=function(e){return this.draggingColumnOver.raise(this,e),!e.cancel},a.prototype.onDraggedColumn=function(e){this.draggedColumn.raise(this,e)},a.prototype.onPinningColumn=function(e){return this.pinningColumn.raise(this,e),!e.cancel},a.prototype.onPinnedColumn=function(e){this.pinnedColumn.raise(this,e)},a.prototype.onResizingRow=function(e){return this.resizingRow.raise(this,e),!e.cancel},a.prototype.onResizedRow=function(e){this.resizedRow.raise(this,e)},a.prototype.onAutoSizingRow=function(e){return this.autoSizingRow.raise(this,e),!e.cancel},a.prototype.onAutoSizedRow=function(e){this.autoSizedRow.raise(this,e)},a.prototype.onDraggingRow=function(e){return this.draggingRow.raise(this,e),!e.cancel},a.prototype.onDraggingRowOver=function(e){return this.draggingRowOver.raise(this,e),!e.cancel},a.prototype.onDraggedRow=function(e){this.draggedRow.raise(this,e)},a.prototype.onGroupCollapsedChanging=function(e){return this.groupCollapsedChanging.raise(this,e),!e.cancel},a.prototype.onGroupCollapsedChanged=function(e){this.groupCollapsedChanged.raise(this,e)},a.prototype.onColumnGroupCollapsedChanging=function(e){return this.columnGroupCollapsedChanging.raise(this,e),!e.cancel},a.prototype.onColumnGroupCollapsedChanged=function(e){this.columnGroupCollapsedChanged.raise(this,e)},a.prototype.onSortingColumn=function(e){return this.sortingColumn.raise(this,e),!e.cancel},a.prototype.onSortedColumn=function(e){this.sortedColumn.raise(this,e)},a.prototype.onBeginningEdit=function(e){return this.beginningEdit.raise(this,e),!e.cancel},a.prototype.onPrepareCellForEdit=function(e){this.prepareCellForEdit.raise(this,e)},a.prototype.onCellEditEnding=function(e){return this.cellEditEnding.raise(this,e),!e.cancel&&!e.stayInEditMode},a.prototype.onCellEditEnded=function(e){this.cellEditEnded.raise(this,e),this._autoRowHeights()},a.prototype.onRowEditStarting=function(e){return this.rowEditStarting.raise(this,e),!e.cancel},a.prototype.onRowEditStarted=function(e){this.rowEditStarted.raise(this,e)},a.prototype.onRowEditEnding=function(e){this.rowEditEnding.raise(this,e)},a.prototype.onRowEditEnded=function(e){this.rowEditEnded.raise(this,e),this._autoRowHeights()},a.prototype.onRowAdded=function(e){return this.rowAdded.raise(this,e),!e.cancel},a.prototype.onDeletingRow=function(e){return this.deletingRow.raise(this,e),!e.cancel},a.prototype.onDeletedRow=function(e){this.deletedRow.raise(this,e)},a.prototype.onCopying=function(e){return this.copying.raise(this,e),!e.cancel},a.prototype.onCopied=function(e){this.copied.raise(this,e)},a.prototype.onPasting=function(e){return this.pasting.raise(this,e),!e.cancel},a.prototype.onPasted=function(e){this.pasted.raise(this,e)},a.prototype.onPastingCell=function(e){return this.pastingCell.raise(this,e),!e.cancel},a.prototype.onPastedCell=function(e){this.pastedCell.raise(this,e)},a.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)},a.prototype.onUpdatingView=function(e){return this.updatingView.raise(this,e),!e.cancel},a.prototype.onUpdatedView=function(e){this.updatedView.raise(this,e)},a.prototype._getTabIndex=function(){return this._orgTabIndex},a.prototype._autoRowHeights=function(){var i=this;this._autoHeights&&(this.rows.length>100&&[this.columnHeaders,this.rowHeaders].forEach((function(e){e._updateContent(!0,!1,e._getOffsetY())})),clearTimeout(this._toAutoHeights),this._toAutoHeights=setTimeout((function(){if(i._toAutoHeights=null,!i.editRange){var e=i.autoSizeMode,o=t.AutoSizeMode;e&o.Headers&&(i._autoSizeMode=o.Both,i.autoSizeRows(0,i.columnHeaders.rows.length-1,!0),i._autoSizeMode=e),e&o.Cells&&i.autoSizeRows()}}),e.Control._REFRESH_INTERVAL))},a.prototype._getShowErrors=function(){return this.showErrors&&this._hasValidation},a.prototype._getHasValidation=function(){return this._hasValidation},a.prototype._getError=function(t,i,o,n){if(e.isFunction(this.itemValidator)){if(t==this.cells)return this.itemValidator(i,o,n);if(t==this.rowHeaders)for(o=0;o<this.columns.length;o++)if(u=this.itemValidator(i,o,n))return u}var r=this._cv,s=r?r.getError:null;if(e.isFunction(s)){var l=t.rows,a=this.columns,c=l[i].dataItem;if(c&&!(c instanceof e.collections.CollectionViewGroup))if(t==this.cells)for(;i<l.length&&l[i].dataItem==c;i++)return s(c,this._getBindingColumn(this.cells,i,a[o]).binding,n);else if(t==this.rowHeaders){var u;if(!(u=s(c,null,!1))){for(var h=[];i<l.length&&l[i].dataItem==c;i++)for(o=0;o<a.length;o++)(u=s(c,this._getBindingColumn(this.cells,i,a[o]).binding,!1))&&h.indexOf(u)<0&&h.push(u);if(h.length){var d=this.errorTip,p=!!d&&d.isContentHtml;u=h.join(p?"<br/>":"\n")}}return u}}return null},a.prototype._setAria=function(t,i){e.setAttribute(this.cells.hostElement,"aria-"+t,i)},a.prototype._setFocus=function(i){if(this.hostElement&&(i||!this.containsFocus())){var o=e.getActiveElement(),n=this.activeEditor,r=this._activeCell,s=this._eFocus,l=this._root,a=this._getTabIndex();n?e.contains(n,o)||(n.focus(),s.tabIndex=-1):r?e.contains(r,o)||o==this._root||(e.isIE()&&e.hasClass(r,"wj-group")&&(r=r.querySelector("."+t.CellFactory._WJC_COLLAPSE)||r),r.tabIndex=a,this._setFocusNoScroll(r),s.tabIndex=-1):e.contains(s,o)||o==l||(s.tabIndex=a,this._setFocusNoScroll(s)),this.containsFocus()||(s.tabIndex=a,this._setFocusNoScroll(s))}},a.prototype._setFocusNoScroll=function(t){if(e.getActiveElement()!=t){if(e.supportsFocusOptions())t.focus({preventScroll:!0});else{var i=this.scrollPosition,o=t.style,n=o.position;o.position="fixed",t.focus(),o.position=n,this.scrollPosition=i}this._fixScroll()}},a.prototype._updateDefaultSizes=function(){var e=this._getDefaultRowHeight();return this._rows._setDefaultSize(e),this._cols._setDefaultSize(4*e),this._hdrRows._setDefaultSize(e),this._hdrCols._setDefaultSize(Math.round(1.25*e)),this._ftrRows._setDefaultSize(e),e},a.prototype._getDefaultRowHeight=function(){var t=this.hostElement,i=this._eFocus,o=null;i.offsetHeight||(o=e.createElement('<div><div class="wj-cell">0</div></div>',document.body),t&&o.setAttribute("class",t.getAttribute("class")),i=o.children[0]);var n=i.offsetHeight;return(isNaN(n)||n<=6)&&(n=28),e.removeChild(o),n},a.prototype._getCollectionView=function(t){return e.asCollectionView(t)},a.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);return e.font=t.fontSize+" "+t.fontFamily.split(",")[0],e},a.prototype._getWidestRow=function(t,i,o,n){for(var r=0,s=0,l=1===this._getRowsPerItem()&&t.columns[o].dataType==e.DataType.Boolean,a=i.row;a<=i.row2;a++)if(t.rows[a].isVisible){var c=t.getCellData(a,o,!0),u=n.measureText(c).width,h=this.getMergedRange(t,a,o,!1);if(h&&h.columnSpan>1&&(u/=h.columnSpan),u>s&&(s=u,r=a),l)break;a+=h?h.rowSpan-1:0}return r},a.prototype._getDesiredWidth=function(e,t,i,o){var n=this.getMergedRange(e,t,i,!1),r=o.style;return this.cellFactory.updateCell(e,t,i,o,n),r.width=r.top=r.left="",o.offsetWidth/(n&&n.columnSpan>1?n.columnSpan:1)},a.prototype._getDesiredHeight=function(e,t,i,o){var n=o.style,r=this.getMergedRange(e,t,i,!1),s=r?r.rowSpan:1;return this.cellFactory.updateCell(e,t,i,o,r),o.innerHTML.trim()||(o.innerHTML="&nbsp;"),n.height=n.top=n.left="",o.offsetHeight/s},a.prototype._getDesiredRowHeight=function(e,t,i,o){for(var n=0,r=(e.rows[t],this._getQuickAutoSize()),s=0;s<e.columns.length;s++)if(e.columns[s].isVisible){var l=this.getMergedRange(e,t,s,!1),a=void 0;if(r){var c={ct:e.cellType,col:s,spr:l&&l.rowSpan>1?l.rowSpan:1,spc:l&&l.columnSpan>1?l.columnSpan:1,data:e.getCellData(t,s,!0)||"1"},u=JSON.stringify(c);null==(a=o[u])&&(a=this._getDesiredHeight(e,t,s,i),o[u]=a)}else a=this._getDesiredHeight(e,t,s,i);n=Math.max(a,n),s+=l?l.columnSpan-1:0}return n},a.prototype._getSortRowIndex=function(){return null!=this._sortRowIndex?this._sortRowIndex:this.columnHeaders.rows.length-1},a.prototype._getDeleteColumnIndex=function(){return 0},a.prototype._getEditColumnIndex=function(){return null!=this._editColIndex?this._editColIndex:this.rowHeaders.columns.length-1},a.prototype._sortConverter=function(e,t,i,o){var n,r=this;if(o&&(this._mappedColumns=null,this._cv&&this._cv.sortDescriptions.forEach((function(e){(n=r.getColumn(e.property))&&n.dataMap&&(r._mappedColumns||(r._mappedColumns={}),r._mappedColumns[n.binding]=n.dataMap)})),this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1&&(n=this.columns[this._mouseHdl._htDown.col],this._mappedColumns&&n.dataMap&&(this._mappedColumns[n.binding]=n.dataMap))),this._mappedColumns){var s=this._mappedColumns[e.property];s&&s.sortByDisplayValues&&(i=s.getDisplayValue(i))}return i},a.prototype._bindGrid=function(i){var o=this;if(this.finishEditing(),this.deferUpdate((function(){var n,r;if(o.autoGenerateColumns&&0==o._lastCount&&e.hasItems(o._cv)&&(i=!0),o.preserveSelectedState&&(n=o._getMap())&&o.rows.forEach((function(e){e.isSelected&&e.dataItem&&n.set(e.dataItem,!0)})),o.preserveOutlineState&&o.rows.maxGroupLevel>-1&&(r=o._getMap()))for(var s=0;s<o.rows.length;s++){var l=o.rows[s];if(l instanceof t.GroupRow&&l.isCollapsed&&l.dataItem){var a=l.dataItem;a instanceof e.collections.CollectionViewGroup&&(a=a._path),r.set(a,!0)}}i&&o.columns.deferUpdate((function(){o._bindColumns()}));var c=new e.CancelEventArgs;o.onLoadingRows(c)&&(o.rows.deferUpdate((function(){o._bindRows()})),o.onLoadedRows(c)),o._selHdl.extendedSelection.clear();var u=0;if(n&&n.size&&o.rows.forEach((function(e){var t=e.dataItem;t&&n.has(t)&&(e.isSelected=!0,u++)})),0==u&&o._lastCount>0&&o.selectionMode==t.SelectionMode.ListBox){var h=o.selection;for(s=h.topRow;s<=h.bottomRow&&s>-1&&s<o.rows.length;s++)o.rows[s].isSelected=!0}if(r&&r.size&&o.rows.deferUpdate((function(){o.rows.forEach((function(i){if(i instanceof t.GroupRow){var o=i.dataItem;o instanceof e.collections.CollectionViewGroup&&(o=o._path),r.has(o)&&(i.isCollapsed=!0)}}))})),!o._lastCount){var d=o._cv;d&&d.items&&(o._lastCount=d.items.length)}})),this._cv){var n=i&&!this._toInv;this._syncSelection(n)}},a.prototype._getMap=function(){return window.Map?new Map:null},a.prototype._cvCollectionChanged=function(i,o){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var n=e.collections.NotifyCollectionChangedAction;if(this.childItemsPath&&o.action!=n.Change)this._bindGrid(!1);else{switch(o.action){case n.Change:return void this.invalidate();case n.Add:if(o.index==this._cv.items.length-1){var r=this.rows.length;return this.rows[r-1]instanceof t._NewRowTemplate&&r--,void this.rows.insert(r,new t.Row(o.item))}e.assert(!1,"added item should be the last one.");break;case n.Remove:var s=this._findRow(o.item);if(s>-1)return this.rows.removeAt(s),void this._syncSelection();e.assert(!1,"removed item not found on grid.")}this._bindGrid(!1)}}},a.prototype._cvCurrentChanged=function(e,t){this._syncSelection()},a.prototype._syncSelection=function(i){if(this._cv&&this.selectionMode!=t.SelectionMode.None){var o=this._selHdl.selection,n=o.row>-1&&o.row<this.rows.length?this.rows[o.row]:null,r=n?n.dataItem:null,s=this._cv;if(s instanceof e.collections.CollectionView&&s.isUpdating)return;if(this.newRowAtTop&&n instanceof t._NewRowTemplate)return;if(r instanceof e.collections.CollectionViewGroup&&(r=null),i||r!=s.currentItem||o.row>=this.rows.length){var l=this.editableCollectionView;if(!this.childItemsPath||!l||!l.currentAddItem){var a=this._getRowIndex(s.currentPosition);a==o.row&&this.childItemsPath||(o=new t.CellRange(a,o.col,a,o.col2),this.select(o,!1),this.selectionMode&&!this._updating&&this.scrollIntoView(o.row,-1))}}}},a.prototype._getRowIndex=function(e){if(this._cv){var i=this.rows;if(e>-1){for(var o=this._cv.items[e];e<i.length;e++)if(i[e].dataItem===o)return e;return-1}if(1==i.length&&i[0]instanceof t._NewRowTemplate)return 0;var n=this.selection.row,r=n>-1?i[n]:null;return r&&(r instanceof t.GroupRow||null==r.dataItem)?n:-1}return this.selection.row},a.prototype._getCvIndex=function(e){return e>-1&&e<this.rows.length?this.rows[e].dataIndex:-1},a.prototype._findRow=function(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==e)return t;return-1},a.prototype._updateLayout=function(){var t=new e.CancelEventArgs;if(this.onUpdatingLayout(t)){var i=this._hdrVis&r.Row?this._hdrCols.getTotalSize():0,o=this._hdrVis&r.Column?this._hdrRows.getTotalSize():0,n=this._ftrRows.getTotalSize(),s=this._rows.getTotalSize()+n;s<1&&(s=1),this._heightReal=s,this._heightBrowser=Math.min(s,a._getMaxSupportedCssHeight()),this._maxOffsetY=Math.max(0,s-this._heightBrowser);var l=getComputedStyle(this._eFocus);this._cellPadVert=parseInt(l.paddingTop)+parseInt(l.paddingBottom),this._cellPadHorz=parseInt(l.paddingLeft)+parseInt(l.paddingRight),this._cellPadLeft=parseInt(this.rightToLeft?l.paddingRight:l.paddingLeft);var c=this._heightBrowser+o-n,u=this._gpCells.width,h=this._heightBrowser;!u&&this.rows.length&&(u=.1),!h&&this.columns.length&&(h=.1),this.rightToLeft?(e.setCss(this._eTL,{right:0,top:0,width:i,height:o}),e.setCss(this._eCHdr,{right:i,top:0,height:o}),e.setCss(this._eRHdr,{right:0,top:o,width:i}),e.setCss(this._eCt,{right:i,top:o,width:u,height:h}),e.setCss(this._fCt,{right:i,top:o}),e.setCss(this._eBL,{right:0,top:c,width:i,height:n}),e.setCss(this._eCFtr,{right:i,top:c,height:n})):(e.setCss(this._eTL,{left:0,top:0,width:i,height:o}),e.setCss(this._eCHdr,{left:i,top:0,height:o}),e.setCss(this._eRHdr,{left:0,top:o,width:i}),e.setCss(this._eCt,{left:i,top:o,width:u,height:h}),e.setCss(this._fCt,{left:i,top:o}),e.setCss(this._eBL,{left:0,top:c,width:i,height:n}),e.setCss(this._eCFtr,{left:i,top:c,height:n})),this._stickyHdr&&this._updateStickyHeaders();var d=this.frozenRows||this.frozenColumns?"3":"";e.setCss([this._eTL,this._eBL,this._eCHdr,this._eCFtr,this._eRHdr,this._eMarquee],{zIndex:d}),e.isIE()&&(this._fCt.style.zIndex=d?"2":"");var p=this._root,g=p.offsetWidth-p.clientWidth,f=p.offsetHeight-p.clientHeight;e.setCss(this._eSz,{width:i+g+this._gpCells.width,height:o+f+this._heightBrowser});var _=null;this.columns._updateStarSizes(p.clientWidth-i)&&(_=p.clientWidth,e.setCss(this._eCt,{width:this._gpCells.width}),this.onStarSizedColumns()),this._szClient=new e.Size(p.clientWidth-i,p.clientHeight-o),this._szClientSB=new e.Size(p.offsetWidth-i,p.offsetHeight-o),this._rcBounds=null,this._updateScrollHandler(),this._updateContent(!1),g=p.offsetWidth-p.clientWidth,f=p.offsetHeight-p.clientHeight,e.setCss(this._eSz,{width:i+g+this._gpCells.width,height:o+f+this._heightBrowser}),this._szClient=new e.Size(p.clientWidth-i,p.clientHeight-o),_&&_!=p.clientWidth&&this.columns._updateStarSizes(p.clientWidth-i)&&(e.setCss(this._eCt,{width:this._gpCells.width}),this._updateContent(!1)),e.setCss([this._eCHdr,this._eCFtr,this._fCt],{width:this._szClient.width}),e.setCss([this._eRHdr,this._fCt],{height:this._szClient.height}),n&&(c=Math.min(c,this._szClient.height+o-n),e.setCss([this._eBL,this._eCFtr],{top:c})),this.onUpdatedLayout(t)}},a.prototype._updateStickyHeaders=function(){var t=!1,i=0;if(this._stickyHdr){for(var o=0,n=null,r=this.hostElement;r;r=r.parentElement)if("inline"!=getComputedStyle(r).display){var s=r.getBoundingClientRect();null==n&&(n=s.top),o=Math.max(o,s.top)}i=-(n=Math.max(0,o-n-1)),t=n>0,this._rcBounds=null}this._eTL.style.top=this._eCHdr.style.top=t?-i+"px":"",e.toggleClass(this._eTL,a._WJS_STICKY,t),e.toggleClass(this._eCHdr,a._WJS_STICKY,t)},a.prototype._updateScrollHandler=function(){this._clipToScreen=this._getClipToScreen();var e=this._stickyHdr||this._clipToScreen;e!=this._scrollHandlerAttached&&(this._scrollHandlerAttached=e,e?this.addEventListener(window,"scroll",this._scroll.bind(this),!0):this.removeEventListener(window,"scroll"))},a.prototype._getClipToScreen=function(){if(this.rows.length<=a._MIN_VIRT_ROWS)return!1;if(this._root.scrollHeight>this._root.clientHeight)return!1;for(var e=this.hostElement;e&&e!=document.documentElement;e=e.parentElement)if("auto"==getComputedStyle(e).overflow)return!1;return!0},a.prototype._scroll=function(t){var i=this;e.contains(t.target,this.hostElement)&&(this._clipToScreen&&(this._afClip&&cancelAnimationFrame(this._afClip),this._afClip=requestAnimationFrame((function(){i._afClip=null,i.finishEditing(),i._updateContent(!0)}))),this._stickyHdr&&(this._afSticky&&cancelAnimationFrame(this._afSticky),this._afSticky=requestAnimationFrame((function(){i._afSticky=null;var t=new e.CancelEventArgs;i.onUpdatingLayout(t)&&(i._updateStickyHeaders(),i.onUpdatedLayout(t))}))))},a.prototype._getCssPage=function(t){if(this._heightReal>this._heightBrowser){var i=this._szClient.height-this._gpCFtr.rows.getTotalSize();if(this._heightBrowser>i)return e.clamp(Math.round(t/(this._heightBrowser-i)*10)/10,0,1)}return 0},a.prototype._updateScrollPosition=function(){var t=this._root,i=t.scrollTop,o=t.scrollLeft;this.rightToLeft&&"rev"==a._getRtlMode()&&(o=t.scrollWidth-t.clientWidth-o);var n=new e.Point(-Math.abs(o),-i);return!this._ptScrl.equals(n)&&(this._ptScrl=n,this.onScrollPositionChanged(),!0)},a.prototype._updateContent=function(t,i){var o=this,n=this._root,s=this.hostElement,l=this.cells.hostElement,a=this._activeCell,c=e.getActiveElement(),u=e.contains(s,c),h=e.closest(c,".wj-flexgrid")==s?c:null,d=new e.CancelEventArgs;if(this.onUpdatingView(d)){e.setAttribute(l,"role",this.rows.maxGroupLevel<0?"grid":"treegrid"),this._hasValidation=e.isFunction(this._itemValidator)||this._cv&&e.isFunction(this._cv.getError);var p=!i&&this._errorTip&&this._errorTip._tips.length,g=this._getCssPage(-this._ptScrl.y);g!=this._cssPage&&(this._cssPage=g,this._offsetY=Math.round(this._maxOffsetY*g)),this._updateScrollPosition(),this._updateMarquee();var f=this._gpCells._updateContent(t,i,this._offsetY),_=this._hdrVis;if(_&r.Column&&(!i||this._ssHdr&_)&&(this._gpCHdr._updateContent(t,i,0),this.rightToLeft||(this._eCHdr.scrollLeft=0)),_&r.Row&&(!i||this._ssHdr&_)&&(this._gpRHdr._updateContent(t,i,this._offsetY),this._eRHdr.scrollTop=0),_&&!i&&this._gpTL._updateContent(t,i,0),this._gpCFtr.rows.length&&(this._gpBL._updateContent(t,i,0),this._gpCFtr._updateContent(t,i,0)),p&&this._errorTip&&this._errorTip._tips.length&&(clearTimeout(this._toErrorTips),this._toErrorTips=setTimeout((function(){var t=o._errorTip;if(t){t.hide();for(var i=t._tips,n=0;n<i.length;n++){var r=i[n].element;r.offsetHeight&&e.hasClass(r,"wj-state-invalid")||(t.setTooltip(r,null),n--)}}}),250)),this._useFrozenDiv()&&(this._updateFrozenCells(i),f&&e.hasClass(f,"wj-frozen")&&(f=null)),this._fCt.style.display=this._fCt.childElementCount?"":"none",this._activeCell=f,h)if(h!=n&&h!=this._eFocus&&e.contains(s,h)&&!e.contains(l,h)){if(e.getActiveElement()!==h&&h.focus(),e.isIE()&&h instanceof HTMLInputElement&&!h.type.match(/checkbox|radio|range/i)){var m=h.selectionStart,w=h.selectionEnd;h.setSelectionRange(m,w)}}else{var C=f!==a;this._setFocus(C)}!h&&f&&(f.tabIndex=this.isDisabled?-1:this._orgTabIndex),a&&a!=f&&(a.tabIndex=-1),this._eFocus.tabIndex=null!=f||this.isDisabled?-1:this._orgTabIndex,u&&this.focus(),this._fixScroll(),this._rcBounds=null,this.onUpdatedView(d)}},a.prototype._fixScroll=function(){var t=this._root;if(!this._updating){var i=this.hostElement,o=t?t.parentElement:null,n=this.rightToLeft;i&&(i.scrollTop&&(i.scrollTop=0),i.scrollLeft&&!n&&(i.scrollLeft=0)),o&&(o.scrollTop&&(o.scrollTop=0),o.scrollLeft&&!n&&(o.scrollLeft=0))}e.isSafari()&&t&&(t.style.transform="",t.style.transform="translateZ(0)")},a.prototype._clearCells=function(){for(var e in this)if("_"==e[0]){var i=this[e];i instanceof t.GridPanel&&i._clearCells()}this.invalidate()},a.prototype._useFrozenDiv=function(){return e.isBoolean(this._fzClone)?this._fzClone:e.isIE()||e.isFirefox()||e.isSafari()||e.isMobile()},a.prototype._updateFrozenCells=function(i){var o=this._fCt;if(this.frozenRows||this.frozenColumns){var n=this._eCt.querySelectorAll(".wj-frozen");if(i&&o.children.length==n.length){for(var r=0;r<n.length;r++)o.children[r].className=n[r].className;return}if(e.setText(o,null),!this.activeEditor){var s=this._errorTip,l=navigator.userAgent.indexOf("MSIE")>=0;for(r=0;r<n.length;r++){var a=n[r];if(e.closest(a,".wj-flexgrid")==this.hostElement){var c=a[t.GridPanel._INDEX_KEY];if(l){var u="input[type=checkbox]",h=a.querySelector(u);a=a.cloneNode(!0),h&&(a.querySelector(u).checked=h.checked)}else a=a.cloneNode(!0);if(a[t.GridPanel._INDEX_KEY]=c,s){var d=s.getTooltip(n[r]);d&&s.setTooltip(a,d)}o.appendChild(a)}}}}else e.setText(o,null)},a.prototype._updateMarquee=function(){var t=this._eMarquee,i=this._getMarqueeRect();if(i&&i.width&&i.height){var o=t.firstChild,n=t.offsetWidth-o.offsetWidth,r=t.offsetHeight-o.offsetHeight,s=this.cells.hostElement;e.setCss(t,{left:i.left+s.offsetLeft-n/2,top:i.top+s.offsetTop-r/2,width:i.width+n,height:i.height+r,display:""})}else t.style.display="none"},a.prototype._getMarqueeRect=function(){if(!this._shMarquee||!this.selectionMode)return null;var t=this._selHdl.selection;if(!this.isRangeValid(t))return null;t=(t=(t=this.cells._getAdjustedSelection(t)).combine(this.getMergedRange(this.cells,t.topRow,t.leftCol,!1))).combine(this.getMergedRange(this.cells,t.bottomRow,t.rightCol,!1));var i=this.cells.getCellBoundingRect(t.topRow,t.leftCol,!0),o=this.cells.getCellBoundingRect(t.bottomRow,t.rightCol,!0);if(this.rows.frozen){var n=Math.min(this.rows.length,this.rows.frozen),r=this.cells.getCellBoundingRect(n-1,0,!0);t.topRow>=n&&i.top<r.bottom&&(i.top=r.bottom),t.bottomRow>=n&&o.bottom<r.bottom&&(o.height=r.bottom-o.top)}if(this.columns.frozen){var s=Math.min(this.columns.length,this.columns.frozen);r=this.cells.getCellBoundingRect(0,s-1,!0),this.rightToLeft?(t.leftCol>=s&&i.right>r.left&&(i.left=r.left-i.width),t.rightCol>=s&&o.left>r.left&&(o.left=r.left)):(t.leftCol>=s&&i.left<r.right&&(i.left=r.right),t.rightCol>=s&&o.right<r.right&&(o.width=r.right-o.left))}return this.rightToLeft?new e.Rect(o.left,i.top,i.right-o.left,o.bottom-i.top):new e.Rect(i.left,i.top,o.right-i.left,o.bottom-i.top)},a.prototype._bindColumns=function(){for(var i=this.columns,o=0;o<i.length;o++)i[o]._getFlag(t.RowColFlags.AutoGenerated)&&(i.removeAt(o),o--);var n=this._cv,r=n?n.items:null;r&&r.length&&this.autoGenerateColumns&&this._getColumnTypes(r).forEach((function(o){var n=new t.Column(o);n._setFlag(t.RowColFlags.AutoGenerated,!0),n.name=n.binding,n.header=e.toHeaderCase(n.binding);var r=a._defTypeWidth[n.dataType];if(null!=r){if(e.isString(r)){var s=Math.round(parseFloat(r));r=r.indexOf("*")>-1?s*i.defaultSize:s}e.isNumber(r)&&r>0&&(n.width=r)}i.push(n)})),this._updateColumnTypes()},a.prototype._getColumnTypes=function(t){return e.getTypes(t)},a.prototype._updateColumnTypes=function(){var t=this._cv;if(e.hasItems(t)){var i=t.items[0];this.columns.forEach((function(t){null==t.dataType&&t._binding&&(t.dataType=e.getType(t._binding.getValue(i)))}))}},a.prototype._getMapEditor=function(e,i){return i.editor?null!=i.editor.isDroppedDown?i.dataMapEditor:null:!e.dataMap||e instanceof t.GroupRow?i.dataMap?i.dataMapEditor:null:e.dataMapEditor},a.prototype._getBindingColumn=function(e,t,i){return i},a.prototype._getBindingColumns=function(){return this.columns},a.prototype._getRowsPerItem=function(){return 1},a.prototype._isTransposed=function(){return!1},a.prototype._getRowHeaderPath=function(){return this._rowHdrPath},a.prototype._bindRows=function(){this.rows.clear();var e=this._cv;if(e&&e.items){var t=e.items,i=e.groups;if(this.childItemsPath)for(var o=0;o<t.length;o++)this._addNode(t,o,0);else if(null!=i&&i.length>0&&this.showGroups)for(o=0;o<i.length;o++)this._addGroup(i[o]);else for(o=0;o<t.length;o++)this._addBoundRow(t,o)}},a.prototype._addBoundRow=function(e,i){var o=new t.Row(e[i]),n=this.rows;o._list=n,n[n.length++]=o},a.prototype._addGroupRow=function(e){this.rows.push(new t.GroupRow(e))},a.prototype._addNode=function(i,o,n){var r=i[o],s=this.childItemsPath,l=r[e.isArray(s)?s[n]:s],a=new t.GroupRow(r);if(a.level=n,this.rows.push(a),e.isArray(l))for(var c=0;c<l.length;c++)this._addNode(l,c,n+1)},a.prototype._addGroup=function(e){if(this._addGroupRow(e),e.isBottomLevel)for(var t=e.items,i=0;i<t.length;i++)this._addBoundRow(t,i);else for(i=0;i<e.groups.length;i++)this._addGroup(e.groups[i])},a._getSerializableProperties=function(e){var t=[];for(e=e.prototype;e!=Object.prototype;e=Object.getPrototypeOf(e))for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var n=i[o],r=Object.getOwnPropertyDescriptor(e,n);r&&r.set&&r.get&&"_"!=n[0]&&!n.match(/^(disabled|required|showDropDown)$/)&&t.push(n)}return t},a.prototype._hasColumnGroups=function(){return this._grpHdl.hasColumnGroups()},a.prototype._getColumnGroup=function(e,t){return this._grpHdl.getColumnGroup(e,t)},a.prototype._canMoveColumnGroup=function(e,t,i,o){return this._grpHdl.canMoveColumnGroup(e,t,i,o)},a.prototype._moveColumnGroup=function(e,t,i,o,n){return this._grpHdl.moveColumnGroup(e,t,i,o,n)},a.prototype._copy=function(i,o){var n=this;if("columns"==i){var r=e.asArray(o);return r.some((function(e){return null!=e.columns}))?this.columnGroups=r:(this.columns.clear(),r.forEach((function(e){var i=new t.Column(e);n.columns.push(i)}))),!0}return!1},a.prototype._isInputElement=function(t){return t instanceof HTMLElement&&!e.hasClass(t,"wj-btn-glyph")&&("true"==t.contentEditable||null!=t.tagName.match(/^(INPUT|TEXTAREA|BUTTON|A|SELECT|OPTION)$/i))},a.prototype._isNativeCheckbox=function(i){return i instanceof HTMLInputElement&&"checkbox"==i.type&&!i.disabled&&!i.readOnly&&e.hasClass(i,t.CellFactory._WJC_CHECKBOX)&&e.closest(i,".wj-flexgrid")==this.hostElement},a.prototype._wantsInput=function(t){return this._isInputElement(t)&&!this.activeEditor&&!this._isNativeCheckbox(t)&&!e.hasClass(t,"wj-grid-ime")&&e.contains(document.body,t)},a._getMaxSupportedCssHeight=function(){if(!a._maxCssHeight){var t=265e5;e.isIE()?t=15e5:e.isFirefox()&&(t=175e5),a._maxCssHeight=t}return a._maxCssHeight},a._getRtlMode=function(){if(!a._rtlMode){var t=e.createElement('<div dir="rtl"><div></div></div>');e.setCss(t,{visibility:"hidden",width:100,height:100,overflow:"auto"}),e.setCss(t.firstChild,{width:2e3,height:2e3}),document.body.appendChild(t);var i=t.scrollLeft;t.scrollLeft=-1e3;var o=t.scrollLeft;e.removeChild(t),a._rtlMode=o<0?"neg":i>0?"rev":"std"}return a._rtlMode},a._WJS_STICKY="wj-state-sticky",a._WJS_MEASURE="wj-state-measuring",a._WJS_UPDATING="wj-state-updating",a._WJS_WSPRE="wj-whitespace-pre",a._MIN_VIRT_ROWS=200,a._defTypeWidth=((i={})[e.DataType.Number]="0.714285714*",i),a.controlTemplate='<div><div wj-part="root"><div wj-part="cells" class="wj-cells"></div><div wj-part="marquee" class="wj-marquee"><div></div></div></div><div wj-part="fcells" aria-hidden="true" class="wj-cells wj-frozen-clone"></div><div wj-part="rh"><div wj-part="rhcells" class="wj-rowheaders"></div></div><div wj-part="cf"><div wj-part="cfcells" class="wj-colfooters"></div></div><div wj-part="ch"><div wj-part="chcells" class="wj-colheaders"></div></div><div wj-part="bl"><div wj-part="blcells" class="wj-bottomleft"></div></div><div wj-part="tl"><div wj-part="tlcells" class="wj-topleft"></div></div><div wj-part="focus" class="wj-cell">0</div><div wj-part="sz"></div></div>',a}(e.Control);t.FlexGrid=l}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function i(t){this._updateImeFocusAsyncBnd=this._updateImeFocusAsync.bind(this),this._cmpstartBnd=this._compositionstart.bind(this),this._keypressBnd=this._keypress.bind(this),this._g=t;var o=e.createElement('<textarea class="wj-grid-editor wj-form-control wj-grid-ime" aria-hidden="true"/>');e.setCss(o,i._cssHidden),e.disableAutoComplete(o),o.tabIndex=-1,this._tbx=o,this._maskProvider=new e._MaskProvider(o),t._root.appendChild(o),this._updateImeFocus();var n=t.hostElement,r=t.addEventListener.bind(t),s=this._updateImeFocusAsyncBnd;r(n,"blur",s,!0),r(n,"focus",s),r(o,"compositionstart",this._cmpstartBnd),e.isiOS()&&r(n,"keypress",this._keypressBnd),t.selectionChanged.addHandler(s,this),t.cellEditEnded.addHandler(this._cellEditEnded,this),t.cellEditEnding.addHandler(this._cellEditEnding,this)}return i.prototype.dispose=function(){var t=this._g,i=t.hostElement,o=this._tbx,n=t.removeEventListener.bind(t),r=this._updateImeFocusAsyncBnd;n(i,"blur",r),n(i,"focus",r),n(i,"keypress",this._keypressBnd),n(o,"compositionstart",this._cmpstartBnd),t.selectionChanged.removeHandler(r),t.cellEditEnded.removeHandler(this._cellEditEnded),t.cellEditEnding.removeHandler(this._cellEditEnding),e.removeChild(o)},i.prototype._compositionstart=function(t){var i=this._g;if(!i.activeEditor){var o=i._selHdl.selection;if(i.startEditing(!1,o.row,o.col,!1,t)&&i.activeEditor&&"checkbox"!=i.activeEditor.type){o=i.editRange;var n=i.activeEditor,r=this._tbx,s=i.cells.hostElement,l=i.columns[o.col].pos+s.offsetLeft,a=i.rows[o.row].pos+s.offsetTop,c=i.getCellBoundingRect(o.row,o.col),u=e.closest(n,".wj-cell");c.width=u.offsetWidth,c.height=u.offsetHeight,o.row<i.frozenRows&&(a+=i._root.scrollTop),o.col<i.frozenColumns&&(l+=i._root.scrollLeft);var h=u.querySelector(".wj-btn.wj-right");h&&(c.width-=h.offsetWidth),"minLength,maxLength,pattern".split(",").forEach((function(t){e.setAttribute(r,t,n.getAttribute(t))}));var d=n instanceof HTMLTextAreaElement;e.setAttribute(r,"wrap",d?"soft":"off");var p=getComputedStyle(u),g=p.paddingTop;if(o.rowSpan>1&&!d){var f=parseFloat(p.lineHeight);isNaN(f)&&(f=1.2*parseFloat(p.fontSize)),g=Math.max(0,(c.height-f)/2)+"px"}var _={position:"absolute",left:l,top:a,width:c.width-1,height:c.height-1,paddingTop:g,paddingLeft:p.paddingLeft,paddingRight:p.paddingRight,textAlign:p.textAlign,zIndex:u.style.zIndex};i.rightToLeft&&(_.right=parseInt(u.style.right)+parseInt(i.cells.hostElement.style.right),_.left=""),e.setCss(r,_),i._edtHdl._edt=r,r.select();var m=n.value;setTimeout((function(){"　"!=r.value&&" "!=r.value||(r.value=m),e.setSelectionRange(r,r.value.length)}),20),r.placeholder=n.placeholder,n.placeholder="",n.value=""}}},i.prototype._cellEditEnding=function(){var e=this._maskProvider;e&&e.mask&&e._valueChanged()},i.prototype._cellEditEnded=function(){var t=this._tbx;t.value="",e.setCss(t,i._cssHidden),this._updateImeFocus()},i.prototype._keypress=function(e){e.defaultPrevented||e.target!=this._tbx||e.ctrlKey||e.altKey||e.metaKey||27==e.keyCode||this._g.activeEditor||(this._tbx.value="",this._compositionstart(e),e.stopPropagation())},i.prototype._updateImeFocus=function(){var t=this._g,i=this._tbx,o=e.getActiveElement(),n=t._getTabIndex();if(!t.activeEditor&&e.closest(o,".wj-flexgrid")==t.hostElement)if(this._enableIme()){o!=i&&(t.activeCell&&(t.activeCell.tabIndex=-1),i.tabIndex=n,i.disabled=!1,i.value="",e.setSelectionRange(i,0),i.focus());var r=t._selHdl.selection,s=r.isValid?t._getBindingColumn(t.cells,r.row,t.columns[r.col]):null;this._maskProvider.mask=s?s.mask:null}else if(i.tabIndex=-1,i.disabled=!0,i.value="",o==i){i.blur();var l=t.activeCell;l?(l.tabIndex=n,l.focus()):t.focus()}},i.prototype._updateImeFocusAsync=function(){var e=this;this._toFocus&&clearTimeout(this._toFocus),this._toFocus=setTimeout((function(){e._toFocus=null,e._updateImeFocus()}),100)},i.prototype._enableIme=function(){var i=this._g,o=i._selHdl.selection;if(!i.canEditCell(o.row,o.col))return!1;var n=o.isValid?i._getBindingColumn(i.cells,o.row,i.columns[o.col]):null;return!(!n||n.editor||n.dataType==e.DataType.Boolean||n&&n.dataMap&&n.dataMapEditor==t.DataMapEditor.RadioButtons)},i._cssHidden={position:"fixed",width:"1px",left:-32e3,top:-32e3,overflow:"hidden"},i}();t._ImeHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function i(e){this._nrt=new o,this._top=!1,this._keydownBnd=this._keydown.bind(this),this._committing=!1,this._g=e,this._attach()}return Object.defineProperty(i.prototype,"newRowAtTop",{get:function(){return this._top},set:function(i){if(i!=this.newRowAtTop){this._top=e.asBoolean(i),this.updateNewRowTemplate();var o=this._g;this._top&&o.selectionMode==t.SelectionMode.ListBox&&(o.rows.forEach((function(e,i){e._setFlag(t.RowColFlags.Selected,0==i,!0)})),o.select(0,o.selection.col))}},enumerable:!0,configurable:!0}),i.prototype.updateNewRowTemplate=function(){var e=this._g,i=e.editableCollectionView,o=e.rows,n=this._nrt,r=i&&i.canAddNew&&e.allowAddNew&&!e.isReadOnly,s=o.indexOf(n),l=this._top?0:o.length-1,a=!1;if(!r&&s>-1){var c=e.selection;c.row==s&&e.select(c.row-1,c.col),o.removeAt(s)}else r&&(s<0?a=!0:s!=l&&(o.removeAt(s),a=!0),a&&(this._top?o.insert(0,n):o.push(n)),n&&(n._ubv=null,n._setFlag(t.RowColFlags.ParentCollapsed,!1),this._top&&e.selectionMode==t.SelectionMode.ListBox||n._setFlag(t.RowColFlags.Selected,!1)))},i.prototype._attach=function(){var e=this._g;e&&(e.beginningEdit.addHandler(this._beginningEdit,this),e.pastingCell.addHandler(this._beginningEdit,this),e.rowEditEnded.addHandler(this._rowEditEnded,this),e.loadedRows.addHandler(this.updateNewRowTemplate,this),e.hostElement.addEventListener("keydown",this._keydownBnd,!0))},i.prototype._detach=function(){var e=this._g;e&&(e.beginningEdit.removeHandler(this._beginningEdit),e.pastingCell.removeHandler(this._beginningEdit),e.rowEditEnded.removeHandler(this._rowEditEnded),e.loadedRows.removeHandler(this.updateNewRowTemplate),e.hostElement.removeEventListener("keydown",this._keydownBnd,!0))},i.prototype._keydown=function(t){!t.defaultPrevented&&t.keyCode==e.Key.Escape&&null==this._g.activeEditor&&this._top&&this._nrt.dataItem&&(this._nrt.dataItem=null,this._g.invalidate())},i.prototype._beginningEdit=function(t,i){if(!i.cancel){var n=t.rows[i.row];if(n instanceof o){var r=t.editableCollectionView;if(r&&r.canAddNew)if(this._top){if(null==this._nrt.dataItem){var s=null,l=r.sourceCollection,a=r.newItemCreator;s=e.isFunction(a)?a():l&&l.length?new l[0].constructor:{},this._nrt.dataItem=s}}else{s=r.currentAddItem&&r.currentAddItem==n.dataItem?r.currentAddItem:r.addNew(),r.moveCurrentTo(s);var c=this._nrt.isSelected;this.updateNewRowTemplate(),c&&i.row>-1&&(t.rows[i.row].isSelected=!0),t.isUpdating||t.refresh(!0),t.onRowAdded(i)||r.cancelNew()}}}},i.prototype._rowEditEnded=function(e,t){var i=this,o=e.editableCollectionView,n=this._nrt.dataItem;if(o&&!this._committing)if(o.isAddingNew)o.commitNew();else if(n&&!t.cancel){this._committing=!0,this._nrt.dataItem=null;var r=o.addNew();for(var s in n)r[s]=n[s];e.onRowAdded(t)?o.commitNew():o.cancelNew(),setTimeout((function(){e.select(0,e.columns.firstVisibleIndex),i.updateNewRowTemplate()}),20),this._committing=!1}},i}();t._AddNewHandler=i;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(t.Row);t._NewRowTemplate=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None",e[e.Cells=1]="Cells",e[e.ColumnHeaders=2]="ColumnHeaders",e[e.RowHeaders=4]="RowHeaders",e[e.AllHeaders=6]="AllHeaders",e[e.All=7]="All"}(i=t.AllowMerging||(t.AllowMerging={}));var o=function(){function o(e){null!=e&&console.error('** WARNING: the "grid" parameter has been deprecated. Please remove it.')}return o.prototype.getMergedRange=function(o,n,r,s){void 0===s&&(s=!0);var l=o.grid,a=o.cellType,c=o.columns,u=o.rows,h=u[n],d=c[r];if(h instanceof t._NewRowTemplate)return null;if(!(h instanceof t.Row&&d instanceof t.Column))return null;if(o==l.columnHeaders){var p=l._getColumnGroup(n,r);if(p){var g=p._rng,f=o.columns;return f.isFrozen(g.col)!=f.isFrozen(g.col2)&&(g=g.clone(),f.isFrozen(r)?g.col2=f.frozen-1:g.col=f.frozen),g}}if(l.showGroups&&!l.childItemsPath&&h instanceof t.GroupRow&&h.dataItem instanceof e.collections.CollectionViewGroup&&a==t.CellType.Cell){if(g=new t.CellRange(n,r),d.aggregate==e.Aggregate.None){for(;g.col>0&&c[g.col-1].aggregate==e.Aggregate.None&&g.col!=c.frozen;)g.col--;for(;g.col2<c.length-1&&c[g.col2+1].aggregate==e.Aggregate.None&&g.col2+1!=c.frozen;)g.col2++}for(;g.col<r&&!c[g.col].visible;)g.col++;return g.isSingleCell?null:g}var _=!1,m=i,w=t.CellType;switch(l.allowMerging){case m.None:_=!0;break;case m.Cells:_=a!=w.Cell;break;case m.ColumnHeaders:_=a!=w.ColumnHeader&&a!=w.TopLeft;break;case m.RowHeaders:_=a!=w.RowHeader&&a!=w.TopLeft;break;case m.AllHeaders:_=a==w.Cell}if(_)return null;if(a==w.Cell){var C=l.editableCollectionView,v=C?C.currentAddItem:null;if(v&&h.dataItem==v)return null}if(c[r].allowMerging){g=new t.CellRange(n,r);var y=o._vrb,b=0,R=u.length-1;n>=u.frozen?s&&(a==t.CellType.Cell||a==t.CellType.RowHeader)&&l._vtRows<u.length&&y&&(b=y.topRow,R=y.bottomRow):u.length>u.frozen&&(R=u.frozen-1);for(var E=n-1;E>=b&&this._mergeCell(o,E,r,n,r);E--)g.row=E;for(var S=n+1;S<=R&&this._mergeCell(o,n,r,S,r);S++)g.row2=S;for(;g.row<n&&!u[g.row].visible;)g.row++;if(!g.isSingleCell)return g}if(u[n].allowMerging){g=new t.CellRange(n,r),y=o._vrb;var x=0,H=c.length-1;r>=c.frozen?s&&(a==t.CellType.Cell||a==t.CellType.ColumnHeader)&&l._vtCols<c.length&&y&&(x=y.leftCol,H=y.rightCol):H=c.frozen-1;for(var z=r-1;z>=x&&this._mergeCell(o,n,z,n,r);z--)g.col=z;for(var P=r+1;P<=H&&this._mergeCell(o,n,r,n,P);P++)g.col2=P;for(;g.col<r&&!c[g.col].visible;)g.col++;if(!g.isSingleCell)return g}return null},o.prototype._mergeCell=function(e,i,o,n,r){var s=e.rows[i],l=e.rows[n];if(!s||!l)return!1;if(s instanceof t.GroupRow||s instanceof t._NewRowTemplate||l instanceof t.GroupRow||l instanceof t._NewRowTemplate)return!1;var a=e.grid.editableCollectionView,c=a?a.currentAddItem:null;if(c&&(s.dataItem==c||l.dataItem==c))return!1;if(i!=n&&e.rows.isFrozen(i)!=e.rows.isFrozen(n))return!1;if(o!=r&&e.columns.isFrozen(o)!=e.columns.isFrozen(r))return!1;if(i!=n){if(o>0&&(s.allowMerging&&this._mergeCell(e,i,o-1,i,o)||l.allowMerging&&this._mergeCell(e,n,o-1,n,o)))return!1;if(r<e.columns.length-1&&(s.allowMerging&&this._mergeCell(e,i,r,i,r+1)||l.allowMerging&&this._mergeCell(e,n,r,n,r+1)))return!1}return e.getCellData(i,o,!0)==e.getCellData(n,r,!0)},o}();t.MergeManager=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function i(o,n){var r;if(this._row=-1,this._col=-1,this._edge=0,n instanceof Element){if(e.closest(n,".wj-flexgrid")!=o.hostElement)return;o=n,this._target=n}if(!(o instanceof Element)||o instanceof t.FlexGrid){if(o instanceof t.FlexGrid)this._target=o.hostElement,r=this._g=o;else{if(!(o instanceof t.GridPanel))throw"First parameter should be a FlexGrid or GridPanel.";this._target=o.hostElement,this._p=o,r=this._g=this._p.grid}n instanceof MouseEvent&&(this._target=n.target,"mousedown"==n.type&&(r._rcBounds=null)),n=e.mouseToPage(n),this._pt=n.clone();var s=r.controlRect,l=r._szClient,a=r.topLeftCells,c=r._eTL,u=r.headersVisibility,h=t.HeadersVisibility,d=u&h.Row?a.columns.getTotalSize():0,p=u&h.Column?a.rows.getTotalSize():0,g=u&h.Column?p+c.offsetTop:0,f=r._eBL,_=f.offsetHeight;if(n.x-=s.left,n.y-=s.top,r.rightToLeft&&(n.x=s.width-n.x),this._p||n.x>=0&&n.y>=c.offsetTop&&l&&n.x<=l.width+d&&n.y<=l.height+p&&(n.y<g?this._p=n.x<d?r.topLeftCells:r.columnHeaders:n.y<f.offsetTop?this._p=n.x<d?r.rowHeaders:r.cells:this._p=n.x<d?r.bottomLeftCells:r.columnFooters),null!=this._p){var m=this._p.rows,w=this._p.columns,C=this._p.cellType,v=t.CellType,y=this._p._getFrozenPos(),b=C==v.TopLeft||C==v.ColumnHeader?p:C==v.BottomLeft||C==v.ColumnFooter?_:m.getTotalSize(),R=C==v.TopLeft||C==v.BottomLeft||C==v.RowHeader?d:w.getTotalSize();C==v.RowHeader||C==v.Cell?(n.y-=p,(n.y>y.y||y.y<=0)&&(n.y-=r._ptScrl.y,n.y+=this._p._getOffsetY())):C!=v.BottomLeft&&C!=v.ColumnFooter||(n.y-=f.offsetTop),C!=v.ColumnHeader&&C!=v.Cell&&C!=v.ColumnFooter||(n.x-=d,(n.x>y.x||y.x<=0)&&(n.x-=r._ptScrl.x)),C!=v.ColumnHeader&&C!=v.TopLeft||(n.y-=g-p),this._edge=0;var E=i._SZEDGE[this._g.isTouching?1:0];if(this._g.isTouching&&(E=i._SZEDGE[1],n.x-=E/2),this._row=n.y>b?-1:m.getItemAt(n.y),this._col=n.x>R?-1:w.getItemAt(n.x),this._row<0||this._col<0)return void(this._p=null);if(this._col>-1){var S=w[this._col];n.x-S.pos<=E&&(this._edge|=1);var x=S.pos+S.renderSize-n.x;x<=E&&(this._edge|=4,x<=E/2&&(this._edge|=16))}if(this._row>-1){var H=m[this._row];n.y-H.pos<=E&&(this._edge|=2);var z=H.pos+H.renderSize-n.y;z<=E&&(this._edge|=8,z<=E/2&&(this._edge|=32))}}}else{var P=e.closest(o,".wj-cell"),M=P?P[t.GridPanel._INDEX_KEY]:null;M&&(this._target=o,this._row=M.row,this._col=M.col,this._rng=M.rng,this._p=M.panel,this._g=M.panel.grid)}}return Object.defineProperty(i.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellType",{get:function(){return this._p?this._p.cellType:t.CellType.None},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"grid",{get:function(){return this._p?this._p.grid:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),i.prototype.getRow=function(){return this._p&&this._row>-1?this._p.rows[this._row]:null},Object.defineProperty(i.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),i.prototype.getColumn=function(e){var i=this._p,o=i&&this._col>-1?i.columns[this._col]:null;if(o&&e){var n=i.grid;o=i.cellType===t.CellType.ColumnHeader&&n._hasColumnGroups()?n._getColumnGroup(this._row,this._col):n._getBindingColumn(i,this._row,o)}return o},Object.defineProperty(i.prototype,"range",{get:function(){return this._rng||(this._rng=new t.CellRange(this._row,this._col)),this._rng},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeLeft",{get:function(){return 0!=(1&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeTop",{get:function(){return 0!=(2&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeRight",{get:function(){return 0!=(4&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeFarRight",{get:function(){return 0!=(16&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeBottom",{get:function(){return 0!=(8&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeFarBottom",{get:function(){return 0!=(32&this._edge)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),i._SZEDGE=[6,30],i}();t.HitTestInfo=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){(e.grid||(e.grid={})).softInput=function(){return e._getModule("wijmo.input")}}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function i(){}return i.prototype.updateCell=function(c,u,h,d,p,g){var f=c.grid,_=f.rightToLeft,m=c.rows,w=c.columns,C=m[u],v=w[h],y=u,b=h,R=C instanceof t.GroupRow?C:null,E=C instanceof t._NewRowTemplate?C:null,S=v.renderWidth,x=C.renderHeight,H=c.cellType,z="wj-cell",P="",M={display:""},T=t.CellType;0!=g&&d.firstElementChild&&(1==d.childNodes.length&&"checkbox"==d.firstElementChild.type||(d.textContent="")),p&&!p.isSingleCell&&(u=p.row,h=p.col,y=p.row2,b=p.col2,C=m[u],v=w[h],R=C instanceof t.GroupRow?C:null,x=(V=p.getRenderSize(c)).height,S=V.width);var I=f._getBindingColumn(c,u,v),D=I.dataType||C.dataType,A=I.dataMap||C.dataMap,O=H==T.Cell?f._getMapEditor(C,I):null,j=H==T.RowHeader||H==T.Cell&&(!R||f.childItemsPath),L=j&&O==t.DataMapEditor.RadioButtons,k=D==e.DataType.Boolean&&!A,B=I.isContentHtml||C.isContentHtml,N=v.pos,F=C.pos,G=f._ptScrl;if(f._useFrozenDiv()&&H==T.Cell&&!f.editRange)h<w.frozen&&y>=m.frozen?F+=G.y:u<m.frozen&&b>=w.frozen&&(N+=G.x);else{var V=f._szClient;y<m.frozen&&(F=Math.min(F,V.height),x=Math.min(x,Math.max(0,V.height-F)),F-=G.y),b<w.frozen&&(N=Math.min(N,V.width),S=Math.min(S,Math.max(0,V.width-N)),N-=G.x)}_?M.right=N+"px":M.left=N+"px",y>=m.frozen&&(F-=c._getOffsetY()),M.top=F+"px",M.width=S+"px",M.height=x+"px",M.zIndex="",(u<m.frozen||h<w.frozen)&&(M.zIndex=u<m.frozen&&h<w.frozen?2:1);var K=!1,W=f.alternatingRowStep;if(!W||p&&p.row!=p.row2||(K=C.visibleIndex%(W+1)==0,1==W&&(K=!K)),H==T.Cell)R&&(z+=" wj-group"),K&&(z+=" wj-alt"),(u<m.frozen||h<w.frozen)&&(z+=" wj-frozen"),E&&(z+=" wj-new"),C.cssClass&&(z+=" "+C.cssClass),I.cssClass&&(z+=" "+I.cssClass);else{z+=" wj-header",K&&(z+=" wj-header-alt"),C.cssClass&&H==T.ColumnHeader&&(z+=" "+C.cssClass),I.cssClass&&H==T.RowHeader&&(z+=" "+I.cssClass);var q=!1;H!=T.ColumnHeader&&H!=T.TopLeft||f.allowResizing&t.AllowResizing.Columns&&(q=null!=f._mouseHdl._getResizeCol(c,b)),q||H!=T.RowHeader||f.allowResizing&t.AllowResizing.Rows&&(q=null!=f._mouseHdl._getResizeRow(c,y)),q&&(z+=" wj-big-header")}C.cssClassAll&&(z+=" "+C.cssClassAll),I.cssClassAll&&(z+=" "+I.cssClassAll);var U=t.SelectedState,J=c.getSelectedState(u,h,p);switch(J!=U.None&&H==T.Cell&&!k&&f.editRange&&f.editRange.contains(u,h)&&(J=U.None),J){case U.Active:z+=" wj-state-active";break;case U.Cursor:z+=" wj-state-selected wj-state-active";break;case U.Selected:z+=" wj-state-multi-selected"}y==m._lastFrozen&&(z+=" wj-frozen-row"),b==w._lastFrozen&&(z+=" wj-frozen-col"),(I.wordWrap||C.wordWrap)&&(z+=" wj-wrap"),(I.multiLine||C.multiLine)&&(z+=" wj-multiline");var Y=I.getAlignment(C);Y&&(P=" wj-align-"+Y);var X=H,$=f._isTransposed(),Z=(X==T.ColumnHeader&&!$||X==T.RowHeader&&$)&&f._hasColumnGroups()?f._getColumnGroup(u,h):null;if(Z&&Z.align&&(P=" wj-align-"+Z.align),M.paddingLeft=M.paddingRight=M.paddingTop=M.paddingBottom="",H==T.Cell&&f.rows.maxGroupLevel>-1&&h==w.firstVisibleIndex&&f.treeIndent){var Q=R?Math.max(0,R.level):m.maxGroupLevel+1,ee=Math.min(f.treeIndent*Q+f._cellPadLeft,S-f._cellPadHorz)+"px";_?M.paddingRight=ee:M.paddingLeft=ee}S<=f._cellPadHorz&&null==d.getAttribute(t.FlexGrid._WJS_MEASURE)&&(M.paddingLeft=M.paddingRight=0);var te=H==T.Cell&&h==w.firstVisibleIndex&&R&&R.hasChildren&&!n(f,u,h);if(te&&(P=""),0!=g){var ie=c.getCellData(u,h,!1),oe=c.getCellData(u,h,!0);if(te){var ne=l(R);oe=R.getGroupHeader()||e.escapeHtml(oe),d.innerHTML=ne.outerHTML+" "+oe}else if(H!=T.ColumnHeader||y!=f._getSortRowIndex()&&I==v)if(H==T.RowHeader&&!oe&&function(){var e=!1;if(h==f._getEditColumnIndex()){var i=f.editableCollectionView,n=i?i.currentEditItem:null;oe=d.innerHTML=n&&C.dataItem==n?a("pencil"):C instanceof t._NewRowTemplate?a("asterisk"):"",e=!0}var r=I._tpl;return r&&(o(r,d,ie,oe,C,I),e=!0),e}());else if(H!=T.Cell||D!=e.DataType.Boolean||A||R&&!e.isBoolean(ie))if(H==T.Cell&&!L&&n(f,u,h)){var re=I.inputType||C.inputType;if(re||(re=D!=e.DataType.Number||A?"text":"tel"),!A&&!I.mask&&!C.mask){var se=c.getCellData(u,h,!1);e.isNumber(se)&&(oe=function(t,i){i=i||"n";var o=e.Globalize._parseNumericFormat(i);switch(o.spec){case"d":case"x":break;case"e":i=i.replace(/[0-9]/g,"");break;default:i="p"==o.spec?"P15":"r",o.scale&&(i+=Array(o.scale/3+1).join(","))}return e.Globalize.formatNumber(t,i,!0)}(se,I.format||C.format))}d.innerHTML=(I.multiLine||C.multiLine)&&"checkbox"!=re?'<textarea wrap="soft"></textarea>':'<input type="'+re+'"/>';var le=d.children[0];e.addClass(le,"wj-grid-editor wj-form-control"),e.disableAutoComplete(le),B&&A&&!A.isEditable&&(oe=e.toPlainText(oe)),le.value=oe,le.tabIndex=-1,le.required=I.getIsRequired(C),e.setAttribute(le,"aria-required",le.required);var ae=I.maxLength||C.maxLength;ae&&(le.maxLength=ae),le.style.textAlign=I.getAlignment(C);var ce=I.mask||C.mask;ce&&(le["$WJ-MSKP"]=new e._MaskProvider(le,ce)),f.showPlaceholders&&(le.placeholder=I.header),f._edtHdl._edt=le}else{if(L){var ue=[],he=c.getCellData(u,h,!1);A.getDisplayValues(C.dataItem).forEach((function(t){var i=A.getKeyValue(t)==he?" checked":"",o=f.isReadOnly||C.isReadOnly||v.isReadOnly?" disabled":"",n=e.escapeHtml(t);ue.push('<label><input type="radio" tabindex="-1"'+i+o+' value="'+n+'"><span>'+n+"</span></label>")})),d.innerHTML=ue.join(" "),z+=" "+i._WJC_RADIOMAP}var de=j?I._tpl:null;if(de?o(de,d,ie,oe,C,I):L||(H==T.Cell&&B?d.innerHTML=oe:d.textContent=oe||""),Z&&Z.collapseTo){var pe=Z._rng;if(pe&&(H==T.ColumnHeader&&pe.columnSpan>1||H==T.RowHeader&&pe.rowSpan>1)){var ge=Z.isCollapsed;d.innerHTML='<div role="button" class="'+i._WJC_COLLAPSE+'">'+a(ge?"plus":"minus")+"</div>&nbsp;"+d.innerHTML,ge&&e.addClass(d,"wj-state-collapsed")}}}else{var fe=d.firstChild;f._isNativeCheckbox(fe)||(d.innerHTML='<label><input type="checkbox" class="'+i._WJC_CHECKBOX+'" tabindex="-1"/><span></span></label>',fe=d.querySelector("input")),e.setChecked(fe,ie),fe.disabled=!f.canEditCell(u,h),fe.disabled&&(fe.style.cursor="default"),f.editRange&&f.editRange.contains(u,h)&&(f._edtHdl._edt=fe)}else{d.innerHTML=e.escapeHtml(oe);var _e=I.currentSort;_e&&f.showSort&&(z+=" wj-sort-"+("+"==_e?"asc":"desc"),d.innerHTML+="&nbsp;"+function(e){var t=a("+"==e.currentSort?"up":"down"),i=e.grid.collectionView;if(i&&i.sortDescriptions.length>1){var o=e.currentSortIndex;o>-1&&(t+='<span class="wj-sort-index">'+(o+1)+"</span>")}return t}(I)),f.allowPinning&&e.contains(f.hostElement,d)&&s(d,h<f.frozenColumns)}if(O==t.DataMapEditor.DropDownList&&f.showDropDown&&f.canEditCell(u,h)&&t.softInput()){var me=r();d.insertBefore(me,d.firstChild),n(f,u,h)&&(z+=" wj-hasdropdown")}}if(H==T.RowHeader||H==T.ColumnHeader){var we=H==T.RowHeader?!R&&!E&&C.allowDragging&&0!=(f.allowDragging&t.AllowDragging.Rows):(Z||v).allowDragging&&0!=(f.allowDragging&t.AllowDragging.Columns);e.setAttribute(d,"draggable",we?"true":null)}z+=P,d.className!=z&&(d.className=z);var Ce=d.style;for(var ve in M)Ce[ve]!==M[ve]&&(Ce[ve]=M[ve]);if(f._edtHdl._edt&&f._edtHdl._edt.parentElement==d){var ye=f._root,be=ye.getBoundingClientRect(),Re=d.getBoundingClientRect(),Ee=be.top+ye.clientHeight-Re.top,Se=be.left+ye.clientWidth-Re.left;Re.height>Ee&&(d.style.height=Ee+"px"),Re.width>Se&&(d.style.width=Se+"px")}if((H==T.Cell||H==T.RowHeader)&&f._getShowErrors()){var xe=f._getError(c,u,h,!1);f._edtHdl._setCellError(d,xe)}if(f.itemFormatter&&f.itemFormatter(c,u,h,d),f.formatItem.hasHandlers){var He=i._fmtItemArgs;He?(He._p=c,He._rng.setRange(u,h,y,b),He._cell=d):He=i._fmtItemArgs=new t.FormatItemEventArgs(c,new t.CellRange(u,h,y,b),d),He._updateContent=!1!==g,f.onFormatItem(He)}},i.prototype.disposeCell=function(e){},i.prototype.getEditorValue=function(t){var i=t._edtHdl._edt;if(i instanceof HTMLInputElement)switch(i.type){case"checkbox":return i.checked;case"radio":return i.value}if(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement){var o=i["$WJ-MSKP"],n=o?o._applyMask():i.value,r=i.maxLength;if(e.isNumber(r)&&r>-1&&n.length>r){var s=e.culture.Globalize.numberFormat["%"]||"%",l=n.length&&n[n.length-1]==s;n=n.substr(0,r),l&&n.indexOf(s)<0&&(n+=s)}return n}return null},i._WJC_RADIOMAP="wj-radio-map",i._WJC_CHECKBOX="wj-cell-check",i._WJC_COLLAPSE="wj-elem-collapse",i._WJC_DROPDOWN="wj-elem-dropdown",i._WJC_PIN="wj-elem-pin",i._tplDdBtn=c(i._WJC_DROPDOWN,"down"),i._tplCtx={row:null,col:null,value:null,text:null,item:null},i}();function o(t,o,n,r,s,l){var a=i._tplCtx;a.value=n,a.text=r,a.item=s.dataItem,a.row=s,a.col=l;var c=e.isString(t)?e.evalTemplate(t,a):t(a,o);null!=c&&(o.innerHTML=c)}function n(e,t,i){return e.editRange&&e.editRange.contains(t,i)}function r(){var t=i._ddBtn;return t||(t=i._ddBtn=e.createElement(i._tplDdBtn),e.setAriaLabel(t,e.culture.FlexGrid.ariaLabels.toggleDropDown),e.setAttribute(t,"aria-expanded",!1)),t.cloneNode(!0)}function s(t,o){var n=c(i._WJC_PIN,"pin"),r=e.createElement(n);e.toggleClass(r,"wj-state-pinned",o),e.setAttribute(r,"aria-pressed",o),t.insertBefore(r,t.firstChild)}function l(t){var o=i._WJC_COLLAPSE,n=(t.isCollapsed?"":"down-")+(t.grid.rightToLeft?"left":"right"),r=e.createElement('<button class="wj-btn wj-btn-glyph '+o+'" type="button" tabindex="-1">'+a(n)+"</button>");return e.setAriaLabel(r,e.culture.FlexGrid.ariaLabels.toggleGroup),e.setAttribute(r,"aria-expanded",!t.isCollapsed),r}function a(e){return'<span class="wj-glyph-'+e+'"></span>'}function c(e,t){return'<button class="wj-btn wj-btn-glyph wj-right {cls}" type="button" tabindex="-1">{glyph}</button>'.replace("{cls}",e).replace("{glyph}",a(t))}t.CellFactory=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i=function(){function i(i){var o=this;this._rng=null,this._edt=null,this._edItem=null,this._edtCanceled=!1,this._list=null,this._fullEdit=!1,this._evtInput=null,this._evtChange=null,this._cstEdtValue=null,this._validating=!1,this._g=i,this._evtInput=document.createEvent("HTMLEvents"),this._evtInput.initEvent("input",!0,!1),this._evtChange=document.createEvent("HTMLEvents"),this._evtChange.initEvent("change",!0,!1),i.selectionChanging.addHandler((function(e,t){if(o.finishEditing()){var n=i._selHdl.selection.row;if(n!=t.row){var r=i.rows.length;(n>-1&&n<r?i.rows[n].dataItem:null)!=(t.row>-1&&t.row<r?i.rows[t.row].dataItem:null)&&o._commitRowEdits()}}else t.cancel=!0})),i.lostFocus.addHandler((function(){var t=e.getActiveElement();t&&"fixed"==getComputedStyle(t).position?o.finishEditing():o._commitRowEdits()}));var n=i.hostElement;i.addEventListener(n,"mousedown",(function(e){if(!e.defaultPrevented&&0==e.button&&!i._mouseHdl._szRowCol){var n=i.hitTest(e);n.cellType!=t.CellType.Cell&&n.cellType!=t.CellType.None&&(o.finishEditing()||o.finishEditing(!0))}}),!0),i.addEventListener(n,"compositionend",this._keypress.bind(this))}return i.prototype.startEditing=function(i,o,n,r,s){void 0===i&&(i=!0);var l=this._g,a=l._selHdl.selection;if(o=e.asNumber(o,!0,!0),n=e.isString(n)?l.columns.indexOf(n):e.asNumber(n,!0,!0),null==o&&(o=a.row),null==n&&(n=a.col),null==r&&(r=!0),!this._allowEdit(o,n))return!1;var c=l.getMergedRange(l.cells,o,n,!1);c||(c=new t.CellRange(o,n));var u=l.rows[o].dataItem;if(l.scrollIntoView(c.row,c.col,!0),!l.select(c,!0))return!1;if(!l.rows[o]||u!=l.rows[o].dataItem)return!1;if(this.activeEditor){if(c.equals(this._rng))return!0;if(!this.finishEditing())return!1}var h=new t.CellRangeEventArgs(l.cells,c,s);if(!l.onBeginningEdit(h))return!1;var d=l.editableCollectionView,p=!1;d&&((p=(u=l.rows[o].dataItem)!=d.currentEditItem)&&l.onRowEditStarting(h),d.editItem(u),p&&(l.onRowEditStarted(h),this._edItem=u));var g=l.rows[o],f=l._getBindingColumn(l.cells,o,l.columns[n]),_=f.dataMap||g.dataMap,m=t.DataMapEditor.RadioButtons,w=g.dataMap&&g.dataMapEditor==m||f.dataMap&&f.dataMapEditor==m;if(this._fullEdit=e.asBoolean(i),this._rng=c,this._list=null,_&&!w&&!f.editor){var C=_.getDisplayValues(u);(f.isContentHtml||g.isContentHtml)&&(C=C.map((function(t){return e.toPlainText(t)}))),this._list=C}if(w){var v=l._activeCell||l.hostElement.querySelector(".wj-cell.wj-state-active");if(v){var y=s?s.target:null;y instanceof HTMLSpanElement&&(y=e.closest(y,"label")),y instanceof HTMLLabelElement&&(y=y.querySelector("input")),this._edt=y instanceof HTMLInputElement?y:v.querySelector("input"),this._updateRowHeaderCell(o)}}else c.isSingleCell?this._updateEditorCell(o,n,p):l.refresh(!1);var b=this._edt;if(b){if("checkbox"==b.type||"radio"==b.type)this._fullEdit=!1;else if(r){var R=0,E=b.value.length,S=!1,x=e.culture.Globalize.numberFormat["%"]||"%",H=l.getCellData(o,n,!1);if(e.isNumber(H)?S=b.value.indexOf(x)>-1:null==H&&(S=/^p/i.test(f.format))&&b.value.indexOf(x)<0&&(b.value+=x),S){var z=b.value;for(R=0,E=z.length;E>0&&(z[E-1]==x||" "==z[E-1]);)E--;for(;R<E&&z[R]==x;)R++}s&&"keydown"==s.type&&s.keyCode==e.Key.Space&&(R=E),e.setSelectionRange(b,R,E),e.isIE()&&"right"==b.style.textAlign&&(b.style.paddingRight="1px")}l.onPrepareCellForEdit(h)}return r&&!l.containsFocus()&&l.focus(),null!=b&&!b.disabled&&!b.readOnly},i.prototype.finishEditing=function(i){var o=this._edt;if(!o)return this._removeListBox(),!0;var n=this._g,r=this._rng,s=new t.CellEditEndingEventArgs(n.cells,r),l=n.containsFocus();if(!i){var a=n.hostElement.querySelector(".wj-control.wj-state-focused");if(a){var c=e.Control.getControl(a);c&&c.containsFocus()&&c.onLostFocus(s)}}if(s.cancel=i,!i&&n.validateEdits&&(f=this._getValidationError())){s.cancel=!0;var u=n.cells.getCellElement(r.row,r.col);u&&(this._setCellError(u,f),s.stayInEditMode=!0)}if(this._cstEdtValue=null,s.data=n.cells.getCellData(r.topRow,r.leftCol,!1),!n.onCellEditEnding(s)&&s.stayInEditMode)return l?setTimeout((function(){o.select()})):o.select(),this._fullEdit=!0,!1;if(!s.cancel){for(var h=this._cstEdtValue,d=h&&!e.isUndefined(h.value)?h.value:n.cellFactory.getEditorValue(n),p=r.topRow;p<=r.bottomRow&&p<n.rows.length;p++)for(var g=r.leftCol;g<=r.rightCol&&g<n.columns.length;g++){var f,_=n._getBindingColumn(n.cells,p,n.columns[g]),m=n.rows[p],w=_&&_.dataMap||m&&m.dataMap,C=!w||w.serializeKeys;if(!n.cells.setCellData(p,g,d,C,!1)&&n.validateEdits&&(f=this._getValidationError(!0))){s.cancel=!0;var v=n.cells.getCellElement(r.row,r.col);return v&&(this._setCellError(v,f),s.stayInEditMode=!0),!1}}o.value==this._edtValue&&o.dispatchEvent(this._evtChange)}this._edt=null,this._rng=null,this._list=null,this._edtValue=null,this._edtCanceled=s.cancel,this._removeListBox();var y=e.closest(o,".wj-cell");return e.contains(y,e.getActiveElement())&&n._setFocusNoScroll(y),!s.cancel&&s.refresh&&n._refreshOnEdit?n.refresh(!1):this._updateEditorCell(r.row,r.col,!1),l&&n.focus(),n.onCellEditEnded(s),!0},i.prototype._setCustomEditorValue=function(e){this._cstEdtValue={value:e}},i.prototype._setCellError=function(t,i){var o=this._g;""==i&&(i=null),e.toggleClass(t,"wj-state-invalid",null!=i);var n=o.errorTip,r=o.activeEditor;n?(n.setTooltip(t,i),r&&e.contains(t,r)&&e.setAttribute(r,"title","")):e.setAttribute(t,"title",i),r&&t==o.activeCell&&!e.contains(t,r)&&n&&n.setTooltip(r,i)},Object.defineProperty(i.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0}),i.prototype.getClipString=function(i,o,n,r){var s,l=this,a=this._g,c=a.selectionMode,u=[],h=0!=(o&t.ClipStringOptions.CSV),d=h?"\r\n":"\n",p=h?",":"\t",g=0!=(o&t.ClipStringOptions.InvisibleRows),f=t.SelectionMode,_=null!=i;if(!i&&c!=f.ListBox)for(var m=a.rows,w=0;w<m.length;w++)if(m[w].isSelected){c=f.ListBox;break}if(!i)switch(a._selHdl._expandSelection(),i=a.selection,c){case f.Row:case f.RowRange:case f.ListBox:i.col=0,i.col2=a.columns.length-1;break;case f.MultiRange:var C=a.selectedRanges;if(C.length>1){var v=this._sameCols(C),y=this._sameRows(C);if(v||y){(C=C.slice()).sort((function(e,t){return e.topRow-t.topRow||e.leftCol-t.leftCol}));for(var b=0;b<C.length;b++)for(var R=C[b],E=b+1;E<C.length;E++)R.contains(C[E])&&(C.splice(E,1),E--);if(v){var S=[];return C.forEach((function(e){S.push(l.getClipString(e,o,n,r)),n=!1})),S.join(d)}var x;if(y)return C.forEach((function(e){var t=l.getClipString(e,o,n,r).split(d);null==x?(x=t,r=!1):t.forEach((function(e,t){x[t]+=p+e}))})),x.join(d)}}}var H=i.col>-1&&i.col2>-1;if(n&&H&&(s=a.columnHeaders).rows.forEach((function(e,t){if(g||e.isVisible){var n=l._getRowClipString(s,t,i,o,r);u.push(n)}})),i.row>-1&&i.row2>-1)if(s=a.cells,c!=f.ListBox||_){for(e.assert(i.bottomRow<s.rows.length,"Row index must be less than the number of rows."),b=i.topRow;b<=i.bottomRow;b++)if(g||s.rows[b].isVisible){var z=this._getRowClipString(s,b,i,o,r);u.push(z)}}else s.rows.forEach((function(e,t){if(e.isSelected&&(g||e.isVisible)){var n=l._getRowClipString(s,t,i,o,r);u.push(n)}}));return u.join(d)},i.prototype._getRowClipString=function(i,o,n,r,s){var l=[],a=i.rows[o],c=t.ClipStringOptions,u=0!=(r&c.CSV),h=0!=(r&c.InvisibleColumns),d=0==(r&c.Unformatted),p=0!=(r&c.SkipMerged);if(a.isVisible){if(s)for(var g=i.cellType==t.CellType.ColumnHeader?i.grid.topLeftCells:i.grid.rowHeaders,f=0;f<g.columns.length;f++)if(h||g.columns[f].isVisible){var _=g.getCellData(o,f,!0);p&&this._skipMergedCell(i,null,o,f)&&(_=""),l.push(this._getCellClipString(_,r))}if(n.col>-1&&n.col2>-1)for(e.assert(n.rightCol<i.columns.length,"Column index must be less than the number of columns."),f=n.leftCol;f<=n.rightCol;f++)(h||i.columns[f].isVisible)&&(!(_=i.getCellData(o,f,d))&&a instanceof t.GroupRow&&f==i.columns.firstVisibleIndex&&(_=e.toPlainText(a.getGroupHeader())),p&&this._skipMergedCell(i,null,o,f)&&(_=""),l.push(this._getCellClipString(_,r)))}return l.join(u?",":"\t")},i.prototype._skipMergedCell=function(e,t,i,o){var n=e.grid.getMergedRange(e,i,o,!1);return!(!n||(t&&(n.row=Math.max(t.topRow,n.row),n.col=Math.max(t.leftCol,n.col)),n.row==i&&n.col==o))},i.prototype._getCellClipString=function(i,o){e.isString(i)||(i=e.isDate(i)?i.toJSON():null!=i?i.toString():""),i=i.replace(/\t/g," ");var n=0!=(o&t.ClipStringOptions.QuoteAll);return(n=n||/\n|^"|"$/.test(i))||0==(o&t.ClipStringOptions.CSV)||(n=i.indexOf(",")>-1),n&&(i='"'+(i=i.replace(/"/g,'""'))+'"'),i},i.prototype._sameRows=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].topRow!=t.topRow||e[i].bottomRow!=t.bottomRow)return!1;return!0},i.prototype._sameCols=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].leftCol!=t.leftCol||e[i].rightCol!=t.rightCol)return!1;return!0},i.prototype.setClipString=function(i,o){var n=this,r=this._g,s=r.editableCollectionView,l=null==o,a=t.SelectionMode;if(l)switch(r._selHdl._expandSelection(),o=r.selection,r.selectionMode){case a.Row:case a.RowRange:case a.ListBox:o.col=0,o.col2=r.columns.length-1;break;case a.MultiRange:var c=r.selectedRanges;if(c.length>1)return s&&s.beginUpdate(),c.forEach((function(e){r.setClipString(i,e)})),s&&s.endUpdate(),void(r.selectedRanges=c)}o=e.asType(o,t.CellRange);var u=this._parseClipString(e.asString(i));!l&&u.length>o.rowSpan&&(u=u.slice(0,o.rowSpan)),this._expandClipRows(u,o);var h=l?new t.CellRange(o.topRow,o.leftCol,o.topRow+u.length-1,o.leftCol+u[0].length-1):o,d=new t.CellRangeEventArgs(r.cells,h,i);if(!r.onPasting(d))return!1;h=new t.CellRange(o.topRow,o.leftCol);var p=new t.CellRangeEventArgs(r.cells,new t.CellRange(o.topRow,-1)),g=!1,f=0,_=o.topRow,m=r.rows,w=r.columns,C=this._deferPaste(o,u.length);if(r.deferUpdate((function(){var i=-1;s&&C&&(i=s.currentPosition,s.beginUpdate());for(var l=0;l<u.length&&_<m.length;l++,_++){var a=m[_];if(a.isVisible){var c=a.dataItem,d=s?s.currentEditItem:null;d&&c!=d&&(r.onRowEditEnding(p),r.onRowEditEnded(p)),c!=d&&(p._rng.setRange(_,-1),r.onRowEditStarting(p),r.onRowEditStarted(p)),a instanceof t._NewRowTemplate&&s&&(C&&(a.dataItem=s.addNew()),p._rng.setRange(r.newRowAtTop?0:_+f,-1),r.onRowEditStarting(p),r.onRowEditStarted(p));for(var v=u[l],y=o.leftCol,b=0;b<v.length&&y<w.length;b++,y++){var R=w[y];if(R.isVisible){if(n._allowEdit(_,y)){var E=v[b],S=E.length;S>1&&'"'==E[0]&&'"'==E[S-1]&&E.indexOf("\n")>-1&&(E=E.substr(1,S-2));var x=R.maxLength||a.maxLength;x&&(E=E.substr(0,x));var H=new t.CellRangeEventArgs(r.cells,new t.CellRange(_+f,y),E);if(r.onPastingCell(H)){s&&(s.editItem(c),n._edItem=s.currentEditItem);var z=r.getCellData(_,y,!1);r.setCellData(_,y,H.data)&&(H.data=z,r.onPastedCell(H),g=!0)}h.row2=Math.max(h.row2,_+f),h.col2=Math.max(h.col2,y)}}else b--}if(n._edItem&&s instanceof e.collections.CollectionView){var P=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,n._edItem,_);s.onCollectionChanged(P)}a instanceof t._NewRowTemplate&&s&&C&&(a.dataItem=null,g?(p._rng.setRange(r.newRowAtTop?0:_+f,-1),r.onRowEditEnding(p),r.onRowEditEnded(p),_--,f++,s.commitNew()):s.cancelNew())}else l--}if(s)if(C)s.currentEditItem&&(s.commitEdit(),r.onRowEditEnding(p),r.onRowEditEnded(p)),s.moveCurrentToPosition(i),s.endUpdate(!0);else{var M=s.currentAddItem;!M&&0==o.row&&r.newRowAtTop&&m[0]instanceof t._NewRowTemplate&&(M=m[0].dataItem),M&&(s.editItem(M),n._edItem=M)}h.rowSpan>1&&0==h.topRow&&m[0]instanceof t._NewRowTemplate&&(h.row=h.row2=0),r.select(h)})),r.onPasted(d),g&&e.closest(r.hostElement,"form")){var v=document.createEvent("HTMLEvents"),y=e.createElement("<input>",r.hostElement);v.initEvent("change",!0,!1),y.dispatchEvent(v),e.removeChild(y)}},i.prototype._deferPaste=function(e,i){var o=this._g.rows,n=o.length;if(i>1){if(n>1&&o[0].dataItem!=o[1].dataItem)return!0;if(1==n&&o[0]instanceof t._NewRowTemplate)return!0}return!1},i.prototype._parseClipString=function(e){e=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).replace(/\n$/,"");var t=0,i=0,o=[];for(t=0;t<e.length;t++){var n='"'==e[t],r=!1,s=!1;for(i=t;i<e.length&&!s;i++){var l=e[i];switch(l){case'"':n&&(r=!r);break;case"\t":case"\n":r||(this._parseClipCell(o,e,t,i,"\n"==l),t=i,i==e.length-1&&(t=i+1),s=!0)}}if(i==e.length){this._parseClipCell(o,e,t,i,!1);break}}return 0==o.length&&o.push([""]),o},i.prototype._parseClipCell=function(e,t,i,o,n){e.length||e.push([]);var r=t.substr(i,o-i),s=r.length;s>2&&'"'==r[0]&&'"'==r[s-1]&&r.indexOf('""')>-1?r=(r=r.substr(1,s-2)).replace(/""/g,'"'):"\t"==r&&(r=""),e[e.length-1].push(r),n&&e.push([])},i.prototype._expandClipRows=function(e,t){for(var i=e.length,o=0,n=0;n<i;n++)o=Math.max(o,e[n].length);for(var r=this._g,s=0,l=0,a=t.topRow;a<=t.bottomRow;a++)r.rows[a].isVisible&&s++;for(var c=t.leftCol;c<=t.rightCol;c++)r.columns[c].isVisible&&l++;if((s>1||l>1)&&(1==s&&(s=i),1==l&&(l=o),l%o==0&&s%i==0)){for(c=o;c<l;c++)for(a=0;a<i;a++)e[a].push(e[a%i][c%o]);for(a=i;a<s;a++)e.push(e[a%i])}},i.prototype._updateEditorCell=function(t,i,o){var n=this._g,r=n.cells.getCellElement(t,i),s=n._useFrozenDiv()&&(t<n.frozenRows||i<n.frozenColumns);!r||s||n._hasPendingUpdates()?n.refresh(!1):n.onUpdatingView(new e.CancelEventArgs)&&(this._updateCell(r),(o||n._getHasValidation())&&this._updateRowHeaderCell(t),n.onUpdatedView())},i.prototype._updateRowHeaderCell=function(e){var i=this._g;if(i.headersVisibility&t.HeadersVisibility.Row){var o=i.rowHeaders,n=i._getEditColumnIndex(),r=o.getCellElement(e,n);r&&this._updateCell(r)}},i.prototype._updateCell=function(i){var o=new t.HitTestInfo(i,null),n=t.FlexGrid._WJS_UPDATING;o.panel&&(e.addClass(i,n),o.grid.cellFactory.updateCell(o.panel,o.row,o.col,i,o.range),e.removeClass(i,n))},i.prototype._getValidationError=function(t){var i=this,o=this._g,n="";if(o&&this._rng&&!this._validating){var r=this._rng.row,s=this._rng.col,l=o.activeEditor,a=o.cellFactory.getEditorValue(o),c=o.getCellData(r,s,!1);if(t&&(n=o._getError(o.cells,r,s,!0)),!n&&o._getHasValidation()){if(l&&(n=l.validationMessage),!n){var u=o.columns[s],h=o.rows[r];!o._getBindingColumn(o.cells,r,u).getIsRequired(h)||null!=a&&""!==a||(n=this._getRequiredMsg())}!n&&o.setCellData(r,s,a,!0,!1)&&(n=o._getError(o.cells,r,s,!1),o.setCellData(r,s,c,!1,!1))}if(!n){var d=e.Control.getControl(e.closest(l,".wj-control"));if(d&&d!=o&&d.invalidInput.hasHandlers){var p=function(e,t){t.cancel&&(n=o._getError(o.cells,r,s,!0)||i._getBadInputMsg(),t.cancel=!1)};this._validating=!0;var g=l.value;if(d.invalidInput.addHandler(p),d._containsFocus()){var f=e.closest(d.hostElement,".wj-cell");f&&f.focus()}d.onLostFocus(),d.invalidInput.removeHandler(p),l.value=g,l.select(),this._validating=!1}}}return n},i.prototype._getRequiredMsg=function(){if(!i._msgRequired){var e=document.createElement("input");e.required=!0,i._msgRequired=e.validationMessage}return i._msgRequired},i.prototype._getBadInputMsg=function(){if(!i._msgBadInput){var e=document.createElement("input");e.pattern="x",e.value="a",i._msgBadInput=e.validationMessage||"Bad Input"}return i._msgBadInput},i.prototype._allowEdit=function(e,i){var o=this._g;if(o.isReadOnly||o.selectionMode==t.SelectionMode.None)return!1;if(o.collectionView&&!o.editableCollectionView)return!1;if(null!=e){if(e<0||e>=o.rows.length)return!1;var n=o.rows[e];if(!n||n.isReadOnly||!n.isVisible)return!1}if(null!=i){if(i<0||i>=o.columns.length)return!1;var r=o._getBindingColumn(o.cells,e,o.columns[i]);if(!r||r.isReadOnly||!r.isVisible)return!1}return!0},i.prototype._commitRowEdits=function(){var e=this._g;if(this.finishEditing()&&this._edItem){var i=e.editableCollectionView;if(i&&(i.currentEditItem||i.currentAddItem)){var o=new t.CellRangeEventArgs(e.cells,e.selection);e.onRowEditEnding(o),i.commitEdit(),e.onRowEditEnded(o)}this._edItem=null}},i.prototype._keydown=function(t){var i=this._edt;switch(t.keyCode){case e.Key.F2:return this._fullEdit=!this._fullEdit,t.preventDefault(),!0;case e.Key.F4:return this._toggleListBox(t),t.preventDefault(),!0;case e.Key.Space:return!i||"checkbox"!=i.type||i.disabled||i.readOnly||(e.setChecked(i,i.indeterminate||!i.checked),this.finishEditing(),t.preventDefault()),!0;case e.Key.Enter:if(t.preventDefault(),i&&t.altKey){var o=t.target;if(o instanceof HTMLTextAreaElement&&"soft"==o.wrap){o.style.setProperty("ime-mode","auto","important");var n=o.value,r=o.selectionStart,s=o.selectionEnd;o.value=n.substr(0,r)+"\n"+n.substr(s),e.setSelectionRange(o,r+1),o.style.imeMode=""}return!0}return i&&this._lbx?(this._toggleListBox(t),!0):!this.finishEditing();case e.Key.Tab:return t.preventDefault(),!this.finishEditing();case e.Key.Escape:return t.preventDefault(),this.finishEditing(!0),!0;case e.Key.Up:case e.Key.Down:case e.Key.Left:case e.Key.Right:case e.Key.PageUp:case e.Key.PageDown:case e.Key.Home:case e.Key.End:if(this._lbx)return this._keydownListBox(t);if(t.altKey)switch(t.keyCode){case e.Key.Up:case e.Key.Down:return this._toggleListBox(t),t.preventDefault(),!0}if(this._fullEdit)switch(t.keyCode){case e.Key.PageUp:case e.Key.PageDown:t.preventDefault()}else if(this.finishEditing())return!1}return!0},i.prototype._keydownListBox=function(t){var i=!0;if(this._lbx)switch(t.keyCode){case e.Key.Up:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex>0&&this._lbx.selectedIndex--;break;case e.Key.Down:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex++;break;case e.Key.Home:case e.Key.PageUp:this._lbx.selectedIndex=0;break;case e.Key.End:case e.Key.PageDown:this._lbx.selectedIndex=this._lbx.collectionView.items.length-1;break;default:i=!1}return!!i&&(t.preventDefault(),!0)},i.prototype._keypress=function(t){if("AltLeft"!=t.code&&"AltRight"!=t.code){var i=this._edt,o=t.charCode||32,n=this._list;if(i&&"checkbox"!=i.type&&e.getActiveElement()==i&&n&&n.length>0&&o>=32){var r=i.selectionStart,s=i.value.substr(0,r);t.target==i&&t.charCode&&(s+=String.fromCharCode(t.charCode),r++);var l=this._findString(n,s,!0);if(l<0&&!this._g.caseSensitiveSearch&&(l=this._findString(n,s,!1)),l>-1){var a=this._lbx;a&&(a.selectedIndex=l),i.value=n[l],e.setSelectionRange(i,r,i.value.length),i.dispatchEvent(this._evtInput),t.preventDefault&&t.preventDefault()}}}else t.preventDefault()},i.prototype._findString=function(e,t,i){i||(t=t.toLowerCase());for(var o=0;o<e.length;o++){var n=e[o];if(null!=n&&(n=n.toString(),i||(n=n.toLowerCase()),0==n.indexOf(t)))return o}return-1},i.prototype._toggleListBox=function(e,i){var o=this._g,n=o._selHdl.selection,r=o.isTouching;if(i||(i=n),this._lbx&&(this._removeListBox(),n.intersects(i)))return o.activeEditor?o.activeEditor.focus():o.containsFocus()||o.focus(),!0;if(!i.isValid)return!1;var s=o.rows[i.row],l=o._getBindingColumn(o.cells,i.row,o.columns[i.col]),a=s.dataMap||l.dataMap,c=o._getMapEditor(s,l);if(!a||c!=t.DataMapEditor.DropDownList||!t.softInput())return!1;if(null!=l.editor)return!1;if(!i.intersects(o.editRange)&&!this.startEditing(!0,i.row,i.col,!r,e))return!1;var u=this._lbx=this._createListBox();return requestAnimationFrame((function(){return u.showSelection()})),r&&u.focus(),!0},i.prototype._createListBox=function(){var i=this,o=this._g,n=o.activeEditor,r=this._rng,s=o.rows[r.row],l=o._getBindingColumn(o.cells,r.row,o.columns[r.col]),a=l.isContentHtml||s.isContentHtml,c=l.dataMap||s.dataMap,u=l.dropDownCssClass||s.dropDownCssClass,h=document.createElement("div");this._removeListBox(),e.addClass(h,"wj-dropdown-panel wj-grid-listbox"),e.addClass(h,u);var d=n?n.value:o.getCellData(r.row,r.col,!0),p=new e.input.ListBox(h,{maxHeight:4*s.renderHeight,isContentHtml:a,itemsSource:c.getDisplayValues(s.dataItem),selectedValue:d});p.addEventListener(h,"keydown",(function(t){switch(t.keyCode){case e.Key.Enter:case e.Key.Escape:i._removeListBox(),o.focus()}})),p.addEventListener(h,"click",(function(){i._removeListBox(),o.focus(),i.finishEditing()})),p.gotFocus.addHandler((function(){p.containsFocus()&&n&&n.focus()})),p.selectedIndexChanged.addHandler((function(){var t=o.activeEditor;t&&(t.value=i._list[p.selectedIndex],t.dispatchEvent(i._evtInput),e.setSelectionRange(t,0,t.value.length))}));var g=o.cells.getCellElement(r.row,r.col);if(g){e.showPopup(h,g,!1,!1,!1);var f=g.querySelector("."+t.CellFactory._WJC_DROPDOWN);e.setAttribute(f,"aria-expanded",!0)}else e.showPopup(h,o.getCellBoundingRect(r.row,r.col)),h[e.Control._OWNR_KEY]=o.hostElement;return p},i.prototype._removeListBox=function(){var t=this._lbx;t&&(this._lbx=null,e.hidePopup(t.hostElement,(function(){t.dispose()})))},i._msgRequired="",i._msgBadInput="",i}();t._EditHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){var t,i;t=e.grid||(e.grid={}),i=function(){function i(i,o){this._col=e.asType(i,t.Column),this._ctl=o,this._tbx=o.hostElement.querySelector("input"),e.assert(this._col instanceof t.Column,"Invalid Column"),e.assert(this._ctl instanceof e.Control,"Invalid edit control"),e.assert(this._tbx instanceof HTMLInputElement,"Input element not found in editor");var n=this._ctl;this._prop=e.isUndefined(n.value)?e.isUndefined(n.checkedItems)?e.isUndefined(n.text)?null:"text":"checkedItems":"value",e.assert(null!=this._prop,"value, text properties not found in editor");var r=t.softInput();r&&(this._isDropDown=n instanceof r.DropDown,this._isComboBox=n instanceof r.ComboBox,this._isAutoComplete=n instanceof r.AutoComplete,this._isInputDateTime=n instanceof r.InputDateTime,this._isInputMask=n instanceof r.InputMask),this._updateFocusBnd=this._updateFocus.bind(this),this._keypressBnd=this._keypress.bind(this),this._keydownBnd=this._keydown.bind(this),this._cmpstartBnd=this._cmpstart.bind(this),this._mousedownBnd=this._mousedown.bind(this),this._connect(),this._col.gridChanged.addHandler(this._connect,this),this._hideEditor(),this._updateFocus()}return Object.defineProperty(i.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"control",{get:function(){return this._ctl},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._disconnect(),this._isDropDown&&(this._isDropDown=!1),this._g=this._col=this._ctl=this._tbx=null},i.prototype._connect=function(){var e=this._col?this._col.grid:null;if(e!=this._g&&(this._disconnect(),e)){var t=e.hostElement,i=e.addEventListener.bind(e),o=this._updateFocusBnd;this._g=e,i(t,"keydown",this._keydownBnd,!0),i(t,"keypress",this._keypressBnd,!0),i(t,"mousedown",this._mousedownBnd,!0),i(t,"mouseup",o,!0),i(t,"blur",o,!0),i(t,"focus",o),i(this._tbx,"compositionstart",this._cmpstartBnd),e.selectionChanged.addHandler(o,this),e.prepareCellForEdit.addHandler(this._prepareCellForEdit,this),e.cellEditEnding.addHandler(this._cellEditEnding,this),e.cellEditEnded.addHandler(this._cellEditEnded,this)}},i.prototype._disconnect=function(){var e=this._g;if(e){var t=e.hostElement,i=e.removeEventListener.bind(e),o=this._updateFocusBnd;i(t,"keydown",this._keydownBnd),i(t,"keypress",this._keypressBnd),i(t,"mousedown",this._mousedownBnd),i(t,"mouseup",o),i(t,"blur",o),i(t,"focus",o),i(this._tbx,"compositionstart",this._cmpstartBnd),e.selectionChanged.removeHandler(o,this),e.prepareCellForEdit.removeHandler(this._prepareCellForEdit,this),e.cellEditEnding.removeHandler(this._cellEditEnding,this),e.cellEditEnded.removeHandler(this._cellEditEnded,this),this._g=null}},i.prototype._prepareCellForEdit=function(t,i){if(!i.cancel&&i.getColumn(!0)==this._col){var o=this.grid,n=this._ctl,r=this._tbx,s=this._prop,l=i.range,a=i.data,c=a?a.type:"",u=o.getCellData(l.row,l.col,"text"==s||this._isInputMask),h=!1;switch(this._isComboBox&&(this._isAutoComplete&&(n._oldText=""),n.isRequired||(n.selectedIndex=-1,r.value=""),this._isInputDateTime&&n._setDropdown(n._ddDate)),"checkedItems"==s&&(n.showFilterInput&&(n.showFilterInput=!1,n.showFilterInput=!0),null!=u&&0!=u.length||(n[s]=[],n.selectedIndex=0)),null==u&&n.isRequired||(n[s]=u,this._isAutoComplete&&(clearTimeout(n._toSearch),u&&(n.selectedIndex=n._findNext(u,1,-1)))),c){case"keydown":case"mousedown":if((e.isUndefined(a.keyCode)||a.keyCode==e.Key.F4||a.altKey)&&(h=this._isDropDown,this._isAutoComplete&&(null==u||e.isString(u)))){var d=n.collectionView;d&&((d.filter||n._rxHighlight)&&(n._rxHighlight=null,d.filter=null),n.selectedIndex=u?n._findNext(u,1,-1):-1)}}if(o.showPlaceholders&&!n.placeholder&&(r.placeholder=this._col.header),this._showEditor(),o._edtHdl._fullEdit=!0,0==c.indexOf("key")&&32==a.keyCode&&(e.setSelectionRange(r,r.value.length),a.preventDefault()),e.isIE())if("keypress"==c&&a.key)setTimeout((function(){r.value=a.key,e.setSelectionRange(r,1);var t=document.createEvent("HTMLEvents");t.initEvent("input",!0,!1),r.dispatchEvent(t)})),a.preventDefault();else if("compositionstart"==c){var p=r.value.length;e.setSelectionRange(r,p)}this._isDropDown&&(n.isDroppedDown=h)}},i.prototype._cellEditEnding=function(t,i){if(!i.cancel&&i.getColumn(!0)==this._col){var o=this.grid,n=this._ctl,r=this._prop;if(this._isAutoComplete){var s=n.selectedIndex;if(e.isNumber(s)&&s<0){var l=n.collectionView;l&&1==l.items.length?n.selectedIndex=0:this._col.isRequired&&(i.cancel=!0)}}!i.cancel&&r&&o._edtHdl._setCustomEditorValue(n[r])}},i.prototype._cellEditEnded=function(e,t){this._hideEditor(),this._updateFocus()},i.prototype._cmpstart=function(t){var i=this;e.isIE()?setTimeout((function(){i._activateEditor(t)})):this._activateEditor(t)},i.prototype._keypress=function(e){e.defaultPrevented||this.grid.activeEditor||!this._checkColumn(e.target)||e.ctrlKey||e.altKey||e.metaKey||27==e.keyCode||this._activateEditor(e)},i.prototype._keydown=function(t){if(!t.defaultPrevented&&this._checkColumn(t.target))if(this.grid.activeEditor){if(t.keyCode==e.Key.Enter&&this._isDropDown){var i=this._ctl;i.isDroppedDown&&(i.isDroppedDown=!1,t.preventDefault(),t.stopImmediatePropagation())}}else if(this._isDropDown){var o=t.keyCode;switch(o){case e.Key.F4:case e.Key.Up:case e.Key.Down:(o==e.Key.F4||t.altKey)&&(this._activateEditor(t),t.preventDefault())}}},i.prototype._checkColumn=function(t){if(e.contains(t,this._tbx)){var i=this._g,o=i._selHdl.selection;return i._getBindingColumn(i.cells,o.row,i.columns[o.col])==this._col}return!1},i.prototype._mousedown=function(i){if(!i.defaultPrevented&&0==i.button&&!i.shiftKey&&!i.ctrlKey&&!i.metaKey&&this._isDropDown&&e.closestClass(i.target,t.CellFactory._WJC_DROPDOWN)){var o=this.grid,n=o.hitTest(i);n.getColumn(!0)==this._col&&(o.select(n.range),o.refresh(),this._activateEditor(i),i.preventDefault())}},i.prototype._activateEditor=function(e){var t=this.grid;if(!t.activeEditor){var i=t._selHdl.selection;if(i.isValid)return t.startEditing(!0,i.row,i.col,!0,e)}return!1},i.prototype._showEditor=function(){var t=this.grid,o=t.activeEditor,n=e.closest(o,".wj-cell");if(n){var r=this._tbx,s=this._ctl.hostElement;e.setCss(s,i._cssVisible),e.toggleClass(r,"wj-grid-ime",!1),n.innerHTML="",n.appendChild(s),t._edtHdl._edt=r,r.select(),r.focus(),o.value=""}},i.prototype._hideEditor=function(){var t=this.grid,o=this._ctl.hostElement,n=this._tbx;this._isDropDown&&(this._ctl.isDroppedDown=!1),n.setCustomValidity("");var r=n.value;n.value=r+" ",n.value=r,e.setCss(o,i._cssHidden),e.toggleClass(n,"wj-grid-ime",!0),t&&o.parentElement!=t._root&&t._root.appendChild(o)},i.prototype._updateFocus=function(){var t=this.grid;if(t&&!t.activeEditor){var i=t.hostElement,o=".wj-flexgrid",n=this._tbx,r=e.getActiveElement(),s=t._getTabIndex();if(e.closest(r,o)==i)if(e.closest(n,o)!=i)this._hideEditor();else{var l=t._selHdl.selection,a=t._getBindingColumn(t.cells,l.row,t.columns[l.col]);a&&a==this._col&&t.canEditCell(l.row,l.col)?(n.tabIndex=s,n.select(),n.focus()):n.tabIndex>-1&&(n.tabIndex=-1,r==n&&t.focus(!0))}}},i._cssHidden={position:"fixed",left:-32e3,top:-32e3,width:"1px",height:"1px",overflow:"hidden",border:"none"},i._cssVisible={position:"absolute",left:0,top:0,width:"100%",height:"100%"},i}(),t._CustomEditor=i}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None",e[e.MoveDown=1]="MoveDown",e[e.MoveAcross=2]="MoveAcross",e[e.Cycle=3]="Cycle",e[e.CycleOut=4]="CycleOut",e[e.CycleEditable=5]="CycleEditable"}(i=t.KeyAction||(t.KeyAction={}));var o=function(){function o(e){this._kaTab=i.None,this._kaEnter=i.MoveDown,this._g=e;var t=e.hostElement;e.addEventListener(t,"keypress",this._keypress.bind(this)),e.addEventListener(t,"keydown",this._keydown.bind(this))}return o.prototype._keydown=function(i){var o=this._g,n=o._edtHdl,r=o.selection,s=i.ctrlKey||i.metaKey,l=i.shiftKey,a=i.altKey,c=i.target,u=i.char||i.key,h=!0;if(!s&&!a&&u&&1==u.length&&e.closest(c,".wj-cell")&&c.firstElementChild&&(" "!=u||!l)){var d=c.querySelectorAll("."+t.CellFactory._WJC_RADIOMAP+" label input");if(d&&d.length){for(var p=-1,g=0;g<d.length;g++)if(d[g].checked){p=g;break}for(u=u.toLowerCase(),g=0;g<d.length;g++){var f=d[(p+g+1)%d.length];if(" "==u||f.value.toLowerCase()[0]==u)return f.click(),void i.preventDefault()}}}if(!o._wantsInput(c)){var _=e.tryCast(o.rows[r.row],t.GroupRow),m=o.editableCollectionView,w=o._getKeyCode(i),C=t.SelMove,v=t.SelectionMode,y=i.defaultPrevented&&!(c instanceof HTMLInputElement);if((o.isRangeValid(r)&&!y||s&&65==w)&&(!o.activeEditor||!n._keydown(i)||o._isNativeCheckbox(o.activeEditor))){if(o.autoClipboard){if(s&&(67==w||45==w)){var b=new t.CellRangeEventArgs(o.cells,r);if(o.onCopying(b)){var R=t.HeadersVisibility,E=0!=(o.copyHeaders&R.Column),S=0!=(o.copyHeaders&R.Row),x=o.getClipString(null,!1,E,S)+"\r\n";o._eFocus.focus(),e.Clipboard.copy(x),o.onCopied(b)}return void i.stopPropagation()}if(s&&86==w||l&&45==w)return o.isReadOnly||e.Clipboard.paste((function(e){o.setClipString(e)})),void i.stopPropagation()}switch((l||s)&&"Space"==i.code&&(w=e.Key.Space),w){case e.Key.Space:if(l&&r.isValid)switch(o.selectionMode){case v.CellRange:case v.MultiRange:case v.Row:case v.RowRange:case v.ListBox:o.select(new t.CellRange(r.row,0,r.row,o.columns.length-1),!1)}else if(s&&r.isValid)switch(o.selectionMode){case v.CellRange:case v.MultiRange:o.select(new t.CellRange(0,r.col,o.rows.length-1,r.col),!1)}else(h=this._startEditing(!0,i))&&setTimeout((function(){var t=o.activeEditor;t&&(t.disabled||t.readOnly&&!e.closest(t,".wj-control")?o.finishEditing():"checkbox"==t.type&&(e.setChecked(t,t.indeterminate||!t.checked),o.finishEditing()))})),h=!0;break;case 65:if(s)switch(o.selectionMode){case v.None:case v.Cell:break;default:o.selectAll()}else h=!1;break;case e.Key.Left:s||a?h=!1:r.isValid&&0==r.leftCol&&_&&!_.isCollapsed&&_.hasChildren?_.isCollapsed=!0:this._moveSel(C.None,s?C.Home:C.Prev,l);break;case e.Key.Right:s||i.altKey?h=!1:r.isValid&&0==r.leftCol&&_&&_.isCollapsed?_.isCollapsed=!1:this._moveSel(C.None,s?C.End:C.Next,l);break;case e.Key.Up:s?h=!1:i.altKey&&n._toggleListBox(i)?h=!0:this._moveSel(C.Prev,C.None,l);break;case e.Key.Down:s?h=!1:i.altKey&&n._toggleListBox(i)?h=!0:this._moveSel(C.Next,C.None,l);break;case e.Key.PageUp:if(this._moveSel(i.altKey?C.Home:C.PrevPage,C.None,l),o.rows.frozen&&o.selection.row<o.rows.frozen){var H=o.scrollPosition;H.y&&(o.scrollPosition=new e.Point(H.x,0))}break;case e.Key.PageDown:this._moveSel(i.altKey?C.End:C.NextPage,C.None,l);break;case e.Key.Home:this._moveSel(s?C.Home:C.None,C.Home,l);break;case e.Key.End:this._moveSel(s?C.End:C.None,C.End,l);break;case e.Key.Tab:h=this._performKeyAction(o.keyActionTab,l);break;case e.Key.Enter:h=this._performKeyAction(o.keyActionEnter,l),!l&&m&&null!=m.currentEditItem&&n._commitRowEdits();break;case e.Key.Escape:if(h=!1,m&&(m.currentAddItem||m.currentEditItem)){var z=new t.CellRangeEventArgs(o.cells,o.selection);z.cancel=!0,o.onRowEditEnding(z),m.currentAddItem&&m.cancelNew(),m.currentEditItem&&m.cancelEdit(),o.onRowEditEnded(z),h=!0}o._mouseHdl.resetMouseState();break;case e.Key.Delete:case e.Key.Back:h=this._deleteSel(i);break;case e.Key.F2:h=this._startEditing(!0,i);break;case e.Key.F4:h=n._toggleListBox(i);break;default:h=!1}h&&(o.containsFocus()||o.focus(),i.preventDefault(),i.stopPropagation())}}},o.prototype._performKeyAction=function(e,o){var n=i,r=t.SelMove;switch(e){case n.MoveDown:return this._moveSel(o?r.Prev:r.Next,r.None,!1),!0;case n.MoveAcross:return this._moveSel(r.None,o?r.Prev:r.Next,!1),!0;case n.Cycle:return this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1),!0;case n.CycleEditable:return this._moveSel(r.None,o?r.PrevEditableCell:r.NextEditableCell,!1),!0;case n.CycleOut:var s=this._g.selection;return this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1),!s.equals(this._g.selection)}return!1},o.prototype._keypress=function(t){var i=this,o=this._g;if(!o._wantsInput(t.target)&&!t.defaultPrevented){var n=o._edtHdl;if(o.activeEditor)n._keypress(t);else if(t.charCode>e.Key.Space&&"AltLeft"!=t.code&&"AltRight"!=t.code)if(this._startEditing(!1,t)&&o.activeEditor){var r=e.getActiveElement();if(r instanceof HTMLInputElement&&"checkbox"!=r.type||r instanceof HTMLTextAreaElement){var s=o._selHdl.selection,l=o.getCellData(s.row,s.col,!0),a=o.getCellData(s.row,s.col,!1),c=e.culture.Globalize.numberFormat["%"]||"%",u=String.fromCharCode(t.charCode),h=e.isNumber(a)&&l.indexOf(c)>-1||""==l&&r.value==c;r.value=h?u+c:u,e.setSelectionRange(r,1),r.dispatchEvent(n._evtInput),n._keypress(t),n._edtValue=r.value!=l?r.value:null,t.preventDefault()}}else if(o.autoSearch){var d=!1;if(s=o._selHdl.selection,t.charCode>32||32==t.charCode&&this._search){t.preventDefault(),this._search+=String.fromCharCode(t.charCode),this._toSearch&&clearTimeout(this._toSearch),this._toSearch=setTimeout((function(){i._toSearch=null,i._search=""}),e.Control._SEARCH_DELAY);var p=this._findNext(s.row,s.col);p<0&&this._search.length>1&&(this._search=this._search[this._search.length-1],p=this._findNext(s.row,s.col)),p>-1&&(d=!0,o.select(p,s.col))}d||(this._search="")}}},o.prototype._findNext=function(t,i){var o=this._g,n=o.rows.length;(t<0||1==this._search.length)&&t++;var r=this._search,s=o.caseSensitiveSearch;s||(r=r.toLowerCase());for(var l=o.columns[i].isContentHtml,a=0;a<n;a++){var c=(t+a)%n,u=o.getCellData(c,i,!0).trim();if(l&&(u=e.toPlainText(u)),s||(u=u.toLowerCase()),0==u.indexOf(r))return c}return-1},o.prototype._moveSel=function(e,i,o){var n=this._g;n.selectionMode!=t.SelectionMode.None&&n._selHdl.moveSelection(e,i,o)},o.prototype._deleteSel=function(e){var i=this,o=this._g,n=o.rows,r=o.editableCollectionView,s=o.selection,l=[],a=new t.CellRange,c=new t.CellEditEndingEventArgs(o.cells,a,e),u=t.SelectionMode;if(!o._edtHdl._allowEdit())return!1;if(o.allowDelete&&(null==r||r.canRemove&&!r.isAddingNew&&!r.isEditingItem)&&0==(l=n.filter((function(e){return e.isSelected}))).length)switch(o.selectionMode){case u.CellRange:case u.MultiRange:var h=o._getDeleteColumnIndex();o.selectedRanges.forEach((function(e){if(e.leftCol==h&&e.rightCol==o.columns.length-1)for(var t=e.topRow;t>-1&&t<=e.bottomRow;t++){var i=n[t];l.indexOf(i)<0&&l.push(i)}}));break;case u.Row:s.topRow>-1&&l.push(n[s.topRow]);break;case u.RowRange:for(var d=s.topRow;d>-1&&d<=s.bottomRow;d++)l.push(n[d])}if(l.length>0){var p=0;if(o.deferUpdate((function(){r&&r.beginUpdate();for(var e=l.length-1;e>=0;e--){var i=l[e];i instanceof t._NewRowTemplate||(a.setRange(i.index,-1),o.onDeletingRow(c)&&(r&&i.dataItem?r.remove(i.dataItem):o.rows.removeAt(i.index),p++,o.onDeletedRow(c)))}r&&r.endUpdate(!1)})),p>0){var g=s.topRow;for(g=Math.min(g,o.rows.length-1);g>0&&o.rows[g]instanceof t._NewRowTemplate;)g--;s.row=s.row2=g,o.select(s,!1),o.childItemsPath&&r&&r.refresh()}return!0}return 0==l.length&&(o.deferUpdate((function(){var a=o.scrollPosition,c=-1;l=n.filter((function(e){return e.isSelected}));var h=o.selectedRanges.length>1||l.length>1||s.isValid&&n[s.row].dataItem!=n[s.row2].dataItem;if(r&&r.beginUpdate(),l.length){var d=new t.CellRange(0,0,0,o.columns.length-1);l.forEach((function(t){d.row=d.row2=t.index,i._deleteRange(e,d),c=d.bottomRow}))}else i._deleteRange(e,s),c=s.bottomRow,o.selectionMode==u.MultiRange&&o._selHdl.extendedSelection.forEach((function(t){i._deleteRange(e,t),c=t.bottomRow}));if(o.select(s,!1),o.scrollPosition=a,r){if(h&&r.currentEditItem){r.commitEdit();var p=new t.CellRangeEventArgs(o.cells,new t.CellRange(c,-1));o.onRowEditEnding(p),o.onRowEditEnded(p)}r.endUpdate(!1)}})),!0)},o.prototype._deleteRange=function(e,i){for(var o=this._g,n=o.editableCollectionView,r=new t.CellRange,s=new t.CellEditEndingEventArgs(o.cells,r,e),l=new t.CellRangeEventArgs(o.cells,new t.CellRange(i.topRow,-1)),a=i.topRow;a<=i.bottomRow;a++){var c=o.rows[a];if(!c.isReadOnly)for(var u=i.leftCol;u<=i.rightCol;u++){var h=o._getBindingColumn(o.cells,a,o.columns[u]);if(!h.getIsRequired(c)&&!h.isReadOnly&&o.getCellData(a,u,!0)&&(r.setRange(a,u),s.cancel=!1,o.onBeginningEdit(s))){var d=c.dataItem,p=n?n.currentEditItem:null;p&&d!=p&&(o.onRowEditEnding(l),o.onRowEditEnded(l)),d!=p&&(l._rng.setRange(a,-1),o.onRowEditStarting(l),o.onRowEditStarted(l)),n&&(n.editItem(d),o._edtHdl._edItem=d),o.setCellData(a,u,"",!0,!1),o.onCellEditEnding(s),o.onCellEditEnded(s)}}}},o.prototype._startEditing=function(e,t,i,o){return this._g._edtHdl.startEditing(e,i,o,!0,t)},o}();t._KeyboardHandler=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){!function(t){"use strict";var i,o,n="wj-flexgrid";!function(e){e[e.None=0]="None",e[e.Columns=1]="Columns",e[e.Rows=2]="Rows",e[e.Both=3]="Both",e[e.ColumnsAllCells=4|e.Columns]="ColumnsAllCells",e[e.RowsAllCells=4|e.Rows]="RowsAllCells",e[e.BothAllCells=4|e.Both]="BothAllCells"}(i=t.AllowResizing||(t.AllowResizing={})),function(e){e[e.None=0]="None",e[e.Headers=1]="Headers",e[e.Cells=2]="Cells",e[e.Both=3]="Both"}(t.AutoSizeMode||(t.AutoSizeMode={})),function(e){e[e.None=0]="None",e[e.Columns=1]="Columns",e[e.Rows=2]="Rows",e[e.Both=3]="Both"}(o=t.AllowDragging||(t.AllowDragging={}));var r=function(){function r(i){var o=this,r=i.hostElement,s=i.addEventListener.bind(i),l=i.removeEventListener.bind(i);this._g=i,this._dvMarker=e.createElement('<div class="wj-marker">&nbsp;</div>'),s(r,"mousedown",(function(r){if(i._rcBounds=null,!r.defaultPrevented&&0==r.button){var u=r.target;if(!i.containsFocus()){var h=u instanceof HTMLElement&&u.tabIndex>-1?u:i._eFocus;i._setFocusNoScroll(h)}setTimeout((function(){r.defaultPrevented||i.focus()}));var d=e.closestClass(u,n);if(d&&d!=i.hostElement||!i.activeEditor&&i._isInputElement(u)&&!o._hasRadioMap(r)&&!i._isNativeCheckbox(u)){var p=i.hitTest(r),g=t.CellType;switch(p.cellType){case g.Cell:i.select(p.range,!1),u instanceof HTMLElement&&"root"!=u.getAttribute("wj-part")&&u.focus();break;case g.ColumnHeader:case g.ColumnFooter:i.scrollIntoView(-1,p.col);break;case g.RowHeader:i.scrollIntoView(p.row,-1)}return void(e.isIE()&&p.cellType!=g.Cell&&i._isInputElement(u)&&u.focus())}var f=document;l(f,"mousemove"),l(f,"mouseup"),s(f,"mousemove",a),s(f,"mouseup",c),o._isDown=!0,o._mousedown(r)}}));var a=function(e){o._mousemove(e)},c=function(e){o._isDown=!1,l(document,"mousemove"),l(document,"mouseup"),o._mouseup(e)};s(r,"mouseenter",(function(e){i._rcBounds=null})),s(r,"mousemove",this._hover.bind(this)),s(r,"dblclick",this._dblclick.bind(this)),s(r,"click",this._click.bind(this)),s(r,"selectstart",(function(e){i._isInputElement(e.target)||e.preventDefault()})),s(r,"wheel",(function(t){if(!t.defaultPrevented&&t.deltaY&&!t.ctrlKey&&!t.metaKey){var o=i._root,r=t.deltaY;if((t.shiftKey?o.scrollWidth>o.clientWidth:o.scrollHeight>o.clientHeight)&&e.closestClass(t.target,n)==i.hostElement){switch(t.deltaMode){case 1:r=i.rows.defaultSize*(r<0?-1:1);break;case 2:r=(t.shiftKey?o.clientWidth:o.clientHeight)*(r<0?-1:1);break;default:e.isSafari()&&(r=e.clamp(r,-150,150))}i.containsFocus()||i._eFocus.focus(),i.finishEditing(!1)&&(t.shiftKey?o.scrollLeft+=r:o.scrollTop+=r),t.preventDefault(),t.stopImmediatePropagation()}}})),s(r,"dragstart",this._dragstart.bind(this)),s(r,"dragover",this._dragover.bind(this)),s(r,"dragleave",this._dragover.bind(this)),s(r,"drop",this._drop.bind(this)),s(r,"dragend",this._dragend.bind(this))}return r.prototype.resetMouseState=function(){var t=this._g,i=t.hostElement;this._updating&&(this._updating=!1,t.endUpdate()),this._dragSrc&&e.removeClass(this._dragSrc,"wj-state-dragsrc"),this._showDragMarker(null),i&&(i.style.cursor=""),e.isSafari()&&this._szRowCol&&t.invalidate(),t.removeEventListener(document,"mousemove"),t.removeEventListener(document,"mouseup"),this._eMouse=null,this._isDown=null,this._htDown=null,this._lbSelState=null,this._szRowCol=null,this._szArgs=null,t._rcBounds=null},r.prototype._mousedown=function(n){var r=this._g,s=n.target,l=r.hitTest(n),a=l.cellType,c=t.CellType,u=n.ctrlKey||n.metaKey;if(this._selDown=r.selection,this._ignoreClick=!1,l.panel==r.cells){if(e.closestClass(s,t.CellFactory._WJC_DROPDOWN)){var h=r.hitTest(s);return r._edtHdl._toggleListBox(n,h.range),n.preventDefault(),void(this._ignoreClick=!0)}var d=r.editRange;if(d&&d.contains(l.range))return}var p=e.getActiveElement();if(s!=p||!r._isInputElement(s))if(a!=c.None)if(this._htDown=l,this._eMouse=n,null==this._szRowCol){var g=r.allowResizing,f=i;if((a==c.RowHeader||a==c.TopLeft)&&l.edgeBottom&&g&f.Rows&&this._getResizeRowHt(l))this._ignoreClick=!0;else if((a==c.ColumnHeader||a==c.TopLeft)&&l.edgeRight&&g&f.Columns&&this._getResizeColHt(l))this._ignoreClick=!0;else{var _=r.allowDragging,m=o;switch(a){case c.Cell:case c.RowHeader:u&&r.selectionMode==t.SelectionMode.ListBox&&(this._lbSelState=r.rows[l.row].isSelected,e.closest(s,".wj-elem-collapse")&&(this._lbSelState=!1)),this._mouseSelect(n,n.shiftKey),a!=c.RowHeader||_&m.Rows||(n.preventDefault(),r.focus());break;case c.ColumnHeader:r.allowSorting||_&m.Columns||e.closest(s,"button")||this._mouseSelect(n,n.shiftKey)}}}else{var w=r._eFocus;p!=w&&(w.tabIndex=0,w.focus()),this._ignoreClick=!0,this._handleResizing(n)}else r.finishEditing(),s!=r._root&&s!=r._fCt&&r._edtHdl._commitRowEdits()},r.prototype._mousemove=function(e){if(this._htDown&&!e.defaultPrevented){if(0==e.buttons&&this._eMouse&&e.timeStamp-this._eMouse.timeStamp>600)return void this.resetMouseState();if(this._eMouse=e,this._szRowCol)this._handleResizing(e);else{var i=this._g,n=i.allowDragging,r=o,s=t.CellType;switch(this._htDown.cellType){case s.Cell:this._mouseSelect(e,!0);break;case s.RowHeader:n&r.Rows||this._mouseSelect(e,!0);break;case s.ColumnHeader:n&r.Columns||i.allowSorting||this._mouseSelect(e,!0)}}}},r.prototype._mouseup=function(e){var i=this._g;if(!i.isTouching||!(this._dragSrc||e.target instanceof HTMLHtmlElement)){var o=i.hitTest(e),n=this._htDown;if(n&&!e.defaultPrevented&&(this._szArgs&&this._finishResizing(e),!this._szArgs&&o.panel==n.panel&&o.row==n.row&&o.col==n.col)){var r=o.getColumn();if(r&&(!r._getFlag(t.RowColFlags.HasTemplate)||r.cellTemplate)){var s=o.target;if(s!=n.target&&s instanceof HTMLElement){if(n.target instanceof HTMLInputElement){var l=o.point,a=n.point;Math.abs(l.x-a.x)+Math.abs(l.y-a.y)<10&&(s=s.querySelector("input")||s)}var c=document.createEvent("Event");for(var u in c.initEvent("click",!0,!0),e)/Key$|X$|Y$|^button|^(x|y|which)$/.test(u)&&(c[u]=e[u]);s.dispatchEvent(c)}}}this.resetMouseState()}},r.prototype._click=function(i){if(this._ignoreClick&&(this._ignoreClick=!1,i.preventDefault()),!i.defaultPrevented){var o=this._g,n=i.target,r=o.hitTest(n),s=e.tryCast(n,HTMLInputElement),l="input."+t.CellFactory._WJC_CHECKBOX;if(!s){var a=e.closest(n,"label");a&&(s=a.querySelector(l))}if(!s&&o.bigCheckboxes&&(s=n.querySelector(l)),s!=o.activeEditor&&o._isNativeCheckbox(s)){if(r.panel==o.cells){var c=o.getCellData(r.row,r.col,!1);o.startEditing(!1,r.row,r.col,!1,i)?(o.activeEditor.checked=!c,o.finishEditing(),o.focus()):s.checked=c}return}if(this._hasRadioMap(i))return void this._handleClick(i);var u=i.ctrlKey||i.metaKey;if(o.rows.maxGroupLevel>-1&&e.closestClass(n,t.CellFactory._WJC_COLLAPSE)){var h=o.rows[r.row];if(r.panel==o.cells&&h instanceof t.GroupRow)return void(u?o.collapseGroupsToLevel(h.isCollapsed?h.level+1:h.level):h.isCollapsed=!h.isCollapsed)}if(!u&&!i.shiftKey&&!o.activeEditor&&r.panel==o.cells){var d=o._selHdl.selection;if(d.equals(this._selDown)&&r.range.contains(d))return void o.startEditing(!0,null,null,!0,i)}this._handleClick(i)}},r.prototype._handleClick=function(i){var o=this._g,n=i.target,r=o.hitTest(n),s=i.ctrlKey||i.metaKey,l=r.panel;if(!i.defaultPrevented&&r.grid==o){if(l==o.cells&&this._hasRadioMap(i)){var a=e.closest(n,"label"),c=a&&a.querySelector("input");return void(c&&!c.disabled&&o.startEditing(!1,r.row,r.col,!1,i)&&o.finishEditing()&&(o._edtHdl._edtCanceled?i.preventDefault():o.setCellData(r.row,r.col,a.textContent,!0,o.refreshOnEdit)))}if(!o._isInputElement(n)){if(l==o.topLeftCells){var u=t.SelectionMode;switch(o.selectionMode){case u.None:case u.Cell:break;default:o.selectAll()}return}if(l==o.columnHeaders){if(o.allowPinning&&e.closestClass(n,t.CellFactory._WJC_PIN))this._clickPin(i,r);else if(!o._isTransposed()&&e.closestClass(i.target,t.CellFactory._WJC_COLLAPSE)){if(f=o._getColumnGroup(r.row,r.col))if(s)for(var h=f.isCollapsed,d=f.level,p=[],g=0;g<o.columns.length;g++)(f=o._getColumnGroup(r.row,g))&&f.collapseTo&&f.level==d&&p.indexOf(f)<0&&(p.push(f),f.isCollapsed=!h);else f.isCollapsed=!f.isCollapsed}else n instanceof HTMLSpanElement&&n.parentElement instanceof HTMLLabelElement&&(n=n.parentElement.querySelector("input")),n instanceof HTMLInputElement||this._clickSort(i,r),o.focus();return}if(l==o.rowHeaders){var f;if(o._isTransposed()&&e.closestClass(i.target,t.CellFactory._WJC_COLLAPSE)&&(f=o._getColumnGroup(r.row,r.col)))if(s){h=f.isCollapsed,d=f.level,p=[];for(var _=0;_<o.rows.length;_++)(f=o._getColumnGroup(_,r.col))&&f.collapseTo&&f.level==d&&p.indexOf(f)<0&&(p.push(f),f.isCollapsed=!h)}else f.isCollapsed=!f.isCollapsed;return}if(l==o.cells){if(r.row<0)return void this._clickSort(i,r);if(e.closestClass(n,t.CellFactory._WJC_COLLAPSE)){var m=o.rows[r.row];return void(m instanceof t.GroupRow&&(s?o.collapseGroupsToLevel(m.isCollapsed?m.level+1:m.level):m.isCollapsed=!m.isCollapsed))}e.closestClass(n,t.CellFactory._WJC_DROPDOWN)&&o._edtHdl._toggleListBox(i,r.range)}}}},r.prototype._hasRadioMap=function(i){var o=i.target;if(e.closest(o,"label")){var r=e.closestClass(o,t.CellFactory._WJC_RADIOMAP);return e.closestClass(r,n)==this._g.hostElement}return!1},r.prototype._clickSort=function(i,o){var n=this._g,r=n.allowSorting,s=n.collectionView,l=s?s.sortDescriptions:null,a=i.ctrlKey||i.metaKey,c=i.shiftKey;if(s&&s.canSort&&r!=t.AllowSorting.None){var u=o.panel.columns[o.col],h=n._getBindingColumn(o.panel,o.row,u),d=h?h._getBindingSort():null;if(h.allowSorting&&d){if(u==h){var p=n.getMergedRange(o.panel,o.row,o.col,!1);if(p&&p.columnSpan>1)return}var g=new t.CellRangeEventArgs(o.panel,o.range,i);if(n.onSortingColumn(g)){n._edtHdl._commitRowEdits();for(var f=-1,_=null,m=0;m<l.length;m++)if(l[m].property==d){f=m,_=l[m];break}l.deferUpdate((function(){if(a&&c)l.clear();else if(_){var i=a;!i&&n.isTouching&&(i=0==_.ascending),i?l.removeAt(f):l[f]=new e.collections.SortDescription(d,!_.ascending)}else{r!=t.AllowSorting.MultiColumn&&l.clear();var o=new e.collections.SortDescription(d,!0);l.push(o)}})),n.onSortedColumn(g)}}}},r.prototype._clickPin=function(e,i){var o=this._g,n=o.columns,r=n.frozen,s=o.allowPinning;s==t.AllowPinning.Both&&(s=e.shiftKey?t.AllowPinning.ColumnRange:t.AllowPinning.SingleColumn);var l=new t.CellRangeEventArgs(o.cells,i.range);o.onPinningColumn(l)&&(s==t.AllowPinning.SingleColumn&&(i.col>=r?(n.moveElement(i.col,r,!1),n.frozen++):(n.moveElement(i.col,r-1,!1),n.frozen--)),s==t.AllowPinning.ColumnRange&&(i.col+1!=r?n.frozen=i.col+1:n.frozen=0),o.onPinnedColumn(l))},r.prototype._dblclick=function(e){if(!e.defaultPrevented){var o,n=this._g,r=n.hitTest(e),s=e.ctrlKey||e.metaKey,l=r.range,a=r.cellType,c=t.CellType,u=n.selection,h=n.allowResizing,d=i;if(r.edgeRight&&h&d.Columns){if(a==c.TopLeft)r.panel.columns[r.col].allowResizing&&(o=new t.CellRangeEventArgs(r.panel,new t.CellRange(-1,r.col)),n.onAutoSizingColumn(o)&&n.onResizingColumn(o)&&(this._ignoreClick=!0,n.autoSizeColumn(r.col,!0),n.onAutoSizedColumn(o),n.onResizedColumn(o),e.preventDefault()));else if(a==c.ColumnHeader||4&h){a==c.ColumnHeader&&s&&u.containsColumn(r.col)&&(l=u);for(var p=a==c.RowHeader||a==c.BottomLeft,g=l.leftCol;g<=l.rightCol;g++)r.panel.columns[g].allowResizing&&(o=new t.CellRangeEventArgs(r.panel,new t.CellRange(-1,g)),n.onAutoSizingColumn(o)&&n.onResizingColumn(o)&&(this._ignoreClick=!0,n.autoSizeColumn(g,p),n.onResizedColumn(o),n.onAutoSizedColumn(o),e.preventDefault()))}this.resetMouseState()}else if(r.edgeBottom&&h&d.Rows){if(a==c.TopLeft||a==c.BottomLeft)r.getRow().allowResizing&&(p=a==c.TopLeft||null,o=new t.CellRangeEventArgs(r.panel,new t.CellRange(r.row,-1)),n.onAutoSizingRow(o)&&n.onResizingRow(o)&&(this._ignoreClick=!0,n.autoSizeRow(r.row,p),n.onResizedRow(o),n.onAutoSizedRow(o),e.preventDefault()));else if(a==c.RowHeader||4&h){var f=r.panel;p=f==n.columnHeaders||f==n.columnFooters&&null,s&&u.containsRow(r.row)&&f==n.cells&&(l=u);for(var _=l.topRow;_<=l.bottomRow;_++)f.rows[_].allowResizing&&(o=new t.CellRangeEventArgs(f,new t.CellRange(_,-1)),n.onAutoSizingRow(o)&&n.onResizingRow(o)&&(this._ignoreClick=!0,n.autoSizeRow(_,p),n.onResizedRow(o),n.onAutoSizedRow(o),e.preventDefault()))}this.resetMouseState()}}},r.prototype._hover=function(e){if(!this._isDown){var i=this._g,o=i.hitTest(e),n="";return this._szRowCol=this._getResizeColHt(o)||this._getResizeRowHt(o),this._szRowCol instanceof t.Column?n="col-resize":this._szRowCol instanceof t.Row&&(n="row-resize"),this._szStart=this._szRowCol?this._szRowCol.renderSize:0,i.hostElement.style.cursor=n,o}return null},r.prototype._getResizeColHt=function(e){var o,n=this._g.allowResizing,r=e.cellType,s=t.CellType;return n&i.Columns&&(r==s.ColumnHeader||r==s.TopLeft||4&n)&&(e.edgeRight&&(o=e.getColumn()),e.edgeFarRight&&(o=this._getResizeCol(e.panel,e.col)||e.getColumn()),e.edgeLeft&&(o=this._getResizeCol(e.panel,e.col,!0)||o)),o&&o.allowResizing?o:null},r.prototype._getResizeRowHt=function(e){var o,n=this._g.allowResizing,r=i,s=e.cellType,l=t.CellType;return n&r.Rows&&(s==l.RowHeader||s==l.TopLeft||4&n)&&(e.edgeBottom&&(o=e.getRow()),e.edgeFarBottom&&(o=this._getResizeRow(e.panel,e.row)||e.getRow()),e.edgeTop&&(o=this._getResizeRow(e.panel,e.row,!0)||o)),o&&o.allowResizing?o:null},r.prototype._getResizeCol=function(e,i,o){void 0===o&&(o=!1);var n=this._g,r=e.columns;if(o){for(var s=i-1;s>=0;s--)if((l=r[s]).isVisible)return this._asResizable(l);if(r==n.columns&&0!=(n.headersVisibility&t.HeadersVisibility.Row))for(s=(r=n.rowHeaders.columns).length-1;s>=0;s--)if((l=r[s]).isVisible)return this._asResizable(l);return null}for(s=i+1;s<r.length;s++)if((l=r[s]).isVisible)return this._asResizable(l);if(i==r.length-1&&r==n.rowHeaders.columns)for(r=n.columns,s=0;s<r.length;s++){var l;if((l=r[s]).isVisible)return this._asResizable(l)}return null},r.prototype._getResizeRow=function(e,i,o){void 0===o&&(o=!1);var n=this._g,r=e.rows;if(o){for(var s=i-1;s>=0;s--)if((l=r[s]).isVisible)return this._asResizable(l);if(r==n.rows&&0!=(n.headersVisibility&t.HeadersVisibility.Column))for(s=(r=n.columnHeaders.rows).length-1;s>=0;s--)if((l=r[s]).isVisible)return this._asResizable(l);return null}for(s=i+1;s<r.length;s++)if((l=r[s]).isVisible)return this._asResizable(l);if(i==r.length-1&&r==n.columnHeaders.rows)for(r=n.rows,s=0;s<r.length;s++){var l;if((l=r[s]).isVisible)return this._asResizable(l)}return null},r.prototype._asResizable=function(e){return 0==e.renderSize&&e.allowResizing?e:null},r.prototype._mouseSelect=function(i,o){var n=this,r=this._g;if(i&&this._htDown&&this._htDown.panel&&r.selectionMode!=t.SelectionMode.None){var s=new t.HitTestInfo(this._htDown.panel,i);this._handleSelection(s,o),!e.isIE9()&&i.button>=0&&i.target!=r._root&&((s=new t.HitTestInfo(r,i)).panel||setTimeout((function(){n._isDown&&n._eMouse&&n._mouseSelect(n._eMouse,o)}),100))}},r.prototype._handleResizing=function(i){"mousedown"==i.type&&(e.isSafari()?e.setAttribute(i.target,"draggable",null):i.preventDefault());var o=this._szRowCol;if(o instanceof t.Column){var n=this._g,s=e.mouseToPage(i).x,l=Math.round(Math.max(r._SZ_MIN,this._szStart+(s-this._htDown.point.x)*(n.rightToLeft?-1:1)));if(o.renderSize!=l){if(null==this._szArgs){var a=n.rowHeaders.columns.indexOf(o)>-1?n.rowHeaders:n.cells;this._szArgs=new t.CellRangeEventArgs(a,new t.CellRange(-1,o.index))}this._szArgs.cancel=!1,n.onResizingColumn(this._szArgs)&&(n.deferResizing?this._showResizeMarker(l):o.width=l)}}var c=this._szRowCol;if(c instanceof t.Row){n=this._g;var u=e.mouseToPage(i).y;l=Math.round(Math.max(r._SZ_MIN,this._szStart+(u-this._htDown.point.y))),c.renderSize!=l&&(null==this._szArgs&&(a=n.columnHeaders.rows.indexOf(c)>-1?n.columnHeaders:n.columnFooters.rows.indexOf(c)>-1?n.columnFooters:n.cells,this._szArgs=new t.CellRangeEventArgs(a,new t.CellRange(c.index,-1))),this._szArgs.cancel=!1,n.onResizingRow(this._szArgs)&&(n.deferResizing?this._showResizeMarker(l):c.height=l))}this._szArgs&&i.preventDefault()},r.prototype._dragstart=function(i){var n=this._g,r=this._htDown,s=o,l=t.CellType;if(r){if(this._dragSrc=null,this._htDrag=null,this._chldColGrpMarker=!1,!this._szRowCol){var a=new t.CellRangeEventArgs(r.panel,r.range),c=n.allowDragging,u=r.cellType,h=r.panel.rows,d=r.getColumn(!0);if(d&&d.allowDragging&&(u==l.ColumnHeader||u==l.TopLeft)&&c&s.Columns&&(n.onDraggingColumn(a)?this._dragSrc=i.target:i.preventDefault()),!this._dragSrc&&r.row>-1&&h[r.row].allowDragging){var p=h[r.row];p instanceof t.GroupRow||p instanceof t._NewRowTemplate||u==l.RowHeader&&c&s.Rows&&(n.onDraggingRow(a)?this._dragSrc=i.target:i.preventDefault())}}this._dragSrc&&i.dataTransfer&&!i.defaultPrevented&&(this._htDrag=r,e._startDrag(i.dataTransfer,"move"),i.stopPropagation(),e.addClass(this._dragSrc,"wj-state-dragsrc"),n.beginUpdate(),this._updating=!0)}},r.prototype._dragend=function(e){this._dragSrc=null,this._htDrag=null,this.resetMouseState()},r.prototype._dragover=function(i){var o=this._g,n=this._hitTest(i),r=this._dragSrc?this._htDrag:null,s=t.CellType,l=!1;if(r&&n.cellType==r.cellType){var a=new t.CellRangeEventArgs(n.panel,n.range,r);n.cellType==s.ColumnHeader&&o._hasColumnGroups()?(a.cancel=!o._canMoveColumnGroup(r.row,r.col,n.row,n.col),l=o.onDraggingColumnOver(a)):n.cellType==s.ColumnHeader?(a.cancel=!o.columns.canMoveElement(r.col,n.col),l=o.onDraggingColumnOver(a)):n.cellType==s.RowHeader?(a.cancel=!o.rows.canMoveElement(r.row,n.row),l=o.onDraggingRowOver(a)):n.cellType==s.TopLeft&&(a.cancel=!o.topLeftCells.columns.canMoveElement(r.col,n.col),l=o.onDraggingColumnOver(a))}if(l?(i.dataTransfer.dropEffect="move",i.preventDefault(),i.stopPropagation(),this._showDragMarker(n)):this._showDragMarker(null),r&&o.autoScroll){var c=o.controlRect,u=o.scrollPosition,h=e.Control._DRAG_SCROLL_EDGE,d=e.Control._DRAG_SCROLL_STEP;r.panel==o.columnHeaders?(i.pageX-c.left<h&&(u.x+=d),c.right-i.pageX<h&&(u.x-=d)):r.panel==o.rowHeaders&&(i.pageY-c.top<h&&(u.y+=d),c.bottom-i.pageY<h&&(u.y-=d)),u.equals(o._ptScrl)||(o.scrollPosition=u,o._rcBounds=null)}},r.prototype._drop=function(e){var i=this._g,o=this._hitTest(e),n=this._dragSrc?this._htDrag:null,r=t.CellType;if(n&&o.cellType==n.cellType){var s=i.selection,l=new t.CellRangeEventArgs(o.panel,o.range,n);o.cellType==r.ColumnHeader&&i._hasColumnGroups()?(i._moveColumnGroup(n.row,n.col,o.row,o.col,this._chldColGrpMarker),i.select(s.row,o.col),i.onDraggedColumn(l)):o.cellType==r.ColumnHeader?(i.columns.moveElement(n.col,o.col),i.select(s.row,o.col),i.onDraggedColumn(l)):o.cellType==r.RowHeader?(i.rows.moveElement(n.row,o.row),i.select(o.row,s.col),i.onDraggedRow(l)):o.cellType==r.TopLeft&&(i.topLeftCells.columns.moveElement(n.col,o.col),i.onDraggedColumn(l))}this.resetMouseState()},r.prototype._hitTest=function(e){var t=this._g;return t._rcBounds=null,t.hitTest(e)},r.prototype._showResizeMarker=function(i){var o,n=this._g,r=n._ptScrl,s=this._szArgs.panel.cellType,l=t.CellType,a=this._dvMarker,c=n.cells.hostElement;a.parentElement!=c&&c.appendChild(a),this._szRowCol instanceof t.Column?(o={left:this._szRowCol.pos+i-1,top:-1e3,right:"",bottom:0,width:3,height:""},s!=l.TopLeft&&s!=l.RowHeader||(o.left-=n._eTL.offsetWidth+r.x),s==l.Cell&&this._szRowCol.index<n.frozenColumns&&(o.left-=r.x),n.rightToLeft&&(o.left=c.clientWidth-o.left-o.width)):(o={left:-1e3,top:this._szRowCol.pos+i-1,right:0,bottom:"",width:"",height:3},s!=l.TopLeft&&s!=l.ColumnHeader||(o.top-=n._eTL.offsetHeight+r.y),s==l.Cell&&this._szRowCol.index<n.frozenRows&&(o.top-=r.y)),e.setCss(a,o)},r.prototype._showDragMarker=function(i){var o=this._dvMarker;if(i&&i.panel){if(!i.range.equals(this._rngTarget)){this._rngTarget=i.range;var n=i.panel.hostElement;o.parentElement!=n&&n.appendChild(o);var s=this._g,l=s._ptScrl,a=t.CellType,c={left:0,top:0,width:6,height:6,right:"",bottom:""};switch(i.cellType){case a.ColumnHeader:var u=s._getColumnGroup(i.row,i.col);if(u){var h=u._rng,d=i.panel.rows,p=i.panel.columns;if(u.isEmpty&&null===u.binding){var g=d[h.bottomRow],f=p[h.leftCol],_=s.rightToLeft,m=_?o.parentElement.clientWidth-i.point.x:i.point.x,w=Math.max(f.renderWidth/5,r._SZ_MAX_COLGRP_EDGE),C=f.pos+w,v=f.pos+f.renderWidth-w,y=this._htDown&&i.col>this._htDown.col;if(!y&&m>C||y&&m<v){c.top=g.pos-c.height/2+g.renderHeight,c.left=_?o.parentElement.clientWidth-f.pos-f.renderWidth:f.pos,c.width=f.renderWidth,this._chldColGrpMarker=!0;break}}this._chldColGrpMarker=!1,c.top=0,c.height=0;for(var b=0;b<h.topRow;b++)c.top+=d[b].renderHeight;for(b=h.topRow;b<=h.bottomRow;b++)c.height+=d[b].renderHeight;if(c.left=0,this._htDown&&i.col>this._htDown.col){var R=p[h.rightCol];c.left=R.pos-c.width/2+R.renderWidth}else{var E=p[h.leftCol];c.left=E.pos-c.width/2}s.rightToLeft&&(c.left=o.parentElement.clientWidth-c.left-c.width);break}case a.TopLeft:case a.ColumnHeader:var S=i.panel.columns[i.col];c.left=S.pos-c.width/2,c.height=i.panel.height,this._htDown&&i.col>this._htDown.col&&(c.left+=S.renderWidth),i.cellType==a.ColumnHeader&&i.col<s.frozenColumns&&(c.left-=l.x),s.rightToLeft&&(c.left=o.parentElement.clientWidth-c.left-c.width);break;case a.RowHeader:var x=i.getRow();c.top=x.pos-c.height/2,c.width=i.panel.width,i.row>this._htDown.row&&(c.top+=x.renderHeight),i.row<s.frozenRows&&(c.top-=l.y)}e.setCss(o,c)}}else e.removeChild(o),this._rngTarget=null},r.prototype._finishResizing=function(i){var o=this._g,n=o.selection,s=this._szArgs,l=this._eMouse,a=l&&(l.ctrlKey||l.metaKey),c=t.CellType;if(s&&!s.cancel){if(s.col>-1){var u=s.col,h=e.mouseToPage(i).x,d=Math.round(Math.max(r._SZ_MIN,this._szStart+(h-this._htDown.point.x)*(this._g.rightToLeft?-1:1)));if(s.panel.columns[u].width=Math.round(d),o.onResizedColumn(s),a&&this._htDown.cellType==c.ColumnHeader&&n.containsColumn(u))for(var p=n.leftCol;p<=n.rightCol;p++)o.columns[p].allowResizing&&p!=u&&(s=new t.CellRangeEventArgs(o.cells,new t.CellRange(-1,p)),o.onResizingColumn(s)&&(o.columns[p].size=o.columns[u].size,o.onResizedColumn(s)));i.preventDefault()}if(s.row>-1){var g=s.row,f=e.mouseToPage(i).y;if(d=Math.round(Math.max(r._SZ_MIN,this._szStart+(f-this._htDown.point.y))),s.getRow().height=Math.round(d),o.onResizedRow(s),a&&this._htDown.cellType==c.RowHeader&&n.containsRow(g))for(var _=n.topRow;_<=n.bottomRow;_++)o.rows[_].allowResizing&&_!=g&&(s=new t.CellRangeEventArgs(o.cells,new t.CellRange(_,-1)),o.onResizingRow(s)&&(o.rows[_].size=o.rows[g].size,o.onResizedRow(s)));i.preventDefault()}}},r.prototype._handleSelection=function(i,o){var n=this._g,r=n._selHdl.selection,s=new t.CellRange(i.row,i.col),l=t.CellType,a=t.SelectionMode;if(s.isValid)if(null==this._lbSelState){switch(i.cellType){case l.RowHeader:s.col=0,s.col2=n.columns.length-1;break;case l.ColumnHeader:switch(n.selectionMode){case a.Row:case a.Cell:s.row=s.row2=r.row,o=!1;break;default:s.row=0,s.row2=n.rows.length-1}}if(o&&(n.anchorCursor?(s.row=r.row,s.col=r.col):(s.row2=r.row2,s.col2=r.col2),!s.isValid)){var c=this._htDown;c&&(s=new t.CellRange(c.row,c.col))}if(n.selectionMode==t.SelectionMode.MultiRange){var u=n._mouseHdl._eMouse,h=u&&(u.ctrlKey||u.metaKey),d=n._selHdl,p=d.selection,g=d.extendedSelection,f=i.panel!=n.cells;e.closest(u.target,".wj-elem-collapse")&&(h=!1),h?!o&&d._deselectRange(s)?d.selection.isValid&&(s=null):!p.isValid||!f&&p.intersects(s)||(f?this._splitRange(p):[p.clone()]).forEach((function(e){for(var t=!1,i=0;i<g.length&&!t;i++)g[i].equals(e)&&(t=!0);t||g.push(e)})):g.clear()}if(s)switch(n.select(s,!1),i.cellType){case l.RowHeader:n.scrollIntoView(i.row,-1);break;case l.ColumnHeader:n.scrollIntoView(-1,i.col);break;default:n.scrollIntoView(i.row,i.col)}else{var _=new t.CellRangeEventArgs(n.cells,new t.CellRange(i.row,i.col));n.onSelectionChanging(_),n.onSelectionChanged(_),n.invalidate()}}else n.rows[i.row].isSelected=!this._lbSelState,n.scrollIntoView(i.row,i.col)},r.prototype._splitRange=function(e){var i=this._g,o=i.columns.length,n=i.rows.length,r=[];if(e.columnSpan==o)for(var s=e.topRow;s<=e.bottomRow;s++)r.push(new t.CellRange(s,0,s,o-1));else if(e.rowSpan==n)for(var l=e.leftCol;l<=e.rightCol;l++)r.push(new t.CellRange(0,l,n-1,l));else r.push(e.clone());return r},r._SZ_MIN=0,r._SZ_MAX_COLGRP_EDGE=50,r}();t._MouseHandler=r}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){e.grid||(e.grid={}),e._registerModule("wijmo.grid",e.grid)}(wijmo||(wijmo={}));