"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DatePickerCaption=void 0;var tslib_1=require("tslib"),React=tslib_1.__importStar(require("react")),react_lifecycles_compat_1=require("react-lifecycles-compat"),core_1=require("@blueprintjs/core"),Classes=tslib_1.__importStar(require("./common/classes")),dateUtils_1=require("./common/dateUtils"),utils_1=require("./common/utils"),DatePickerCaption=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={monthRightOffset:0},t.handleMonthSelectChange=t.dateChangeHandler((function(e,t){return e.setMonth(t)}),t.props.onMonthChange),t.handleYearSelectChange=t.dateChangeHandler((function(e,t){return e.setFullYear(t)}),t.props.onYearChange),t}return tslib_1.__extends(t,e),t.prototype.render=function(){for(var e=this,t=this.props,n=t.date,a=t.locale,r=t.localeUtils,o=t.minDate,i=t.maxDate,s=t.months,l=void 0===s?r.getMonths(a):s,c=o.getFullYear(),h=i.getFullYear(),p=n.getMonth(),u=n.getFullYear(),m=u===c?o.getMonth():0,d=u===h?i.getMonth()+1:void 0,_=l.map((function(e,t){return{label:e,value:t}})).slice(m,d),C=[c],f=c+1;f<=h;++f)C.push(f);u>h&&C.push({value:u,disabled:!0}),this.displayedMonthText=l[p];var E=React.createElement(core_1.HTMLSelect,{iconProps:{style:{right:this.state.monthRightOffset}},className:Classes.DATEPICKER_MONTH_SELECT,key:"month",minimal:!0,onChange:this.handleMonthSelectChange,value:p,options:_}),g=React.createElement(core_1.HTMLSelect,{className:Classes.DATEPICKER_YEAR_SELECT,key:"year",minimal:!0,onChange:this.handleYearSelectChange,value:u,options:C}),v=this.props.reverseMonthAndYearMenus?[g,E]:[E,g];return React.createElement("div",{className:this.props.classNames.caption},React.createElement("div",{className:Classes.DATEPICKER_CAPTION,ref:function(t){return e.containerElement=t}},v),React.createElement(core_1.Divider,null))},t.prototype.componentDidMount=function(){var e=this;this.requestAnimationFrame((function(){return e.positionArrows()}))},t.prototype.componentDidUpdate=function(){this.positionArrows()},t.prototype.positionArrows=function(){var e=utils_1.measureTextWidth(this.displayedMonthText,Classes.DATEPICKER_CAPTION_MEASURE,this.containerElement),t=null==this.containerElement?0:this.containerElement.firstElementChild.clientWidth,n=Math.max(2,t-e-core_1.IconSize.STANDARD-2);this.setState({monthRightOffset:n})},t.prototype.dateChangeHandler=function(e,t){var n=this;return function(a){var r,o,i=parseInt(a.target.value,10);if(!isNaN(i)){var s=dateUtils_1.clone(n.props.date);e(s,i),null===(o=(r=n.props).onDateChange)||void 0===o||o.call(r,s),null==t||t(i)}}},tslib_1.__decorate([react_lifecycles_compat_1.polyfill],t)}(core_1.AbstractPureComponent2);exports.DatePickerCaption=DatePickerCaption;