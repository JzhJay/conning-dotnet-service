"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Regions=exports.TableLoadingOption=exports.RowLoadingOption=exports.ColumnLoadingOption=exports.SelectionModes=exports.RegionCardinality=void 0;var RegionCardinality,ColumnLoadingOption,RowLoadingOption,TableLoadingOption,tslib_1=require("tslib"),Classes=tslib_1.__importStar(require("./common/classes")),utils_1=require("./common/utils");!function(n){n.CELLS="cells",n.FULL_ROWS="full-rows",n.FULL_COLUMNS="full-columns",n.FULL_TABLE="full-table"}(RegionCardinality=exports.RegionCardinality||(exports.RegionCardinality={})),exports.SelectionModes={ALL:[RegionCardinality.FULL_TABLE,RegionCardinality.FULL_COLUMNS,RegionCardinality.FULL_ROWS,RegionCardinality.CELLS],COLUMNS_AND_CELLS:[RegionCardinality.FULL_COLUMNS,RegionCardinality.CELLS],COLUMNS_ONLY:[RegionCardinality.FULL_COLUMNS],NONE:[],ROWS_AND_CELLS:[RegionCardinality.FULL_ROWS,RegionCardinality.CELLS],ROWS_ONLY:[RegionCardinality.FULL_ROWS]},function(n){n.CELLS="cells",n.HEADER="column-header"}(ColumnLoadingOption=exports.ColumnLoadingOption||(exports.ColumnLoadingOption={})),function(n){n.CELLS="cells",n.HEADER="row-header"}(RowLoadingOption=exports.RowLoadingOption||(exports.RowLoadingOption={})),function(n){n.CELLS="cells",n.COLUMN_HEADERS="column-header",n.ROW_HEADERS="row-header"}(TableLoadingOption=exports.TableLoadingOption||(exports.TableLoadingOption={}));var Regions=function(){function n(){}return n.getRegionCardinality=function(n){return null!=n.cols&&null!=n.rows?RegionCardinality.CELLS:null!=n.cols?RegionCardinality.FULL_COLUMNS:null!=n.rows?RegionCardinality.FULL_ROWS:RegionCardinality.FULL_TABLE},n.getFocusCellCoordinatesFromRegion=function(i){switch(n.getRegionCardinality(i)){case RegionCardinality.FULL_TABLE:return{col:0,row:0};case RegionCardinality.FULL_COLUMNS:return{col:i.cols[0],row:0};case RegionCardinality.FULL_ROWS:return{col:0,row:i.rows[0]};case RegionCardinality.CELLS:return{col:i.cols[0],row:i.rows[0]};default:return null}},n.copy=function(i){var r=n.getRegionCardinality(i);return r===RegionCardinality.CELLS?n.cell(i.rows[0],i.cols[0],i.rows[1],i.cols[1]):r===RegionCardinality.FULL_COLUMNS?n.column(i.cols[0],i.cols[1]):r===RegionCardinality.FULL_ROWS?n.row(i.rows[0],i.rows[1]):n.table()},n.cell=function(n,i,r,o){return{cols:this.normalizeInterval(i,o),rows:this.normalizeInterval(n,r)}},n.row=function(n,i){return{rows:this.normalizeInterval(n,i)}},n.column=function(n,i){return{cols:this.normalizeInterval(n,i)}},n.table=function(){return{}},n.add=function(n,i){var r=n.slice();return r.push(i),r},n.update=function(n,i,r){var o=n.slice();return null!=r?o.splice(r,1,i):(o.pop(),o.push(i)),o},n.clampRegion=function(i,r,o){var l=n.copy(i);return null!=i.rows&&(l.rows[0]=utils_1.Utils.clamp(i.rows[0],0,r),l.rows[1]=utils_1.Utils.clamp(i.rows[1],0,r)),null!=i.cols&&(l.cols[0]=utils_1.Utils.clamp(i.cols[0],0,o),l.cols[1]=utils_1.Utils.clamp(i.cols[1],0,o)),l},n.lastRegionIsEqual=function(i,r){if(null==i||0===i.length)return!1;var o=i[i.length-1];return n.regionsEqual(o,r)},n.findMatchingRegion=function(i,r){if(null==i)return-1;for(var o=0;o<i.length;o++)if(n.regionsEqual(i[o],r))return o;return-1},n.findContainingRegion=function(i,r){if(null==i)return-1;for(var o=0;o<i.length;o++)if(n.regionContains(i[o],r))return o;return-1},n.hasFullColumn=function(i,r){if(null==i)return!1;for(var o=0,l=i;o<l.length;o++){var e=l[o],t=n.getRegionCardinality(e);if(t===RegionCardinality.FULL_TABLE)return!0;if(t===RegionCardinality.FULL_COLUMNS&&n.intervalContainsIndex(e.cols,r))return!0}return!1},n.hasFullRow=function(i,r){if(null==i)return!1;for(var o=0,l=i;o<l.length;o++){var e=l[o],t=n.getRegionCardinality(e);if(t===RegionCardinality.FULL_TABLE)return!0;if(t===RegionCardinality.FULL_ROWS&&n.intervalContainsIndex(e.rows,r))return!0}return!1},n.hasFullTable=function(i){if(null==i)return!1;for(var r=0,o=i;r<o.length;r++){var l=o[r];if(n.getRegionCardinality(l)===RegionCardinality.FULL_TABLE)return!0}return!1},n.containsRegion=function(i,r){return n.overlapsRegion(i,r,!1)},n.overlapsRegion=function(i,r,o){void 0===o&&(o=!1);var l=o?n.intervalOverlaps:n.intervalContains;if(null==i||null==r)return!1;for(var e=0,t=i;e<t.length;e++){var a=t[e];switch(n.getRegionCardinality(a)){case RegionCardinality.FULL_TABLE:return!0;case RegionCardinality.FULL_COLUMNS:if(l(a.cols,r.cols))return!0;continue;case RegionCardinality.FULL_ROWS:if(l(a.rows,r.rows))return!0;continue;case RegionCardinality.CELLS:if(l(a.cols,r.cols)&&l(a.rows,r.rows))return!0;continue}}return!1},n.eachUniqueFullColumn=function(i,r){if(null!=i&&0!==i.length&&null!=r){var o={};i.forEach((function(i){if(n.getRegionCardinality(i)===RegionCardinality.FULL_COLUMNS)for(var l=i.cols,e=l[0],t=l[1],a=e;a<=t;a++)o[a]||(o[a]=!0,r(a))}))}},n.eachUniqueFullRow=function(i,r){if(null!=i&&0!==i.length&&null!=r){var o={};i.forEach((function(i){if(n.getRegionCardinality(i)===RegionCardinality.FULL_ROWS)for(var l=i.rows,e=l[0],t=l[1],a=e;a<=t;a++)o[a]||(o[a]=!0,r(a))}))}},n.enumerateUniqueCells=function(i,r,o){if(null==i||0===i.length)return[];for(var l={},e=[],t=0,a=i;t<a.length;t++){var s=a[t];n.eachCellInRegion(s,r,o,(function(n,i){var r=n+"-"+i;!0!==l[r]&&(l[r]=!0,e.push([n,i]))}))}return e.sort(n.rowFirstComparator),e},n.getCellRegionFromRegion=function(i,r,o){switch(n.getRegionCardinality(i)){case RegionCardinality.FULL_TABLE:return n.cell(0,0,r-1,o-1);case RegionCardinality.FULL_COLUMNS:return n.cell(0,i.cols[0],r-1,i.cols[1]);case RegionCardinality.FULL_ROWS:return n.cell(i.rows[0],0,i.rows[1],o-1);case RegionCardinality.CELLS:return n.cell(i.rows[0],i.cols[0],i.rows[1],i.cols[1]);default:return null}},n.sparseMapCells=function(i,r){var o=n.getBoundingRegion(i);if(null==o)return null;var l=o.rows[1]+1-o.rows[0],e=o.cols[1]+1-o.cols[0],t=utils_1.Utils.times(l,(function(){return new Array(e)}));return i.forEach((function(n){var i=n[0],l=n[1];t[i-o.rows[0]][l-o.cols[0]]=r(i,l)})),t},n.getBoundingRegion=function(n){for(var i,r,o,l,e=0,t=n;e<t.length;e++){var a=t[e],s=a[0],u=a[1];i=null==i||s<i?s:i,r=null==r||s>r?s:r,o=null==o||u<o?u:o,l=null==l||u>l?u:l}return null==i?null:{cols:[o,l],rows:[i,r]}},n.isValid=function(n){return!(null==n||null!=n.rows&&(n.rows[0]<0||n.rows[1]<0)||null!=n.cols&&(n.cols[0]<0||n.cols[1]<0))},n.isRegionValidForTable=function(n,i,r){return!(0===i||0===r||null!=n.rows&&!intervalInRangeInclusive(n.rows,0,i-1)||null!=n.cols&&!intervalInRangeInclusive(n.cols,0,r-1))},n.joinStyledRegionGroups=function(i,r,o){var l=[];return null!=r&&(l=l.concat(r)),null!=i&&i.length>0&&l.push({className:Classes.TABLE_SELECTION_REGION,regions:i}),null!=o&&l.push({className:Classes.TABLE_FOCUS_REGION,regions:[n.cell(o.row,o.col)]}),l},n.regionsEqual=function(i,r){return n.intervalsEqual(i.rows,r.rows)&&n.intervalsEqual(i.cols,r.cols)},n.expandRegion=function(i,r){var o=n.getRegionCardinality(i),l=n.getRegionCardinality(r);if(l!==o)return r;switch(l){case RegionCardinality.FULL_ROWS:var e=Math.min(i.rows[0],r.rows[0]),t=Math.max(i.rows[1],r.rows[1]);return n.row(e,t);case RegionCardinality.FULL_COLUMNS:var a=Math.min(i.cols[0],r.cols[0]),s=Math.max(i.cols[1],r.cols[1]);return n.column(a,s);case RegionCardinality.CELLS:return e=Math.min(i.rows[0],r.rows[0]),a=Math.min(i.cols[0],r.cols[0]),t=Math.max(i.rows[1],r.rows[1]),s=Math.max(i.cols[1],r.cols[1]),n.cell(e,a,t,s);default:return n.table()}},n.eachCellInRegion=function(i,r,o,l){switch(n.getRegionCardinality(i)){case RegionCardinality.FULL_TABLE:for(var e=0;e<r;e++)for(var t=0;t<o;t++)l(e,t);break;case RegionCardinality.FULL_COLUMNS:for(e=0;e<r;e++)for(t=i.cols[0];t<=i.cols[1];t++)l(e,t);break;case RegionCardinality.FULL_ROWS:for(e=i.rows[0];e<=i.rows[1];e++)for(t=0;t<o;t++)l(e,t);break;case RegionCardinality.CELLS:for(e=i.rows[0];e<=i.rows[1];e++)for(t=i.cols[0];t<=i.cols[1];t++)l(e,t)}},n.regionContains=function(i,r){return n.overlapsRegion([i],r,!1)},n.intervalsEqual=function(n,i){return null==n?null==i:null!=i&&n[0]===i[0]&&n[1]===i[1]},n.intervalContainsIndex=function(n,i){return null!=n&&n[0]<=i&&n[1]>=i},n.intervalContains=function(n,i){return null!=n&&null!=i&&n[0]<=i[0]&&i[1]<=n[1]},n.intervalOverlaps=function(n,i){return null!=n&&null!=i&&!(n[1]<i[0]||n[0]>i[1])},n.rowFirstComparator=function(n,i){var r=n[0]-i[0];return 0===r?n[1]-i[1]:r},n.numericalComparator=function(n,i){return n-i},n.normalizeInterval=function(i,r){null==r&&(r=i);var o=[i,r];return o.sort(n.numericalComparator),o},n}();function intervalInRangeInclusive(n,i,r){return inRangeInclusive(n[0],i,r)&&inRangeInclusive(n[1],i,r)}function inRangeInclusive(n,i,r){return n>=i&&n<=r}exports.Regions=Regions;