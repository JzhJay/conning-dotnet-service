import{__decorate,__extends,__spreadArrays}from"tslib";import classNames from"classnames";import*as React from"react";import{polyfill}from"react-lifecycles-compat";import{CSSTransition,TransitionGroup}from"react-transition-group";import{AbstractPureComponent2,Classes}from"../../common";import*as Errors from"../../common/errors";import{PanelView}from"./panelView";var PanelStack=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={direction:"push",stack:null!=t.props.stack?t.props.stack.slice().reverse():void 0!==t.props.initialPanel?[t.props.initialPanel]:[]},t.renderPanel=function(e,s){var n=t.props,r=n.renderActivePanelOnly,a=n.showPanelHeader,o=void 0===a||a,l=t.state.stack,i=l.length-s,c=r?l.length:i;return React.createElement(CSSTransition,{classNames:Classes.PANEL_STACK,key:c,timeout:400},React.createElement(PanelView,{onClose:t.handlePanelClose,onOpen:t.handlePanelOpen,panel:e,previousPanel:l[s+1],showHeader:o}))},t.handlePanelClose=function(e){var s,n,r=t.state.stack;r[0]!==e||r.length<=1||(null===(n=(s=t.props).onClose)||void 0===n||n.call(s,e),null==t.props.stack&&t.setState((function(e){return{direction:"pop",stack:e.stack.slice(1)}})))},t.handlePanelOpen=function(e){var s,n;null===(n=(s=t.props).onOpen)||void 0===n||n.call(s,e),null==t.props.stack&&t.setState((function(t){return{direction:"push",stack:__spreadArrays([e],t.stack)}}))},t}return __extends(t,e),t.prototype.componentDidUpdate=function(t,s){e.prototype.componentDidUpdate.call(this,t,s),this.props.stack!==t.stack&&null!=t.stack&&this.setState({stack:this.props.stack.slice().reverse()}),(null!=this.props.stack?this.props.stack.length:0)!==(null!=t.stack?t.stack.length:0)&&null!=t.stack&&this.setState({direction:t.stack.length-this.props.stack.length<0?"push":"pop"})},t.prototype.render=function(){var e=classNames(Classes.PANEL_STACK,Classes.PANEL_STACK+"-"+this.state.direction,this.props.className);return React.createElement(TransitionGroup,{className:e,component:"div"},this.renderPanels())},t.prototype.validateProps=function(e){(null==e.initialPanel&&null==e.stack||null!=e.initialPanel&&null!=e.stack)&&console.error(Errors.PANEL_STACK_INITIAL_PANEL_STACK_MUTEX),null!=e.stack&&0===e.stack.length&&console.error(Errors.PANEL_STACK_REQUIRES_PANEL)},t.prototype.renderPanels=function(){var e=this.props.renderActivePanelOnly,t=void 0===e||e,s=this.state.stack;return 0===s.length?null:(t?[s[0]]:s).map(this.renderPanel).reverse()},__decorate([polyfill],t)}(AbstractPureComponent2);export{PanelStack};