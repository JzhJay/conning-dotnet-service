"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PanelStack=void 0;var tslib_1=require("tslib"),classnames_1=tslib_1.__importDefault(require("classnames")),React=tslib_1.__importStar(require("react")),react_lifecycles_compat_1=require("react-lifecycles-compat"),react_transition_group_1=require("react-transition-group"),common_1=require("../../common"),Errors=tslib_1.__importStar(require("../../common/errors")),panelView_1=require("./panelView"),PanelStack=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={direction:"push",stack:null!=t.props.stack?t.props.stack.slice().reverse():void 0!==t.props.initialPanel?[t.props.initialPanel]:[]},t.renderPanel=function(e,n){var s=t.props,r=s.renderActivePanelOnly,a=s.showPanelHeader,l=void 0===a||a,o=t.state.stack,i=o.length-n,c=r?o.length:i;return React.createElement(react_transition_group_1.CSSTransition,{classNames:common_1.Classes.PANEL_STACK,key:c,timeout:400},React.createElement(panelView_1.PanelView,{onClose:t.handlePanelClose,onOpen:t.handlePanelOpen,panel:e,previousPanel:o[n+1],showHeader:l}))},t.handlePanelClose=function(e){var n,s,r=t.state.stack;r[0]!==e||r.length<=1||(null===(s=(n=t.props).onClose)||void 0===s||s.call(n,e),null==t.props.stack&&t.setState((function(e){return{direction:"pop",stack:e.stack.slice(1)}})))},t.handlePanelOpen=function(e){var n,s;null===(s=(n=t.props).onOpen)||void 0===s||s.call(n,e),null==t.props.stack&&t.setState((function(t){return{direction:"push",stack:tslib_1.__spreadArrays([e],t.stack)}}))},t}return tslib_1.__extends(t,e),t.prototype.componentDidUpdate=function(t,n){e.prototype.componentDidUpdate.call(this,t,n),this.props.stack!==t.stack&&null!=t.stack&&this.setState({stack:this.props.stack.slice().reverse()}),(null!=this.props.stack?this.props.stack.length:0)!==(null!=t.stack?t.stack.length:0)&&null!=t.stack&&this.setState({direction:t.stack.length-this.props.stack.length<0?"push":"pop"})},t.prototype.render=function(){var e=classnames_1.default(common_1.Classes.PANEL_STACK,common_1.Classes.PANEL_STACK+"-"+this.state.direction,this.props.className);return React.createElement(react_transition_group_1.TransitionGroup,{className:e,component:"div"},this.renderPanels())},t.prototype.validateProps=function(e){(null==e.initialPanel&&null==e.stack||null!=e.initialPanel&&null!=e.stack)&&console.error(Errors.PANEL_STACK_INITIAL_PANEL_STACK_MUTEX),null!=e.stack&&0===e.stack.length&&console.error(Errors.PANEL_STACK_REQUIRES_PANEL)},t.prototype.renderPanels=function(){var e=this.props.renderActivePanelOnly,t=void 0===e||e,n=this.state.stack;return 0===n.length?null:(t?[n[0]]:n).map(this.renderPanel).reverse()},tslib_1.__decorate([react_lifecycles_compat_1.polyfill],t)}(common_1.AbstractPureComponent2);exports.PanelStack=PanelStack;